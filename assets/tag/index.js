window.__require=function t(e,o,n){function r(c,a){if(!o[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var s="function"==typeof __require&&__require;if(!a&&s)return s(l,!0);if(i)return i(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var h=o[c]={exports:{}};e[c][0].call(h.exports,function(t){return r(e[c][1][t]||t)},h,h.exports,t,e,o,n)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<n.length;c++)r(n[c]);return r}({label:[function(t,e,o){"use strict";cc._RF.push(e,"bd504The1JKtZtqVts+d1wS","label");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../common/scripts/lib/config"),a=t("./tag"),l=t("../../../common/scripts/lib/error-handler"),s=cc._decorator,h=s.ccclass,d=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.homePos=null,e}return r(e,t),e.prototype.onDestroy=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchmove",this.onTouchMove,this),this.node.off("touchcancel",this.onTouchEnd,this)},e.prototype.scaleLabel=function(t){c.default.i.direction==c.Direction.RTL?(this.node.scaleX=-t,this.node.getChildByName("text").scaleX=-1):this.node.scale=t},e.prototype.onTouchStart=function(t){0==t.getID()&&(this.scaleLabel(1.1),this.node.parent.getComponent(a.default).onTouchAudio(this.audioName))},e.prototype.onTouchMove=function(t){0==t.getID()&&this.node.setPosition(this.node.position.add(t.getDelta()))},e.prototype.handleNodeTouch=function(t){"off"==t?(this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchmove",this.onTouchMove,this),this.node.off("touchcancel",this.onTouchEnd,this)):"on"==t&&(this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchmove",this.onTouchMove,this),this.node.on("touchcancel",this.onTouchEnd,this))},e.prototype.onTouchEnd=function(t){var e=this;cc.log("touchend "+t.getID()),this.handleNodeTouch("off");var o=this.node.parent.getComponent(a.default),n=!1;if(this.node.parent.getChildByName("truck").getChildByName("container").children.forEach(function(o){null!=o&&o.name!="dropBox_"+e.node.name&&o.getBoundingBoxToWorld().contains(t.getLocation())&&(n=!0)}),n&&this.node.parent.emit("wrong"),null!=this.node.parent.getChildByName("truck").getChildByName("container").getChildByName("dropBox_"+this.node.name)&&this.node.parent.getChildByName("truck").getChildByName("container").getChildByName("dropBox_"+this.node.name).getBoundingBoxToWorld().contains(t.getLocation())){cc.log("hi");var r=this.node.parent.getChildByName("truck").getChildByName("container").getChildByName("dropBox_"+this.node.name);this.scaleLabel(1),this.node.parent=null,this.node.parent=r.parent,this.node.position=r.position,r.removeFromParent(!1),this.node.parent.parent.parent.emit("correct"),o.complete--,o.match()}else this.scaleLabel(1),(new cc.Tween).target(this.node).to(.7,{position:this.homePos},{progress:null,easing:"sineOut"}).call(function(){e.handleNodeTouch("on")}).start()},i([l.catchError()],e.prototype,"onDestroy",null),i([l.catchError()],e.prototype,"scaleLabel",null),i([l.catchError()],e.prototype,"onTouchStart",null),i([l.catchError()],e.prototype,"onTouchMove",null),i([l.catchError()],e.prototype,"handleNodeTouch",null),i([l.catchError()],e.prototype,"onTouchEnd",null),i([h],e)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"./tag":"tag"}],tag:[function(t,e,o){"use strict";cc._RF.push(e,"2a21a3wccNEzq61A63XMdBW","tag");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../common/scripts/lib/config"),a=t("./label"),l=t("../../../common/scripts/util"),s=t("../../../common/scripts/lib/error-handler"),h=t("../../../common/scripts/game"),d=cc._decorator,u=d.ccclass,p=d.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dropNodePrefab=null,e.queNodePrefab=null,e.label0Prefab=null,e.label1Prefab=null,e.label2Prefab=null,e.label3Prefab=null,e.label4Prefab=null,e.label5Prefab=null,e.labelAudio=null,e.truck=null,e.totalPieces=0,e.complete=0,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.node.opacity=0,this.totalPieces--,this.quePos=new Map,this.queAudio=new Map;var e=c.default.getInstance().data[0],o=e[3],n=null,r=null;l.Util.loadTexture(o,function(o){t.node.opacity=255;var i=new cc.SpriteFrame(o);i.setRect(new cc.Rect(30,30,790,650)),t.node.getChildByName("truck").getChildByName("container").getComponent(cc.Sprite).spriteFrame=i,t.node.getChildByName("truck").getChildByName("container").opacity=255;for(var s,h=function(o,n){if(""==e[o+1])return s=o,"break";for(var i=cc.instantiate(t.dropNodePrefab),c="",a=e[++o].split("/"),h=0;h<a.length;h++)c=c.concat(a[h]);var d=e[++o].split("."),u=e[o+1];t.queAudio.set(c,u),i.name="dropBox_"+c,i.getChildByName("drop_label_labelling").height+=20,i.getChildByName("drop_label_labelling").width+=15,t.node.getChildByName("truck").getChildByName("container").addChild(i),i.opacity=0,i.position=cc.v3(+d[0]/2.27-340,-+d[1]/1.92-490),0==n&&(r=i),i.getChildByName("drop_label_labelling").getComponent(cc.Animation),setTimeout(function(){null!=t.node&&(i.getChildByName("drop_label_labelling").getComponent(cc.Animation).play(),l.Util.playSfx(t.labelAudio),i.opacity=255)},3e3*Math.random()+2e3),s=o},d=3,u=0;d<e.length-1;d++,u++){var p=h(d,u);if(d=s,"break"===p)break}var f=t.truck.x;(new cc.Tween).target(t.truck).set({x:cc.winSize.width}).to(3,{x:f},{progress:null,easing:"quadOut"}).call(function(){t.truck.getComponent(cc.Animation).stop();for(var o=3,r=0;o<e.length-1&&""!=e[o+1];o+=2,r++){var i=cc.instantiate(t.queNodePrefab),l=void 0;switch(r%6){case 0:l=cc.instantiate(t.label0Prefab);break;case 1:l=cc.instantiate(t.label1Prefab);break;case 2:l=cc.instantiate(t.label2Prefab);break;case 3:l=cc.instantiate(t.label3Prefab);break;case 4:l=cc.instantiate(t.label4Prefab);break;case 5:l=cc.instantiate(t.label5Prefab)}for(var s="",h=e[++o].split("/"),d=0;d<h.length;d++)s=s.concat(h[d]);i.name="text",i.getComponent(cc.Label).string=e[o],i.getComponent(cc.Label).fontSize=45,l.name=s,t.complete++,l.addChild(i),l.height+=20,l.width+=15,0==r&&(n=l);var u=l.getComponent(a.default);l.name=s,t.node.addChild(l),i.zIndex=1,l.position=cc.v2(.75*cc.winSize.width/2,l.y-85*r-100),u.homePos=l.position,u.audioName=t.queAudio.get(s),c.default.i.direction==c.Direction.RTL&&(i.getComponent(cc.Label).horizontalAlign=cc.Label.HorizontalAlign.RIGHT,l.scaleX=-1,l.getChildByName("text").scaleX=-1)}}).start(),t.scheduleOnce(function(){l.Util.showHelp(n,r),t.node.getComponentsInChildren(a.default).forEach(function(t){t.handleNodeTouch("on")})},5)})},e.prototype.match=function(){var t=this;0==this.complete&&--this.totalPieces<=0&&(cc.log("label game finish"),(new cc.Tween).target(this.truck).delay(1).to(1.5,{x:this.truck.x-cc.winSize.width},{progress:null,easing:"quadOut"}).call(function(){return t.node.emit("nextProblem")}).start())},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},e.prototype.onTouchAudio=function(t){var e=this;l.Util.loadGameSound(t,function(t){t&&e.friend.speak(t)})},i([p(cc.Prefab)],e.prototype,"dropNodePrefab",void 0),i([p(cc.Prefab)],e.prototype,"queNodePrefab",void 0),i([p(cc.Prefab)],e.prototype,"label0Prefab",void 0),i([p(cc.Prefab)],e.prototype,"label1Prefab",void 0),i([p(cc.Prefab)],e.prototype,"label2Prefab",void 0),i([p(cc.Prefab)],e.prototype,"label3Prefab",void 0),i([p(cc.Prefab)],e.prototype,"label4Prefab",void 0),i([p(cc.Prefab)],e.prototype,"label5Prefab",void 0),i([p({type:cc.AudioClip})],e.prototype,"labelAudio",void 0),i([p(cc.Node)],e.prototype,"truck",void 0),i([s.catchError()],e.prototype,"onLoad",null),i([s.catchError()],e.prototype,"match",null),i([s.catchError()],e.prototype,"onDestroy",null),i([s.catchError()],e.prototype,"onTouchAudio",null),i([u],e)}(h.default);o.default=f,cc._RF.pop()},{"../../../common/scripts/game":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0,"./label":"label"}]},{},["label","tag"]);