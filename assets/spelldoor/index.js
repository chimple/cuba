window.__require=function t(e,o,n){function i(c,l){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var a="function"==typeof __require&&__require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var p=o[c]={exports:{}};e[c][0].call(p.exports,function(t){return i(e[c][1][t]||t)},p,p.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({spelldoor:[function(t,e,o){"use strict";cc._RF.push(e,"32d3et6w8hIjqTgdBZJpv/o","spelldoor");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../common/scripts/lib/config"),l=t("../../../common/scripts/drag"),s=t("./spellingDrag"),a=t("../../../common/scripts/util"),p=t("../../../common/scripts/lib/error-handler"),u=t("../../../common/scripts/Utility"),d=t("../../../common/scripts/game"),h=t("../../../common/scripts/drop"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dropLayout=null,e.choiceLayout=null,e.sprite=null,e.spellingDrag=null,e.spellingDrop=null,e.anim=null,e.choices=[],e.empty=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this,e=c.default.getInstance();cc.director.getCollisionManager().enabled=!0,l.default.letDrag=!1;var o=e.data[0],n=(o[0],o[1],o[2],o[3]),i=o[4],r=o[5],p=o[6],d=o[7],f=o[8],m=(o[9],null),y=null,g=this.splitWord(i),v=parseInt(r),_=parseInt(p);for(c.default.wide&&(this.dropLayout.getComponent(cc.Layout).spacingX+=30,this.choiceLayout.getComponent(cc.Layout).spacingX+=30),this.splitWord(n).forEach(function(e,o,n){u.AlphabetUtil.isConsonantOrVowel(e)==u.LetterType.Consonant?v--:_--;var i=cc.instantiate(t.spellingDrop),r=i.getComponent(h.default);r&&(r.allowDrop=!1),i.name=e,t.dropLayout.addChild(i);var c=t.createDrag(e);if(i.addChild(c),"*"==g[o]||0==t.empty&&o==n.length-1){t.empty++;var l=c.parent.getComponent(h.default);null!==l&&(l.allowDrop=l.node.name===c.name),t.choices.push(c),null==m&&(m=c,y=i),(new cc.Tween).target(c).delay(3).to(.5,{y:-cc.winSize.height},null).start()}else c.getComponent(s.default).allowDrag=!1});v-- >0;)this.choices.push(this.createDrag(u.AlphabetUtil.getRandomConsonant().toLowerCase()));for(;_-- >0;)this.choices.push(this.createDrag(u.AlphabetUtil.getRandomVowel().toLowerCase()));a.Util.loadTexture(d,function(e){t.anim.once("finished",function(){t.scheduleOnce(function(){t.sprite.spriteFrame=new cc.SpriteFrame(e),a.Util.resizeSprite(t.sprite,370,273),a.Util.loadGameSound(f,function(e){null!=e&&(t.friend.extraClip=e,t.friend.speakExtra())}),t.anim.play().wrapMode=cc.WrapMode.Reverse},1)}),t.scheduleOnce(function(){t.anim.play()},1)});var w=this.choiceLayout.y;(new cc.Tween).target(this.choiceLayout).set({y:-cc.winSize.height}).delay(5).call(function(){a.Util.shuffle(t.choices),t.choices.forEach(function(e){null!=e.parent&&(e.removeFromParent(),e.position=cc.Vec2.ZERO);var o=new cc.Node;o.width=e.width,o.addChild(e),t.choiceLayout.addChild(o)})}).to(.5,{y:w},null).call(function(){a.Util.showHelp(m,y),l.default.letDrag=!0}).start()},e.prototype.splitWord=function(t){var e=new GraphemeSplitter;return-1!=t.indexOf(",")?t.split(","):e.splitGraphemes(t)},e.prototype.createDrag=function(t){var e=this,o=cc.instantiate(this.spellingDrag);return o.name=t,o.on("spellingMatch",this.onMatch.bind(this)),o.on("spellingNoMatch",function(){e.node.emit("wrong")}),o},e.prototype.onMatch=function(){var t=this;this.node.emit("correct"),--this.empty<=0&&(l.default.letDrag=!1,this.node.pauseSystemEvents(!0),this.scheduleOnce(function(){return t.friend.speakExtra(t.endAnimate.bind(t))},.5))},e.prototype.endAnimate=function(){var t=this;this.scheduleOnce(function(){t.anim.once("finished",function(){(new cc.Tween).target(t.friendPos).delay(.5).call(function(){null!=t.friend&&t.friend.playAnimation("jumping",1)}).to(1,{x:0},null).delay(1).call(function(){t.node.emit("nextProblem")}).start()}),t.anim.play().wrapMode=cc.WrapMode.Normal},1)},r([y(cc.Node)],e.prototype,"dropLayout",void 0),r([y(cc.Node)],e.prototype,"choiceLayout",void 0),r([y(cc.Sprite)],e.prototype,"sprite",void 0),r([y(cc.Prefab)],e.prototype,"spellingDrag",void 0),r([y(cc.Prefab)],e.prototype,"spellingDrop",void 0),r([y(cc.Animation)],e.prototype,"anim",void 0),r([p.default()],e.prototype,"onLoad",null),r([m],e)}(d.default);o.default=g,cc._RF.pop()},{"../../../common/scripts/Utility":void 0,"../../../common/scripts/drag":void 0,"../../../common/scripts/drop":void 0,"../../../common/scripts/game":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0,"./spellingDrag":"spellingDrag"}],spellingDrag:[function(t,e,o){"use strict";cc._RF.push(e,"1d505nPB4hNAI/dqMsKYwJt","spellingDrag");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../common/scripts/drag"),l=t("../../../common/scripts/util"),s=t("../../../common/scripts/lessonController"),a=t("../../../common/scripts/lib/config"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._soundClip=null,e}return i(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this);var o=a.default.getInstance().data[0],n=(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]);this.label.string=a.default.wide?" "+this.node.name+" ":this.node.name,"true"===n||"True"===n?l.Util.loadsLetter(this.node.name.toLowerCase(),function(t){e._soundClip=t}):l.Util.loadsPhonicsOrLetter(this.node.name.toLowerCase(),function(t){e._soundClip=t})},e.prototype.start=function(){this.label.node.width=2*this.label.node.width},e.prototype.onTouchStart=function(e){if(t.prototype.onTouchStart.call(this,e),null!=this._soundClip)try{s.default.getFriend().speak(this._soundClip)}catch(o){console.log("Failed playing sound")}},e.prototype.onTouchEnd=function(e){var o=this.allowDrag;t.prototype.onTouchEnd.call(this,e),o&&this.isMoved&&(this.match?this.node.emit("spellingMatch",this):this.node.emit("spellingNoMatch"))},r([u],e)}(c.default));o.default=d,cc._RF.pop()},{"../../../common/scripts/drag":void 0,"../../../common/scripts/lessonController":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/util":void 0}],spellingDrop:[function(t,e,o){"use strict";cc._RF.push(e,"ac928EDQMVMboj3SFohsgXo","spellingDrop"),Object.defineProperty(o,"__esModule",{value:!0}),o.SpellingDrop=void 0;var n=function(){function t(t,e,o){this.letter=e,this.index=t,this.isVowelOrConsonant=o}return t.prototype.setIndex=function(t){this.index=t},t.prototype.setLetter=function(t){this.letter=t},t.prototype.setBoundary=function(t){this.boundary=t},t.prototype.setPosition=function(t){this.position=t},t}();o.SpellingDrop=n,cc._RF.pop()},{}]},{},["spelldoor","spellingDrag","spellingDrop"]);