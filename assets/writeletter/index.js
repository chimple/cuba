window.__require=function t(e,n,o){function i(c,a){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var p=n[c]={exports:{}};e[c][0].call(p.exports,function(t){return i(e[c][1][t]||t)},p,p.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({writeletter:[function(t,e,n){"use strict";cc._RF.push(e,"f00d6U85lNJf7T+QE5U3/2Z","writeletter");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.WriteLetter=n.LETTER_TRACING_SCALE=void 0;var c=cc._decorator.ccclass,a=cc._decorator.property,s=t("../../../common/scripts/lib/config"),l=t("../../../common/scripts/util"),p=t("../../../common/scripts/lib/error-handler"),u=t("../../../common/scripts/helper"),d=t("../../../common/Tracing/scripts/tracing-container"),h=t("../../../common/scripts/game"),g=t("../../../common/Tracing/scripts/trace-graphics");n.LETTER_TRACING_SCALE=.85;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageNode=null,e._tracingContainerComponent=null,e._traceGraphics=null,e._letter=null,e._currentConfig=null,e._letterTracingContainer=null,e._sound=null,e._imageName=null,e}return i(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!1,this._currentConfig=this.processConfiguration(s.default.getInstance().data[0]),null!==this._currentConfig&&(this._image=cc.instantiate(this.imageNode),this._letterTracingContainer=this.node,this._letterTracingContainer.scale*=1,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this.initTracingContainer(),this.subScribeToTracingEvents(),this.loadSounds(this._currentConfig.traceText),this.node.opacity=255),l.Util.showHelp(null,null)},e.prototype.initTracingContainer=function(){this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this.setAlphabetToDisplay(this._currentConfig.traceText)},e.prototype.subScribeToTracingEvents=function(){var t=this;this.node.on(u.TRACING_FINISHED,function(e){e.stopPropagation(),t.tracingFinished()}),this.node.on(u.TRACING_CORRECT,function(e){e.stopPropagation(),t.node.emit("correct")}),this.node.on(u.TRACING_WRONG,function(e){e.stopPropagation(),t.node.emit("wrong")}),this.node.on(u.RESET_TRACING,function(e){e.stopPropagation(),console.log("RESET_TRACING....."),t._tracingContainerComponent=t._tracingContainer.getComponent(d.default),t._traceGraphics=t._tracingContainerComponent.traceGraphics,null!==t._traceGraphics&&t._traceGraphics.getComponent(g.default).resetGraphics()}),this.node.on(u.RESET_TRACING_ALLOWED,function(){null!==t.node.getChildByName("reeetTracingButton")&&(t.node.getChildByName("reeetTracingButton").opacity=255)}),this.node.on(u.RESET_TRACING_NOT_ALLOWED,function(){null!==t.node.getChildByName("reeetTracingButton")&&(t.node.getChildByName("reeetTracingButton").opacity=0)}),null!==this.node.getChildByName("reeetTracingButton")&&(this.node.getChildByName("reeetTracingButton").opacity=0)},e.prototype.loadSounds=function(t){var e=this;l.Util.loadsLetter(t.toLowerCase(),function(t){e._sound=t,e.node.emit(u.SOUND_LOADED_EVENT)})},e.prototype.tracingFinished=function(){var t=this;this.pronounce(),this.scheduleOnce(function(){t.node.emit("nextProblem")},1)},e.prototype.pronounce=function(){this.friend.speak(this._sound)},e.prototype.setAlphabetToDisplay=function(t){this._tracingContainerComponent=this._tracingContainer.getComponent(d.default),this._tracingContainerComponent.tracingLetter=t,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),this._tracingContainerComponent.traceGraphics.emit("enabledGraphics"),"en/"===s.default.dir?this._tracingContainer.setPosition(new cc.Vec2(-256,-350)):"hi/"===s.default.dir?this._tracingContainer.setPosition(new cc.Vec2(-256,-450)):this._tracingContainer.setPosition(new cc.Vec2(-256,-350)),this.node.scale=n.LETTER_TRACING_SCALE},e.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var e=[].concat.apply([],t);return{level:e[0],workSheet:e[1],problemNo:e[2],traceText:e[3]}},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},r([a(cc.Prefab)],e.prototype,"tracingContainerPrefab",void 0),r([a(cc.Prefab)],e.prototype,"imageNode",void 0),r([p.default()],e.prototype,"onLoad",null),r([p.default()],e.prototype,"subScribeToTracingEvents",null),r([p.default()],e.prototype,"tracingFinished",null),r([p.default()],e.prototype,"pronounce",null),r([p.default()],e.prototype,"setAlphabetToDisplay",null),r([c],e)}(h.default);n.WriteLetter=f,cc._RF.pop()},{"../../../common/Tracing/scripts/trace-graphics":void 0,"../../../common/Tracing/scripts/tracing-container":void 0,"../../../common/scripts/game":void 0,"../../../common/scripts/helper":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0}]},{},["writeletter"]);