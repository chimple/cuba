window.__require=function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){return o(t[a][1][e]||e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<r.length;a++)o(r[a]);return o}({ApiHandler:[function(e,t,n){"use strict";cc._RF.push(t,"b373f71AwxMQ771vGzZA50o","ApiHandler");var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ApiHandler=void 0;var i=function(){function e(){}return e.getInstance=function(t){return e.i||(e.i=new e,e.i.s=t),e.i},e.prototype.updateProgress=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.s.updateProgress(e)];case 1:return[2,t.sent()]}})})},e.prototype.teacherRequestAccepted=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.s.teacherRequestAccepted(e)];case 1:return[2,t.sent()]}})})},e.prototype.schoolById=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.s.schoolById(e)];case 1:return[2,t.sent()]}})})},e.prototype.updateHomeTeacher=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.s.updateHomeTeacher(e)];case 1:return[2,t.sent()]}})})},e.prototype.listAssignments=function(e,t){return void 0===t&&(t=10),r(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,this.s.listAssignments(e,t)];case 1:return[2,n.sent()]}})})},e.prototype.linkStudent=function(e,t,n,i,a,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===a&&(a=null),void 0===s&&(s=null),r(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,this.s.linkStudent(e,t,n,i,a,s)];case 1:return[2,r.sent()]}})})},e.prototype.syncFailedProgresses=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.s.syncFailedProgresses(e)];case 1:return[2,t.sent()]}})})},e.prototype.getLeaderboard=function(e,t,n){return r(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,this.s.getLeaderboard(e,t,n)];case 1:return[2,r.sent()]}})})},e.prototype.customAuth=function(e,t,n,i,a,s,c,l,u){return r(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,this.s.customAuth(e,t,n,i,a,s,c,l,u)];case 1:return[2,r.sent()]}})})},e}();n.ApiHandler=i,cc._RF.pop()},{}],1:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const t=e=>{const t=new Map;t.set("web",{name:"web"});const n=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t};return n.addPlatform=(e,t)=>{n.platforms.set(e,t)},n.setPlatform=e=>{n.platforms.has(e)&&(n.currentPlatform=n.platforms.get(e))},n},r=(e=>e.CapacitorPlatforms=t(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}),o=r.addPlatform,i=r.setPlatform,a=(e,t)=>{var n;const r=t.config,o=e.Plugins;if(!r||!r.name)throw new Error('Capacitor WebPlugin is using the deprecated "registerWebPlugin()" function, but without the config. Please use "registerPlugin()" instead to register this web plugin."');console.warn(`Capacitor plugin "${r.name}" is using the deprecated "registerWebPlugin()" function`),(!o[r.name]||(null===(n=null==r?void 0:r.platforms)||void 0===n?void 0:n.includes(e.getPlatform())))&&(o[r.name]=t)};var s;n.ExceptionCode=void 0,(s=n.ExceptionCode||(n.ExceptionCode={})).Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE";class c extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const l=e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"},u=e=>{var t,r,o,i,a;const s=e.CapacitorCustomPlatform||null,u=e.Capacitor||{},d=u.Plugins=u.Plugins||{},p=e.CapacitorPlatforms,h=(null===(t=null==p?void 0:p.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==s?s.name:l(e)),f=(null===(r=null==p?void 0:p.currentPlatform)||void 0===r?void 0:r.isNativePlatform)||(()=>"web"!==h()),g=(null===(o=null==p?void 0:p.currentPlatform)||void 0===o?void 0:o.isPluginAvailable)||(e=>{const t=m.get(e);return!(null==t||!t.platforms.has(h()))||!!_(e)}),_=(null===(i=null==p?void 0:p.currentPlatform)||void 0===i?void 0:i.getPluginHeader)||(e=>{var t;return null===(t=u.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)}),m=new Map,y=(null===(a=null==p?void 0:p.currentPlatform)||void 0===a?void 0:a.registerPlugin)||((e,t={})=>{const r=m.get(e);if(r)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),r.proxy;const o=h(),i=_(e);let a;const l=async()=>(!a&&o in t?a=a="function"==typeof t[o]?await t[o]():t[o]:null!==s&&!a&&"web"in t&&(a=a="function"==typeof t.web?await t.web():t.web),a),p=(t,r)=>{var a,s;if(!i){if(t)return null===(s=t[r])||void 0===s?void 0:s.bind(t);throw new c(`"${e}" plugin is not implemented on ${o}`,n.ExceptionCode.Unimplemented)}{const n=null==i?void 0:i.methods.find(e=>r===e.name);if(n)return"promise"===n.rtype?t=>u.nativePromise(e,r.toString(),t):(t,n)=>u.nativeCallback(e,r.toString(),t,n);if(t)return null===(a=t[r])||void 0===a?void 0:a.bind(t)}},f=t=>{let r;const i=(...i)=>{const a=l().then(a=>{const s=p(a,t);if(s){const e=s(...i);return r=null==e?void 0:e.remove,e}throw new c(`"${e}.${t}()" is not implemented on ${o}`,n.ExceptionCode.Unimplemented)});return"addListener"===t&&(a.remove=async()=>r()),a};return i.toString=()=>`${t.toString()}() { [capacitor code] }`,Object.defineProperty(i,"name",{value:t,writable:!1,configurable:!1}),i},g=f("addListener"),y=f("removeListener"),v=(e,t)=>{const n=g({eventName:e},t),r=async()=>{const r=await n;y({eventName:e,callbackId:r},t)},o=new Promise(e=>n.then(()=>e({remove:r})));return o.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()},o},b=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return i?v:g;case"removeListener":return y;default:return f(t)}}});return d[e]=b,m.set(e,{name:e,proxy:b,platforms:new Set([...Object.keys(t),...i?[o]:[]])}),b});return u.convertFileSrc||(u.convertFileSrc=e=>e),u.getPlatform=h,u.handleError=t=>e.console.error(t),u.isNativePlatform=f,u.isPluginAvailable=g,u.pluginMethodNoop=(e,t,n)=>Promise.reject(`${n} does not have an implementation of "${t}".`),u.registerPlugin=y,u.Exception=c,u.DEBUG=!!u.DEBUG,u.isLoggingEnabled=!!u.isLoggingEnabled,u.platform=u.getPlatform(),u.isNative=u.isNativePlatform(),u},d=(e=>e.Capacitor=u(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}),p=d.registerPlugin,h=d.Plugins;class f{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const r=async()=>this.removeListener(e,t),o=Promise.resolve({remove:r});return Object.defineProperty(o,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()}}),o}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){const n=this.listeners[e];n&&n.forEach(e=>e(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new d.Exception(e,n.ExceptionCode.Unimplemented)}unavailable(e="not available"){return new d.Exception(e,n.ExceptionCode.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const r=n.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const g=p("WebView"),_=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),m=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class y extends f{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[n,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=m(n).trim(),r=m(r).trim(),t[n]=r}),t}async setCookie(e){try{const n=_(e.key),r=_(e.value),o=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),a=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${o}; path=${i}; ${a};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const e of t)document.cookie=e.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}const v=p("CapacitorCookies",{web:()=>new y}),b=async e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>n(e),r.readAsDataURL(e)}),E=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((n,r,o)=>(n[r]=e[t[o]],n),{})},S=(e,t=!0)=>e?Object.entries(e).reduce((e,n)=>{const[r,o]=n;let i,a;return Array.isArray(o)?(a="",o.forEach(e=>{i=t?encodeURIComponent(e):e,a+=`${r}=${i}&`}),a.slice(0,-1)):(i=t?encodeURIComponent(o):o,a=`${r}=${i}`),`${e}&${a}`},"").substr(1):null,I=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),r=E(e.headers)["content-type"]||"";if("string"==typeof e.data)n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,r]of Object.entries(e.data||{}))t.set(n,r);n.body=t.toString()}else if(r.includes("multipart/form-data")){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,n)=>{t.append(n,e)});else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const r=new Headers(n.headers);r.delete("content-type"),n.headers=r}else(r.includes("application/json")||"object"==typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class C extends f{async request(e){const t=I(e,e.webFetchExtra),n=S(e.params,e.shouldEncodeUrlParams),r=n?`${e.url}?${n}`:e.url,o=await fetch(r,t),i=o.headers.get("content-type")||"";let a,s,{responseType:c="text"}=o.ok?e:{};switch(i.includes("application/json")&&(c="json"),c){case"arraybuffer":case"blob":s=await o.blob(),a=await b(s);break;case"json":a=await o.json();break;case"document":case"text":default:a=await o.text()}const l={};return o.headers.forEach((e,t)=>{l[t]=e}),{data:a,headers:l,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}const w=p("CapacitorHttp",{web:()=>new C});n.Capacitor=d,n.CapacitorCookies=v,n.CapacitorException=c,n.CapacitorHttp=w,n.CapacitorPlatforms=r,n.Plugins=h,n.WebPlugin=f,n.WebView=g,n.addPlatform=o,n.registerPlugin=p,n.registerWebPlugin=e=>a(d,e),n.setPlatform=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("tslib"),o=e("@firebase/app");e("@firebase/installations");var i=e("@firebase/logger"),a=e("@firebase/util"),s=e("@firebase/component");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l,u,d=c(o),p="firebase_id",h="origin",f=6e4,g="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",_="https://www.googletagmanager.com/gtag/js";function m(e,t,n,o,i){return r.__awaiter(this,void 0,void 0,function(){var a,s;return r.__generator(this,function(c){switch(c.label){case 0:return i&&i.global?(e(l.EVENT,n,o),[2]):[3,1];case 1:return[4,t];case 2:a=c.sent(),s=r.__assign(r.__assign({},o),{send_to:a}),e(l.EVENT,n,s),c.label=3;case 3:return[2]}})})}function y(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var i;return r.__generator(this,function(r){switch(r.label){case 0:return o&&o.global?(e(l.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,t];case 2:i=r.sent(),e(l.CONFIG,i,{update:!0,screen_name:n}),r.label=3;case 3:return[2]}})})}function v(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var i;return r.__generator(this,function(r){switch(r.label){case 0:return o&&o.global?(e(l.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,t];case 2:i=r.sent(),e(l.CONFIG,i,{update:!0,user_id:n}),r.label=3;case 3:return[2]}})})}function b(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var i,a,s,c,u;return r.__generator(this,function(r){switch(r.label){case 0:if(!o||!o.global)return[3,1];for(i={},a=0,s=Object.keys(n);a<s.length;a++)c=s[a],i["user_properties."+c]=n[c];return e(l.SET,i),[2,Promise.resolve()];case 1:return[4,t];case 2:u=r.sent(),e(l.CONFIG,u,{update:!0,user_properties:n}),r.label=3;case 3:return[2]}})})}function E(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),window["ga-disable-"+n]=!t,[2]}})})}(function(e){e.EVENT="event",e.SET="set",e.CONFIG="config"})(l||(l={})),function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(u||(u={}));var S,I=new i.Logger("@firebase/analytics");function C(e){var t=document.createElement("script");t.src=_+"?l="+e,t.async=!0,document.head.appendChild(t)}function w(e){var t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}function P(e,t,n,o,i,a){return r.__awaiter(this,void 0,void 0,function(){var s,c,u,d;return r.__generator(this,function(r){switch(r.label){case 0:s=o[i],r.label=1;case 1:return r.trys.push([1,7,,8]),s?[4,t[s]]:[3,3];case 2:return r.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return c=r.sent(),(u=c.find(function(e){return e.measurementId===i}))?[4,t[u.appId]]:[3,6];case 5:r.sent(),r.label=6;case 6:return[3,8];case 7:return d=r.sent(),I.error(d),[3,8];case 8:return e(l.CONFIG,i,a),[2]}})})}function O(e,t,n,o,i){return r.__awaiter(this,void 0,void 0,function(){var a,s,c,u,d,p,h,f;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),a=[],i&&i.send_to?(s=i.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(c=r.sent(),u=function(e){var n=c.find(function(t){return t.measurementId===e}),r=n&&t[n.appId];if(!r)return a=[],"break";a.push(r)},d=0,p=s;d<p.length&&(h=p[d],"break"!==u(h));d++);r.label=2;case 2:return 0===a.length&&(a=Object.values(t)),[4,Promise.all(a)];case 3:return r.sent(),e(l.EVENT,o,i||{}),[3,5];case 4:return f=r.sent(),I.error(f),[3,5];case 5:return[2]}})})}function A(e,t,n,o){return function(i,a,s){return r.__awaiter(this,void 0,void 0,function(){var c;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),i!==l.EVENT?[3,2]:[4,O(e,t,n,a,s)];case 1:return r.sent(),[3,5];case 2:return i!==l.CONFIG?[3,4]:[4,P(e,t,n,o,a,s)];case 3:return r.sent(),[3,5];case 4:e(l.SET,a),r.label=5;case 5:return[3,7];case 6:return c=r.sent(),I.error(c),[3,7];case 7:return[2]}})})}}function R(e,t,n,r,o){var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[r].push(arguments)};return window[o]&&"function"==typeof window[o]&&(i=window[o]),window[o]=A(i,e,t,n),{gtagCore:i,wrappedGtag:window[o]}}function N(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(_))return r}return null}var T=((S={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",S["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",S["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",S["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",S["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",S["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",S["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",S["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',S["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',S),L=new a.ErrorFactory("analytics","Analytics",T),D=30,M=1e3,U=new(function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=M),this.throttleMetadata=e,this.intervalMillis=t}return e.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},e.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},e.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},e}());function F(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function k(e){var t;return r.__awaiter(this,void 0,void 0,function(){var n,o,i,a,s,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.appId,o=e.apiKey,i={method:"GET",headers:F(o)},a=g.replace("{app-id}",n),[4,fetch(a,i)];case 1:if(200===(s=r.sent()).status||304===s.status)return[3,6];c="",r.label=2;case 2:return r.trys.push([2,4,,5]),[4,s.json()];case 3:return l=r.sent(),(null===(t=l.error)||void 0===t?void 0:t.message)&&(c=l.error.message),[3,5];case 4:return r.sent(),[3,5];case 5:throw L.create("config-fetch-failed",{httpStatus:s.status,responseMessage:c});case 6:return[2,s.json()]}})})}function j(e,t,n){return void 0===t&&(t=U),r.__awaiter(this,void 0,void 0,function(){var o,i,a,s,c,l,u=this;return r.__generator(this,function(){if(o=e.options,i=o.appId,a=o.apiKey,s=o.measurementId,!i)throw L.create("no-app-id");if(!a){if(s)return[2,{measurementId:s,appId:i}];throw L.create("no-api-key")}return c=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new H,setTimeout(function(){return r.__awaiter(u,void 0,void 0,function(){return r.__generator(this,function(){return l.abort(),[2]})})},void 0!==n?n:f),[2,x({appId:i,apiKey:a,measurementId:s},c,l,t)]})})}function x(e,t,n,o){var i=t.throttleEndTimeMillis,s=t.backoffCount;return void 0===o&&(o=U),r.__awaiter(this,void 0,void 0,function(){var t,c,l,u,d,p,h;return r.__generator(this,function(r){switch(r.label){case 0:t=e.appId,c=e.measurementId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,B(n,i)];case 2:return r.sent(),[3,4];case 3:if(l=r.sent(),c)return I.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+c+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:t,measurementId:c}];throw l;case 4:return r.trys.push([4,6,,7]),[4,k(e)];case 5:return u=r.sent(),o.deleteThrottleMetadata(t),[2,u];case 6:if(!G(d=r.sent())){if(o.deleteThrottleMetadata(t),c)return I.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+c+' provided in the "measurementId" field in the local Firebase config. ['+d.message+"]"),[2,{appId:t,measurementId:c}];throw d}return p=503===Number(d.httpStatus)?a.calculateBackoffMillis(s,o.intervalMillis,D):a.calculateBackoffMillis(s,o.intervalMillis),h={throttleEndTimeMillis:Date.now()+p,backoffCount:s+1},o.setThrottleMetadata(t,h),I.debug("Calling attemptFetch again in "+p+" millis"),[2,x(e,h,n,o)];case 7:return[2]}})})}function B(e,t){return new Promise(function(n,r){var o=Math.max(t-Date.now(),0),i=setTimeout(n,o);e.addEventListener(function(){clearTimeout(i),r(L.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function G(e){if(!(e instanceof a.FirebaseError))return!1;var t=Number(e.httpStatus);return 429===t||500===t||503===t||504===t}var H=function(){function e(){this.listeners=[]}return e.prototype.addEventListener=function(e){this.listeners.push(e)},e.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},e}();function V(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return a.isIndexedDBAvailable()?[3,1]:(I.warn(L.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return t.trys.push([1,3,,4]),[4,a.validateIndexedDBOpenable()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),I.warn(L.create("indexeddb-unavailable",{errorInfo:e}).message),[2,!1];case 4:return[2,!0]}})})}function W(e,t,n,o,i){return r.__awaiter(this,void 0,void 0,function(){var a,s,c,u,d,f,g;return r.__generator(this,function(r){switch(r.label){case 0:return(a=j(e)).then(function(t){n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&I.warn("The measurement ID in the local Firebase config ("+e.options.measurementId+") does not match the measurement ID fetched from the server ("+t.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(e){return I.error(e)}),t.push(a),s=V().then(function(e){return e?o.getId():void 0}),[4,Promise.all([a,s])];case 1:return c=r.sent(),u=c[0],d=c[1],i("js",new Date),(g={})[h]="firebase",g.update=!0,f=g,null!=d&&(f[p]=d),i(l.CONFIG,u.measurementId,f),[2,u.measurementId]}})})}var z,q,J={},K=[],Y={},Q="dataLayer",Z="gtag",X=!1;function $(e){if(X)throw L.create("already-initialized");e.dataLayerName&&(Q=e.dataLayerName),e.gtagName&&(Z=e.gtagName)}function ee(){var e=[];if(a.isBrowserExtension()&&e.push("This is a browser extension environment."),a.areCookiesEnabled()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"("+(t+1)+") "+e}).join(" "),n=L.create("invalid-analytics-context",{errorInfo:t});I.warn(n.message)}}function te(e,t){ee();var n=e.options.appId;if(!n)throw L.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw L.create("no-api-key");I.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=J[n])throw L.create("already-exists",{id:n});if(!X){N()||C(Q),w(Q);var r=R(J,K,Y,Q,Z),o=r.wrappedGtag,i=r.gtagCore;q=o,z=i,X=!0}return J[n]=W(e,K,Y,t,z),{app:e,logEvent:function(e,t,r){m(q,J[n],e,t,r).catch(function(e){return I.error(e)})},setCurrentScreen:function(e,t){y(q,J[n],e,t).catch(function(e){return I.error(e)})},setUserId:function(e,t){v(q,J[n],e,t).catch(function(e){return I.error(e)})},setUserProperties:function(e,t){b(q,J[n],e,t).catch(function(e){return I.error(e)})},setAnalyticsCollectionEnabled:function(e){E(J[n],e).catch(function(e){return I.error(e)})},INTERNAL:{delete:function(){return delete J[n],Promise.resolve()}}}}var ne="@firebase/analytics",re="0.6.0",oe="analytics";function ie(e){e.INTERNAL.registerComponent(new s.Component(oe,function(e){return te(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:$,EventName:u,isSupported:ae})),e.INTERNAL.registerComponent(new s.Component("analytics-internal",function(e){try{return{logEvent:e.getProvider(oe).getImmediate().logEvent}}catch(t){throw L.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),e.registerVersion(ne,re)}function ae(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:if(a.isBrowserExtension())return[2,!1];if(!a.areCookiesEnabled())return[2,!1];if(!a.isIndexedDBAvailable())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a.validateIndexedDBOpenable()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}})})}ie(d.default),n.factory=te,n.getGlobalVars=function(){return{initializationPromisesMap:J,dynamicConfigPromisesList:K}},n.registerAnalytics=ie,n.resetGlobalVars=function(e,t,n){void 0===e&&(e=!1),void 0===t&&(t={}),void 0===n&&(n=[]),X=e,J=t,K=n,Q="dataLayer",Z="gtag"},n.settings=$},{"@firebase/app":4,"@firebase/component":6,"@firebase/installations":8,"@firebase/logger":10,"@firebase/util":11,tslib:3}],3:[function(e,t){(function(e){var n,r,o,i,a,s,c,l,u,d,p,h,f,g,_,m,y,v,b,E,S,I,C;(function(n){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function o(e,t){return e!==r&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){n(o(r,o(e)))}):"object"==typeof t&&"object"==typeof t.exports?n(o(r,o(t.exports))):n(o(r))})(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};n=function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},i=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=function(e,t){return function(n,r){t(n,r,e)}},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},C=function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},u=function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},d=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e},f=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},g=function(e){return this instanceof g?(this.v=e,this):new g(e)},_=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=o[e](t)).value instanceof g?Promise.resolve(n.value.v).then(c,l):u(i[0][2],n)}catch(r){u(i[0][3],r)}var n}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}},m=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:g(e[r](t)),done:"return"===r}:o?o(t):t}:o}},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){o(r,i,(t=e[n](t)).done,t.value)})}}function o(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}},v=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},E=function(e){return e&&e.__esModule?e:{default:e}},S=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},I=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},e("__extends",n),e("__assign",r),e("__rest",o),e("__decorate",i),e("__param",a),e("__metadata",s),e("__awaiter",c),e("__generator",l),e("__exportStar",u),e("__createBinding",C),e("__values",d),e("__read",p),e("__spread",h),e("__spreadArrays",f),e("__await",g),e("__asyncGenerator",_),e("__asyncDelegator",m),e("__asyncValues",y),e("__makeTemplateObject",v),e("__importStar",b),e("__importDefault",E),e("__classPrivateFieldGet",S),e("__classPrivateFieldSet",I)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o,i=e("tslib"),a=e("@firebase/util"),s=e("@firebase/component"),c=e("@firebase/logger"),l=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),u=new a.ErrorFactory("app","Firebase",l),d="[DEFAULT]",p=((o={})["@firebase/app"]="fire-core",o["@firebase/analytics"]="fire-analytics",o["@firebase/auth"]="fire-auth",o["@firebase/database"]="fire-rtdb",o["@firebase/functions"]="fire-fn",o["@firebase/installations"]="fire-iid",o["@firebase/messaging"]="fire-fcm",o["@firebase/performance"]="fire-perf",o["@firebase/remote-config"]="fire-rc",o["@firebase/storage"]="fire-gcs",o["@firebase/firestore"]="fire-fst",o["fire-js"]="fire-js",o["firebase-wrapper"]="fire-js-all",o),h=new c.Logger("@firebase/app"),f=function(){function e(e,t,n){var r,o,c=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(e),this.container=new s.ComponentContainer(t.name),this._addComponent(new s.Component("app",function(){return c},"PUBLIC"));try{for(var l=i.__values(this.firebase_.INTERNAL.components.values()),u=l.next();!u.done;u=l.next()){var d=u.value;this._addComponent(d)}}catch(p){r={error:p}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,t){return void 0===t&&(t=d),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=d),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){h.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();f.prototype.name&&f.prototype.options||f.prototype.delete||console.log("dc");var g="7.20.0";function _(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,o){void 0===o&&(o={}),"object"==typeof o&&null!==o||(o={name:o});var i=o;void 0===i.name&&(i.name=d);var s=i.name;if("string"!=typeof s||!s)throw u.create("bad-app-name",{appName:String(s)});if(a.contains(t,s))throw u.create("duplicate-app",{appName:s});var c=new e(n,i,r);return t[s]=c,c},app:o,registerVersion:function(e,t,n){var r,o=null!==(r=p[e])&&void 0!==r?r:e;n&&(o+="-"+n);var i=o.match(/\s|\//),a=t.match(/\s|\//);if(i||a){var c=['Unable to register library "'+o+'" with version "'+t+'":'];return i&&c.push('library name "'+o+'" contains illegal characters (whitespace or "/")'),i&&a&&c.push("and"),a&&c.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void h.warn(c.join(" "))}l(new s.Component(o+"-version",function(){return{library:o,version:t}},"VERSION"))},setLogLevel:c.setLogLevel,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw u.create("invalid-log-argument",{appName:name});c.setUserLogHandler(e,t)},apps:null,SDK_VERSION:g,INTERNAL:{registerComponent:l,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function o(e){if(e=e||d,!a.contains(t,e))throw u.create("no-app",{appName:e});return t[e]}function l(s){var c,l,d=s.name;if(n.has(d))return h.debug("There were multiple attempts to register component "+d+"."),"PUBLIC"===s.type?r[d]:null;if(n.set(d,s),"PUBLIC"===s.type){var p=function(e){if(void 0===e&&(e=o()),"function"!=typeof e[d])throw u.create("invalid-app-argument",{appName:d});return e[d]()};void 0!==s.serviceProps&&a.deepExtend(p,s.serviceProps),r[d]=p,e.prototype[d]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,d);return n.apply(this,s.multipleInstances?e:[])}}try{for(var f=i.__values(Object.keys(t)),g=f.next();!g.done;g=f.next()){var _=g.value;t[_]._addComponent(s)}}catch(m){c={error:m}}finally{try{g&&!g.done&&(l=f.return)&&l.call(f)}finally{if(c)throw c.error}}return"PUBLIC"===s.type?r[d]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map(function(e){return t[e]})}}),o.App=e,r}var m=function e(){var t=_(f);return t.INTERNAL=i.__assign(i.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){a.deepExtend(t,e)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),t}(),y=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(v(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null}).filter(function(e){return e}).join(" ")},e}();function v(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}if(a.isBrowser()&&void 0!==self.firebase){h.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var b=self.firebase.SDK_VERSION;b&&b.indexOf("LITE")>=0&&h.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var E=m.initializeApp;m.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.isNode()&&h.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),E.apply(void 0,e)};var S=m;(function(e){e.INTERNAL.registerComponent(new s.Component("platform-logger",function(e){return new y(e)},"PRIVATE")),e.registerVersion("@firebase/app","0.6.11",void 0),e.registerVersion("fire-js","")})(S),n.default=S,n.firebase=S},{"@firebase/component":6,"@firebase/logger":10,"@firebase/util":11,tslib:5}],5:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("tslib"),o=e("@firebase/util"),i=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e}(),a="[DEFAULT]",s=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e=a);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new o.Deferred;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=r.__assign({identifier:a,optional:!1},e),n=t.identifier,o=t.optional,i=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(i);if(!s){if(o)return null;throw Error("Service "+this.name+" is not available")}return s}catch(c){if(o)return null;throw c}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,l(e))try{this.getOrInitializeService(a)}catch(h){}try{for(var o=r.__values(this.instancesDeferred.entries()),i=o.next();!i.done;i=o.next()){var s=r.__read(i.value,2),c=s[0],u=s[1],d=this.normalizeInstanceIdentifier(c);try{var p=this.getOrInitializeService(d);u.resolve(p)}catch(h){}}}catch(f){t={error:f}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.clearInstance=function(e){void 0===e&&(e=a),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spread(e.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}),e.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()})))];case 1:return t.sent(),[2]}})})},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,c(e)),this.instances.set(e,t)),t||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:a:e},e}();function c(e){return e===a?void 0:e}function l(e){return"EAGER"===e.instantiationMode}var u=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new s(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();n.Component=i,n.ComponentContainer=u,n.Provider=s},{"@firebase/util":11,tslib:7}],7:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@firebase/app"),o=e("@firebase/component"),i=e("tslib"),a=e("@firebase/util"),s=e("idb");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l,u=c(r),d="@firebase/installations",p="0.4.17",h=1e4,f="w:"+p,g="FIS_v2",_="https://firebaseinstallations.googleapis.com/v1",m=36e5,y=((l={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',l["not-registered"]="Firebase Installation is not registered.",l["installation-not-found"]="Firebase Installation not found.",l["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',l["app-offline"]="Could not process request. Application offline.",l["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",l),v=new a.ErrorFactory("installations","Installations",y);function b(e){return e instanceof a.FirebaseError&&e.code.includes("request-failed")}function E(e){var t=e.projectId;return _+"/projects/"+t+"/installations"}function S(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function I(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r;return i.__generator(this,function(o){switch(o.label){case 0:return[4,t.json()];case 1:return n=o.sent(),r=n.error,[2,v.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}})})}function C(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function w(e,t){var n=t.refreshToken,r=C(e);return r.append("Authorization",O(n)),r}function P(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,e()];case 1:return(t=n.sent()).status>=500&&t.status<600?[2,e()]:[2,t]}})})}function O(e){return g+" "+e}function A(e,t){var n=t.fid;return i.__awaiter(this,void 0,void 0,function(){var t,r,o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return t=E(e),r=C(e),o={fid:n,authVersion:g,appId:e.appId,sdkVersion:f},a={method:"POST",headers:r,body:JSON.stringify(o)},[4,P(function(){return fetch(t,a)})];case 1:return(s=i.sent()).ok?[4,s.json()]:[3,3];case 2:return[2,{fid:(c=i.sent()).fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:S(c.authToken)}];case 3:return[4,I("Create Installation",s)];case 4:throw i.sent()}})})}function R(e){return new Promise(function(t){setTimeout(t,e)})}var N=/^[cdef][\w-]{21}$/,T="";function L(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=D(e);return N.test(t)?t:T}catch(l){return T}}function D(e){var t;return(t=e,btoa(String.fromCharCode.apply(String,i.__spread(t))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}function M(e){return e.appName+"!"+e.appId}var U=new Map;function F(e,t){var n=M(e);x(n,t),B(n,t)}function k(e,t){H();var n=M(e),r=U.get(n);r||(r=new Set,U.set(n,r)),r.add(t)}function j(e,t){var n=M(e),r=U.get(n);r&&(r.delete(t),0===r.size&&U.delete(n),V())}function x(e,t){var n,r,o=U.get(e);if(o)try{for(var a=i.__values(o),s=a.next();!s.done;s=a.next())(0,s.value)(t)}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}function B(e,t){var n=H();n&&n.postMessage({key:e,fid:t}),V()}var G=null;function H(){return!G&&"BroadcastChannel"in self&&((G=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){x(e.data.key,e.data.fid)}),G}function V(){0===U.size&&G&&(G.close(),G=null)}var W="firebase-installations-database",z=1,q="firebase-installations-store",J=null;function K(){return J||(J=s.openDb(W,z,function(e){switch(e.oldVersion){case 0:e.createObjectStore(q)}})),J}function Y(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:return n=M(e),[4,K()];case 1:return r=i.sent(),o=r.transaction(q,"readwrite"),[4,(a=o.objectStore(q)).get(n)];case 2:return s=i.sent(),[4,a.put(t,n)];case 3:return i.sent(),[4,o.complete];case 4:return i.sent(),s&&s.fid===t.fid||F(e,t.fid),[2,t]}})})}function Q(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r;return i.__generator(this,function(o){switch(o.label){case 0:return t=M(e),[4,K()];case 1:return n=o.sent(),[4,(r=n.transaction(q,"readwrite")).objectStore(q).delete(t)];case 2:return o.sent(),[4,r.complete];case 3:return o.sent(),[2]}})})}function Z(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return n=M(e),[4,K()];case 1:return r=i.sent(),o=r.transaction(q,"readwrite"),[4,(a=o.objectStore(q)).get(n)];case 2:return s=i.sent(),void 0!==(c=t(s))?[3,4]:[4,a.delete(n)];case 3:return i.sent(),[3,6];case 4:return[4,a.put(c,n)];case 5:i.sent(),i.label=6;case 6:return[4,o.complete];case 7:return i.sent(),!c||s&&s.fid===c.fid||F(e,c.fid),[2,c]}})})}function X(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r;return i.__generator(this,function(o){switch(o.label){case 0:return[4,Z(e,function(n){var r=$(n),o=ee(e,r);return t=o.registrationPromise,o.installationEntry})];case 1:return(n=o.sent()).fid!==T?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=o.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}})})}function $(e){return oe(e||{fid:L(),registrationStatus:0})}function ee(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(v.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:te(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:ne(e)}:{installationEntry:t}}function te(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r;return i.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,A(e,t)];case 1:return n=o.sent(),[2,Y(e,n)];case 2:return b(r=o.sent())&&409===r.serverCode?[4,Q(e)]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,Y(e,{fid:t.fid,registrationStatus:0})];case 5:o.sent(),o.label=6;case 6:throw r;case 7:return[2]}})})}function ne(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,re(e)];case 1:t=i.sent(),i.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,R(100)];case 3:return i.sent(),[4,re(e)];case 4:return t=i.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,X(e)];case 6:return n=i.sent(),r=n.installationEntry,(o=n.registrationPromise)?[2,o]:[2,r];case 7:return[2,t]}})})}function re(e){return Z(e,function(e){if(!e)throw v.create("installation-not-found");return oe(e)})}function oe(e){return 1===(t=e).registrationStatus&&t.registrationTime+h<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function ie(e,t){var n=e.appConfig,r=e.platformLoggerProvider;return i.__awaiter(this,void 0,void 0,function(){var e,o,a,s,c,l;return i.__generator(this,function(i){switch(i.label){case 0:return e=ae(n,t),o=w(n,t),(a=r.getImmediate({optional:!0}))&&o.append("x-firebase-client",a.getPlatformInfoString()),s={installation:{sdkVersion:f}},c={method:"POST",headers:o,body:JSON.stringify(s)},[4,P(function(){return fetch(e,c)})];case 1:return(l=i.sent()).ok?[4,l.json()]:[3,3];case 2:return[2,S(i.sent())];case 3:return[4,I("Generate Auth Token",l)];case 4:throw i.sent()}})})}function ae(e,t){var n=t.fid;return E(e)+"/"+n+"/authTokens:generate"}function se(e,t){return void 0===t&&(t=!1),i.__awaiter(this,void 0,void 0,function(){var n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Z(e.appConfig,function(r){if(!de(r))throw v.create("not-registered");var o=r.authToken;if(!t&&pe(o))return r;if(1===o.requestStatus)return n=ce(e,t),r;if(!navigator.onLine)throw v.create("app-offline");var i=fe(r);return n=ue(e,i),i})];case 1:return r=i.sent(),n?[4,n]:[3,3];case 2:return o=i.sent(),[3,4];case 3:o=r.authToken,i.label=4;case 4:return[2,o]}})})}function ce(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r;return i.__generator(this,function(o){switch(o.label){case 0:return[4,le(e.appConfig)];case 1:n=o.sent(),o.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,R(100)];case 3:return o.sent(),[4,le(e.appConfig)];case 4:return n=o.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,se(e,t)]:[2,r]}})})}function le(e){return Z(e,function(e){if(!de(e))throw v.create("not-registered");var t;return 1===(t=e.authToken).requestStatus&&t.requestTime+h<Date.now()?i.__assign(i.__assign({},e),{authToken:{requestStatus:0}}):e})}function ue(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o;return i.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,8]),[4,ie(e,t)];case 1:return n=a.sent(),o=i.__assign(i.__assign({},t),{authToken:n}),[4,Y(e.appConfig,o)];case 2:return a.sent(),[2,n];case 3:return!b(r=a.sent())||401!==r.serverCode&&404!==r.serverCode?[3,5]:[4,Q(e.appConfig)];case 4:return a.sent(),[3,7];case 5:return o=i.__assign(i.__assign({},t),{authToken:{requestStatus:0}}),[4,Y(e.appConfig,o)];case 6:a.sent(),a.label=7;case 7:throw r;case 8:return[2]}})})}function de(e){return void 0!==e&&2===e.registrationStatus}function pe(e){return 2===e.requestStatus&&!he(e)}function he(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+m}function fe(e){var t={requestStatus:1,requestTime:Date.now()};return i.__assign(i.__assign({},e),{authToken:t})}function ge(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r;return i.__generator(this,function(o){switch(o.label){case 0:return[4,X(e.appConfig)];case 1:return t=o.sent(),n=t.installationEntry,(r=t.registrationPromise)?r.catch(console.error):se(e).catch(console.error),[2,n.fid]}})})}function _e(e,t){return void 0===t&&(t=!1),i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(n){switch(n.label){case 0:return[4,me(e.appConfig)];case 1:return n.sent(),[4,se(e,t)];case 2:return[2,n.sent().token]}})})}function me(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,X(e)];case 1:return(t=n.sent().registrationPromise)?[4,t]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}function ye(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o,a;return i.__generator(this,function(i){switch(i.label){case 0:return n=ve(e,t),r=w(e,t),o={method:"DELETE",headers:r},[4,P(function(){return fetch(n,o)})];case 1:return(a=i.sent()).ok?[3,3]:[4,I("Delete Installation",a)];case 2:throw i.sent();case 3:return[2]}})})}function ve(e,t){var n=t.fid;return E(e)+"/"+n}function be(e){return i.__awaiter(this,void 0,void 0,function(){var t,n;return i.__generator(this,function(r){switch(r.label){case 0:return[4,Z(t=e.appConfig,function(e){if(!e||0!==e.registrationStatus)return e})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw v.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw v.create("app-offline");case 3:return[4,ye(t,n)];case 4:return r.sent(),[4,Q(t)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}function Ee(e,t){var n=e.appConfig;return k(n,t),function(){j(n,t)}}function Se(e){var t,n;if(!e||!e.options)throw Ie("App Configuration");if(!e.name)throw Ie("App Name");try{for(var r=i.__values(["projectId","apiKey","appId"]),o=r.next();!o.done;o=r.next()){var a=o.value;if(!e.options[a])throw Ie(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function Ie(e){return v.create("missing-app-config-values",{valueName:e})}function Ce(e){e.INTERNAL.registerComponent(new o.Component("installations",function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:Se(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return ge(n)},getToken:function(e){return _e(n,e)},delete:function(){return be(n)},onIdChange:function(e){return Ee(n,e)}}},"PUBLIC")),e.registerVersion(d,p)}Ce(u.default),n.registerInstallations=Ce},{"@firebase/app":4,"@firebase/component":6,"@firebase/util":11,idb:15,tslib:9}],9:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],10:[function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var o;Object.defineProperty(n,"__esModule",{value:!0});var i,a=[];(i=n.LogLevel||(n.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var s={debug:n.LogLevel.DEBUG,verbose:n.LogLevel.VERBOSE,info:n.LogLevel.INFO,warn:n.LogLevel.WARN,error:n.LogLevel.ERROR,silent:n.LogLevel.SILENT},c=n.LogLevel.INFO,l=((o={})[n.LogLevel.DEBUG]="log",o[n.LogLevel.VERBOSE]="log",o[n.LogLevel.INFO]="info",o[n.LogLevel.WARN]="warn",o[n.LogLevel.ERROR]="error",o),u=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(t<e.logLevel)){var i=(new Date).toISOString(),a=l[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[a].apply(console,r(["["+i+"]  "+e.name+":"],n))}},d=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=u,this._userLogHandler=null,a.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in n.LogLevel))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?s[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,n.LogLevel.DEBUG],e)),this._logHandler.apply(this,r([this,n.LogLevel.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,n.LogLevel.VERBOSE],e)),this._logHandler.apply(this,r([this,n.LogLevel.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,n.LogLevel.INFO],e)),this._logHandler.apply(this,r([this,n.LogLevel.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,n.LogLevel.WARN],e)),this._logHandler.apply(this,r([this,n.LogLevel.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,n.LogLevel.ERROR],e)),this._logHandler.apply(this,r([this,n.LogLevel.ERROR],e))},e}();n.Logger=d,n.setLogLevel=function(e){a.forEach(function(t){t.setLogLevel(e)})},n.setUserLogHandler=function(e,t){for(var r=function(r){var o=null;t&&t.level&&(o=s[t.level]),r.userLogHandler=null===e?null:function(t,r){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(function(e){return e}).join(" ");r>=(null!=o?o:t.logLevel)&&e({level:n.LogLevel[r].toLowerCase(),message:s,args:i,type:t.name})}},o=0,i=a;o<i.length;o++)r(i[o])}},{}],11:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("tslib"),o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):55296==(64512&o)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},c=function(e){for(var t=[],n=0,r=0;n<e.length;){var o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){var i=e[n++];t[r++]=String.fromCharCode((31&o)<<6|63&i)}else if(o>239&&o<365){var a=((7&o)<<18|(63&(i=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{i=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&o)<<12|(63&i)<<6|63&s)}}return t.join("")},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],o=0;o<e.length;o+=3){var i=e[o],a=o+1<e.length,s=a?e[o+1]:0,c=o+2<e.length,l=c?e[o+2]:0,u=i>>2,d=(3&i)<<4|s>>4,p=(15&s)<<2|l>>6,h=63&l;c||(h=64,a||(p=64)),r.push(n[u],n[d],n[p],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):c(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],o=0;o<e.length;){var i=n[e.charAt(o++)],a=o<e.length?n[e.charAt(o)]:0,s=++o<e.length?n[e.charAt(o)]:64,c=++o<e.length?n[e.charAt(o)]:64;if(++o,null==i||null==a||null==s||null==c)throw Error();var l=i<<2|a>>4;if(r.push(l),64!==s){var u=a<<4&240|s>>2;if(r.push(u),64!==c){var d=s<<6&192|c;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},u=function(e){try{return l.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=d(e[n],t[n]));return e}var p=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}();function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}var g="FirebaseError",_=function(e){function t(n,r){var o=e.call(this,r)||this;return o.code=n,o.name=g,Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,m.prototype.create),o}return r.__extends(t,e),t}(Error),m=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},o=this.service+"/"+e,i=this.errors[e],a=i?y(i,r):"Error",s=this.serviceName+": "+a+" ("+o+").",c=new _(o,s),l=0,u=Object.keys(r);l<u.length;l++){var d=u[l];"_"!==d.slice(-1)&&(d in c&&console.warn('Overwriting FirebaseError base field "'+d+'" can cause unexpected behavior.'),c[d]=r[d])}return c},e}();function y(e,t){return e.replace(v,function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"})}var v=/\{\$([^}]+)}/g;function b(e){return JSON.parse(e)}var E=function(e){var t={},n={},r={},o="";try{var i=e.split(".");t=b(u(i[0])||""),n=b(u(i[1])||""),o=i[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:o}},S=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var o=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(o<<1|o>>>31)}var i,a,s=this.chain_[0],c=this.chain_[1],l=this.chain_[2],u=this.chain_[3],d=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(i=u^c&(l^u),a=1518500249):(i=c^l^u,a=1859775393):r<60?(i=c&l|u&(c|l),a=2400959708):(i=c^l^u,a=3395469782),o=(s<<5|s>>>27)+i+d+a+n[r]&4294967295,d=u,u=l,l=4294967295&(c<<30|c>>>2),c=s,s=o;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,o=this.buf_,i=this.inbuf_;r<t;){if(0===i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(o[i]=e.charCodeAt(r),++r,++i===this.blockSize){this.compress_(o),i=0;break}}else for(;r<t;)if(o[i]=e[r],++r,++i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var o=24;o>=0;o-=8)e[r]=this.chain_[n]>>o&255,++r;return e},e}(),I=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=C(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?r.error(o.finalError):r.complete()}catch(e){}}),this.observers.push(r),i},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function C(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o in e&&"function"==typeof e[o])return!0}return!1}function w(){}function P(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+(r+" argument ")}n.CONSTANTS=o,n.Deferred=p,n.ErrorFactory=m,n.FirebaseError=_,n.MAX_VALUE_MILLIS=144e5,n.RANDOM_FACTOR=.5,n.Sha1=S,n.areCookiesEnabled=function(){return!(!navigator||!navigator.cookieEnabled)},n.assert=i,n.assertionError=a,n.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}},n.base64=l,n.base64Decode=u,n.base64Encode=function(e){var t=s(e);return l.encodeByteArray(t,!0)},n.calculateBackoffMillis=function(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),o=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+o)},n.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.createSubscribe=function(e,t){var n=new I(e,t);return n.subscribe.bind(n)},n.decode=E,n.deepCopy=function(e){return d(void 0,e)},n.deepExtend=d,n.errorPrefix=P,n.getUA=h,n.isAdmin=function(e){var t=E(e).claims;return"object"==typeof t&&!0===t.admin},n.isBrowser=function(){return"object"==typeof self&&self.self===self},n.isBrowserExtension=function(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},n.isElectron=function(){return h().indexOf("Electron/")>=0},n.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},n.isIE=function(){var e=h();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},n.isIndexedDBAvailable=function(){return"indexedDB"in self&&null!=indexedDB},n.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())},n.isNode=f,n.isNodeSdk=function(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN},n.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},n.isSafari=function(){return!f()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},n.isUWP=function(){return h().indexOf("MSAppHost/")>=0},n.isValidFormat=function(e){var t=E(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},n.isValidTimestamp=function(e){var t=E(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,o=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),o=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!o&&n>=r&&n<=o},n.issuedAtTime=function(e){var t=E(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},n.jsonEval=b,n.map=function(e,t,n){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=t.call(n,e[o],o,e));return r},n.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,o=Object.entries(e);r<o.length;r++){var i=o[r];n(i[0],i[1])}return t.length?"&"+t.join("&"):""},n.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t},n.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},n.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},n.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319){var a=o-55296;i(++r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},n.stringify=function(e){return JSON.stringify(e)},n.validateArgCount=function(e,t,n,r){var o;if(r<t?o="at least "+t:r>n&&(o=0===n?"none":"no more than "+n),o)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+o+".")},n.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(P(e,t,r)+"must be a valid function.")},n.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(P(e,t,r)+"must be a valid context object.")},n.validateIndexedDBOpenable=function(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",o=window.indexedDB.open(r);o.onsuccess=function(){o.result.close(),n||window.indexedDB.deleteDatabase(r),e(!0)},o.onupgradeneeded=function(){n=!1},o.onerror=function(){var e;t((null===(e=o.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})},n.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(P(e,t,r)+"must be a valid firebase namespace.")}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{tslib:12}],12:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],13:[function(e){"use strict";e("@firebase/analytics")},{"@firebase/analytics":2}],14:[function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e("@firebase/app"));r.default.registerVersion("firebase","7.24.0","app"),t.exports=r.default},{"@firebase/app":4}],15:[function(e,t,n){(function(e,r){"object"==typeof n&&void 0!==t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).idb={})})(this,function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function r(e,t,r){var o,i=new Promise(function(i,a){n(o=e[t].apply(e,r)).then(i,a)});return i.request=o,i}function o(e,t,n){var o=r(e,t,n);return o.then(function(e){if(e)return new u(e,o.request)})}function i(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function a(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return r(this[t],o,arguments)})})}function s(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function c(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return o(this[t],r,arguments)})})}function l(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function d(e){this._store=e}function p(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function h(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new p(n)}function f(e){this._db=e}i(l,"_index",["name","keyPath","multiEntry","unique"]),a(l,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(l,"_index",IDBIndex,["openCursor","openKeyCursor"]),i(u,"_cursor",["direction","key","primaryKey","value"]),a(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(u.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then(function(e){if(e)return new u(e,t._request)})})})}),d.prototype.createIndex=function(){return new l(this._store.createIndex.apply(this._store,arguments))},d.prototype.index=function(){return new l(this._store.index.apply(this._store,arguments))},i(d,"_store",["name","keyPath","indexNames","autoIncrement"]),a(d,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(d,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(d,"_store",IDBObjectStore,["deleteIndex"]),p.prototype.objectStore=function(){return new d(this._tx.objectStore.apply(this._tx,arguments))},i(p,"_tx",["objectStoreNames","mode"]),s(p,"_tx",IDBTransaction,["abort"]),h.prototype.createObjectStore=function(){return new d(this._db.createObjectStore.apply(this._db,arguments))},i(h,"_db",["name","version","objectStoreNames"]),s(h,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new p(this._db.transaction.apply(this._db,arguments))},i(f,"_db",["name","version","objectStoreNames"]),s(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[d,l].forEach(function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],o=this._store||this._index,i=o[e].apply(o,n.slice(0,-1));i.onsuccess=function(){r(i.result)}})})}),[l,d].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(o){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)})})})}),e.openDb=function(e,t,n){var o=r(indexedDB,"open",[e,t]),i=o.request;return i&&(i.onupgradeneeded=function(e){n&&n(new h(i.result,e.oldVersion,i.transaction))}),o.then(function(e){return new f(e)})},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})})},{}],FirebaseApi:[function(e,t,n){"use strict";cc._RF.push(t,"d6bf5Voqq5Acr6MVa+HyvOb","FirebaseApi");var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.FirebaseApi=void 0;var i=e("./ParseNetwork"),a=e("../../../queue"),s=e("../domain/parseConstants"),c=e("../lib/profile"),l=e("../util-logger"),u=e("../lib/constants"),d=function(){function e(){}return e.getInstance=function(){return e.i||(e.i=new e),e.i},e.prototype.getAuthHeader=function(){return{Accept:"application/json"}},e.prototype.teacherRequestAccepted=function(e){return r(this,void 0,void 0,function(){var t;return o(this,function(){return e.teacherId&&(t={homeId:e.studentId,teacherId:e.teacherId,kind:"UpdateHomeTeacher",firebaseStudentId:e.firebaseStudentId,studentName:e.studentName,schoolId:e.teacherId,sectionId:e.sectionId},a.Queue.getInstance().push(t)),[2]})})},e.prototype.updateProgress=function(e){return r(this,void 0,Promise,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return e.studentId&&e.studentId.length>0?(t=c.User.getCurrentUser(),n={url:s.FIREBASE_UPDATE_PROGRESS_URL,body:{chapterId:e.chapter,chapterName:e.chapterName,lessonName:e.lessonName,lessonId:e.lesson,userId:e.studentId,courseName:e.courseName,score:e.assessment,assignmentId:e.assignmentId,dateTimeStamp:e.dateTimeStamp,timeSpent:e.timespent,name:t.name}},[4,i.ParseNetwork.getInstance().post(n,this.getAuthHeader())]):[3,2];case 1:return[2,r.sent()];case 2:return[2]}})})},e.prototype.syncFailedProgresses=function(e){return r(this,void 0,Promise,function(){var t,n,r;return o(this,function(o){switch(o.label){case 0:return Array.isArray(e)&&e.length>0?(t=c.User.getCurrentUser(),n=e.map(function(e){return{lessonId:e.lesson,userId:e.studentId,courseName:e.courseName,score:e.assessment,assignmentId:e.assignmentId,timeSpent:e.timespent,name:t.name}}),r={url:s.FIREBASE_SYNC_FAILED_PROGRESS_URL,body:{data:n}},[4,i.ParseNetwork.getInstance().post(r,this.getAuthHeader())]):[3,2];case 1:return[2,o.sent()];case 2:return[2]}})})},e.prototype.schoolById=function(e){return r(this,void 0,Promise,function(){var t,n,r;return o(this,function(o){switch(o.label){case 0:return t=null,n={url:s.FIREBASE_SCHOOL_URL+e},[4,i.ParseNetwork.getInstance().get(n,e,this.getAuthHeader())];case 1:return r=o.sent()||[],console.log("school id",r),r&&Array.isArray(r)&&r.length>0&&(t=r[0]),[2,t]}})})},e.prototype.updateHomeTeacher=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.teacherId&&e.teacherId.length>0&&e.homeId&&e.homeId.length>0?(t={url:s.FIREBASE_UPDATE_HOME_TEACHER_URL,body:e},[4,i.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.listAssignments=function(e,t){return void 0===t&&(t=10),r(this,void 0,void 0,function(){var t,n,r,a,d,p,h,f,g,_,m,y;return o(this,function(o){switch(o.label){case 0:return t=[],n={url:s.FIREBASE_LIST_ASSIGNMENTS+e},r=parseInt(c.default.getValue(c.CURRENTMODE)),[4,i.ParseNetwork.getInstance().get(n,null,this.getAuthHeader())];case 1:return a=o.sent()||[],r!=u.Mode.HomeConnect&&(a&&"link"in a&&!a.link?null!=(d=c.User.getCurrentUser())&&(p="teacher_for_student_"+c.User.getCurrentUser().id,h=(h=JSON.parse(cc.sys.localStorage.getItem(p)||"[]")).filter(function(e){return e!==c.User.getCurrentUser().sectionName}),cc.sys.localStorage.setItem(p,JSON.stringify(h)),d.studentId=null,d.sectionId=null,d.schoolId=null,d.schoolName=null,d.sectionName=null,d.isConnected=!1,d.storeUser()):a.studentId&&r!=u.Mode.School&&r!=u.Mode.HomeConnect&&(f=a.studentId,g=a.sectionId,_=a.schoolId,m=a.sectionName,y=a.schoolName,l.default.processLinkStudent(g,_,f,y,m,null))),console.log("assignments query result",a),this.buildAssignments(t,[].concat(a.results)),[2,t.reverse()]}})})},e.prototype.buildAssignments=function(e,t){try{if(c.User.getCurrentUser()){var n=c.User.getCurrentUser().lessonProgressMap,r=[];t.forEach(function(e){return r=r.concat(e)}),r.forEach(function(t){var r={},o=!0;r.assignmentId=t.assignmentId,r.chapterId=t.chapter,r.lessonId=t.lesson,r.lessonName=t.lessonName,r.courseCode=t.subject.courseCode;var i=t.createAt.toString();if(i)if(8===i.length){var a=i.substring(0,4),s=i.substring(4,6),l=i.substring(6,8);r.createAt=new Date(a,s-1,l)}else i=1e3*Number(t.createAt._seconds),r.createAt=new Date(i);else r.createAt=new Date;if(n.has(t.lesson)){var u=c.User.getCurrentUser().lessonProgressMap.get(t.lesson);null==u?o=!0:null===u.assignmentIds||void 0===u.assignmentIds||0===u.assignmentIds.length?o=!0:null!==u.assignmentIds&&u.assignmentIds.length>0&&!u.assignmentIds.includes(t.assignmentId)&&(o=!0),o&&e.push(r)}else e.push(r)}),e=(e=e.filter(function(e,t,n){return n.findIndex(function(t){return t.chapterId===e.chapterId&&t.lessonId===e.lessonId})===t})).sort(function(e,t){return e.createAt>t.createAt?1:-1})}}catch(o){e=[]}return e},e.prototype.linkStudent=function(e,t,n,a,c,l){return void 0===n&&(n=null),void 0===a&&(a=null),void 0===c&&(c=null),void 0===l&&(l=null),r(this,void 0,Promise,function(){var r,u;return o(this,function(o){switch(o.label){case 0:return e&&e.length>0&&t&&t.length>0?(r=Number(t),u={url:s.FIREBASE_LINK_STUDENT_URL,body:{studentId:e,code:r,version:2,phoneNumber:n,age:a,name:c,countryCode:l}},[4,i.ParseNetwork.getInstance().post(u,this.getAuthHeader())]):[3,2];case 1:return[2,o.sent()];case 2:return[2]}})})},e.prototype.getLeaderboard=function(e,t,n){return r(this,void 0,Promise,function(){var r,a,c,l,u,d,p,h,f;return o(this,function(o){switch(o.label){case 0:return r={url:s.FIREBASE_GET_LEADERBOARD_URL+"?progressId="+e+"&sectionId="+t+"&schoolId="+n},[4,i.ParseNetwork.getInstance().get(r,null,this.getAuthHeader())];case 1:if(a=o.sent()||{},c={weekly:[],allTime:[]},Object.keys(a).length){for(l=[],u=[],d=0,p=Object.keys(a);d<p.length;d++)h=p[d],l.push({name:a[h].n,score:a[h].w.s,timeSpent:a[h].w.t,lessonsPlayed:a[h].w.l,userId:h}),u.push({name:a[h].n,score:a[h].a.s,timeSpent:a[h].a.t,lessonsPlayed:a[h].a.l,userId:h});return(f=function(e){return e.sort(function(e,t){return t.lessonsPlayed-e.lessonsPlayed||e.timeSpent-t.timeSpent||t.score-e.score})})(l),f(u),[2,c={weekly:l,allTime:u}]}return[2,c]}})})},e.prototype.customAuth=function(e,t,n,a,l,u,d,p,h){return r(this,void 0,Promise,function(){var r,f,g;return o(this,function(o){switch(o.label){case 0:return n&&n.length>0&&e&&e.length>0?(r=Number(e),f={url:s.FIREBASE_CUSTOM_AUTH_URL,body:{progressId:n,code:r,version:2,phoneNumber:t,isSecondProfile:a,schoolId:l,age:p,name:u,countryCode:d,gender:h===c.Gender.BOY?"male":h===c.Gender.GIRL?"female":null}},console.log("req params",f),[4,i.ParseNetwork.getInstance().post(f,this.getAuthHeader())]):[3,2];case 1:return[2,{email:(g=o.sent()).data.email,progressId:g.data.progressId,schoolId:g.data.schoolId,schoolName:g.data.schoolName,sectionId:g.data.sectionId,sectionName:g.data.sectionName,student:g.data.student,studentId:g.data.studentId}];case 2:return[2]}})})},e}();n.FirebaseApi=d,cc._RF.pop()},{"../../../queue":"queue","../domain/parseConstants":"parseConstants","../lib/constants":"constants","../lib/profile":"profile","../util-logger":"util-logger","./ParseNetwork":"ParseNetwork"}],ParseImageDownloader:[function(e,t,n){"use strict";cc._RF.push(t,"b1d9baNS35ECb5weFAJ5gKr","ParseImageDownloader"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseImageDownloader=void 0;var r=e("./ParseNetwork"),o=e("../util-logger"),i=function(){function e(){}return e.checkIfImageAlreadyDownloaded=function(e){return r.ParseNetwork.getInstance().getStringFromCache(e)},e.loadImage=function(t,n){if(t&&(!t||-1!=t.indexOf("/")))if(e.downloadStatuses.get(t))cc.log("downloading in progress ...",t);else if(e.downloadStatuses.set(t,!0),e.isNative()){var r=t.substring(t.lastIndexOf("/")+1);e.downloadImageFromNetworkAndSave(t,r,n)}else e.loadImageFromNetwork(t,t,n)},e.getHash=function(e){for(var t=0,n=e?e.length:0,r=0;r<n;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t},e.loadImageForSchool=function(t,n,r){if(t&&(!t||-1!=t.indexOf("/")))if(e.downloadStatuses.get(t))cc.log("downloading in progress ...",t);else{e.downloadStatuses.set(t,!0);var o=n+"_"+e.getHash(t);e.isNative()?e.downloadImageFromNetworkAndSave(t,o,r):e.loadImageFromNetwork(t,t,r)}},e.downloadImageFromNetworkAndSave=function(t,n,i){var a=this,s=jsb.fileUtils.getWritablePath()+"/school-photos/";if(cc.log("_storagePath",s),!jsb.fileUtils.createDirectory(s))return cc.log("Failed to create storage path, downloader won't work correctly"),void e.downloadStatuses.set(t,!1);var c=s+(n+=".jpg"),l=o.default.isNetworkAvailable();if(r.ParseNetwork.getInstance().getStringFromCache(c))return cc.log("image found in cache",c),void this.loadImageFromNetwork(t,c,i);if(l){var u=new jsb.Downloader;u.setOnFileTaskSuccess(function(e){cc.log("setOnFileTaskSuccess called for:",e.requestURL," stored: ",e.storagePath),r.ParseNetwork.getInstance().storeIntoCache(e.storagePath,"true"),a.loadImageFromNetwork(e.requestURL,e.storagePath,i)}),u.setOnTaskError(function(t,n,r,o){e.downloadStatuses.set(t.requestURL,!1),cc.log("Failed to download file ("+t.requestURL+"): "+o+"("+n+")"),a.clearDownloadStatus(t.requestURL)}),u.createDownloadFileTask(t,c)}},e.clearDownloadStatus=function(t){cc.log("clear download status",t),e.downloadStatuses.delete(t)},e.loadImageFromNetwork=function(e,t,n){try{cc.assetManager.loadRemote(t,function(e,r){!e&&r?(cc.log("successfully loadImageFromNetwork",t),n(r)):cc.log("failed loadImageFromNetwork",t)})}catch(r){cc.error(r),n(null)}finally{this.clearDownloadStatus(e)}},e.isNative=function(){return cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID},e.downloadStatuses=new Map,e}();n.ParseImageDownloader=i,cc._RF.pop()},{"../util-logger":"util-logger","./ParseNetwork":"ParseNetwork"}],ParseNetwork:[function(e,t,n){"use strict";cc._RF.push(t,"0488c1hOmBHirQ4TvGnU1WD","ParseNetwork");var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ParseNetwork=n.PARSE_CACHE=void 0;var a=e("./parseApi"),s=e("../domain/parseConstants"),c=e("../../../queue"),l=e("../util-logger"),u=e("../lib/profile"),d=e("../lib/constants"),p=e("../../../chimple"),h=e("./ServiceConfig");n.PARSE_CACHE="PARSE_CACHE",cc.processQueue=function(){f.getInstance().consumeMessage()};var f=function(){function e(){this.cacheTimeInMillis=6e4,this.cachedApiTimings=new Map,this.isHandlerBusy=!1,this.handler=null}return e.init=function(){e.getInstance()},e.getInstance=function(){if(!e.instance){e.instance=new e;var t=e.instance.getParseObjectFromCache(n.PARSE_CACHE);t&&Object.keys(t).forEach(function(n){e.instance.cachedApiTimings.set(n,t[n])}),a.ParseApi.getInstance(),e.instance.startOnlyIfWeb()}return e.instance},e.prototype.withQuery=function(e,t,n,r,o){if(!t)return e;var i=this.queryParams(t,n),a=-1===e.indexOf("?")?"?":"&";return i?e+a+i+(r?"&include="+r:"")+(o?"&keys="+o:""):e},e.prototype.queryParams=function(e,t){return t?"where="+JSON.stringify(e):Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},e.prototype.parseXHRResult=function(e){var t=""===e.responseType||"text"===e.responseType;return e.responseType,{ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText,responseType:e.responseType,headers:e.getAllResponseHeaders(),data:t?e.responseText:e.response}},e.prototype.errorResponse=function(e,t){return void 0===t&&(t=null),{ok:!1,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:t||e.statusText}},e.prototype.storeIntoCache=function(e,t){var n="object"==typeof t?JSON.stringify(t):t;cc.sys.localStorage.setItem(e,n)},e.prototype.removeFromCache=function(e){cc.sys.localStorage.removeItem(e)},e.prototype.getStringFromCache=function(e){return cc.sys.localStorage.getItem(e)},e.prototype.getParseObjectFromCache=function(e){try{return JSON.parse(cc.sys.localStorage.getItem(e))}catch(t){return null}},e.prototype.createMonitor=function(t,n){return void 0===n&&(n=null),o(this,void 0,void 0,function(){var r,o,a;return i(this,function(i){switch(i.label){case 0:r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.getInstance().request(s.POST,t,n)];case 2:return o=i.sent(),cc.log(o),[3,4];case 3:return a=i.sent(),cc.log("exception:",a),[3,4];case 4:return[2,r]}})})},e.prototype.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e.prototype.isCacheValidForKey=function(t){var n=(new Date).getTime(),r=e.getInstance().cachedApiTimings.get(t)||0,o=e.getInstance().getStringFromCache(t),i=!1;try{var a=JSON.parse(o);i=!e.getInstance().isEmpty(a)}catch(s){}return n<r&&i},e.prototype.get=function(t,n,r){return o(this,void 0,void 0,function(){var o,a,c;return i(this,function(i){switch(i.label){case 0:o=null,i.label=1;case 1:return i.trys.push([1,5,,6]),n&&e.getInstance().isCacheValidForKey(n)?(o=e.getInstance().getParseObjectFromCache(n),[3,4]):[3,2];case 2:return[4,e.getInstance().request(s.GET,t,r)];case 3:a=i.sent(),o=e.getInstance().processResult(a,n),i.label=4;case 4:return[3,6];case 5:return c=i.sent(),cc.log("exception:",c),[3,6];case 6:return[2,o]}})})},e.prototype.update=function(t,n){return o(this,void 0,Promise,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.getInstance().request(s.PUT,t,n)];case 1:return r=i.sent(),cc.log("result:",r),[3,3];case 2:return o=i.sent(),cc.log("exception:",o),[3,3];case 3:return[2]}})})},e.prototype.post=function(t,n){return o(this,void 0,Promise,function(){var r,o;return i(this,function(i){switch(i.label){case 0:r=null,cc.log("calling post request with options",JSON.stringify(n)),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.getInstance().request(s.POST,t,n)];case 2:if(r=i.sent(),cc.log("result:",r),!r.ok)throw cc.log("processing failed to due:",r.data),Error(JSON.stringify(r.data));return[3,4];case 3:throw o=i.sent(),cc.log("exception:",o),o;case 4:return[2,r]}})})},e.prototype.createPointer=function(e,t){return{__type:"Pointer",className:e,objectId:t}},e.prototype.createFilePointer=function(e,t){return{__type:"File",name:e,url:t}},e.prototype.processResult=function(t,r){var o=null;try{if(t&&t.data&&t.ok&&!t.data.error){""===t.responseType||t.responseType;var i="json"===t.responseType,a="arraybuffer"===t.responseType,s=(new Date).getTime()+e.getInstance().cacheTimeInMillis;if(i)"results"in(o=t.data)&&Array.isArray(o.results)&&"link"in o&&!o.link&&(o.results=null),r&&e.getInstance().storeIntoCache(r,o),e.getInstance().cachedApiTimings.set(r,s);else if(a){var c=this.createBase64Image(t);r&&e.getInstance().storeIntoCache(r,c),e.getInstance().cachedApiTimings.set(r,s)}}else o=r?e.getInstance().getParseObjectFromCache(r):null}catch(u){cc.log("exception",u)}finally{var l={};e.getInstance().cachedApiTimings.forEach(function(e,t){t&&(l[t]=e)}),e.getInstance().storeIntoCache(n.PARSE_CACHE,l)}return o},e.prototype.createBase64Image=function(e){for(var t=new Uint8Array(e.data),n=t.length,r=new Array(n);n--;)r[n]=String.fromCharCode(t[n]);return window.btoa(r.join(""))},e.prototype.request=function(e,t,n){var r=this,o=t.url,i=t.queryParams,a=t.body,c=t.isWhereQuery,l=t.includeParam,u=t.keysParam,d=n.ignoreCache||!1,p=n.headers,h=n.timeout||s.DEFAULT_TIMEOUT;return new Promise(function(t){var f=cc.loader.getXMLHttpRequest();f.responseType=n.responseType?n.responseType:"json";var g=r.withQuery(o,i,c,l,u);f.open(e,g,!0),p&&Object.keys(p).forEach(function(e){return f.setRequestHeader(e,p[e])}),d&&f.setRequestHeader("Cache-Control","no-cache"),f.timeout=h,f.onload=function(){t(r.parseXHRResult(f))},f.onerror=function(){t(r.errorResponse(f,"Failed to make request."))},f.ontimeout=function(){t(r.errorResponse(f,"Request took longer than expected."))},e!==s.POST&&e!==s.PUT||!a?f.send():(f.setRequestHeader("Content-Type","application/json"),f.send(JSON.stringify(a)))})},e.prototype.updateProgress=function(e){cc.log("calling update progress API"),h.ServiceConfig.getI().handle.updateProgress(e).then(function(){l.default.logChimpleEvent(s.UPDATE_PROGRESS,e)}).catch(function(){var t=JSON.parse(cc.sys.localStorage.getItem(s.SYNC_PROGRESS_FAILED)||"[]"),n=r({},e);t.push(n),cc.sys.localStorage.setItem(s.SYNC_PROGRESS_FAILED,JSON.stringify(t))})},e.prototype.consumeMessage=function(){var t=this;if(!e.getInstance().isHandlerBusy){this.isHandlerBusy=!0;for(var n=function(){var n=c.Queue.getInstance().pop();if(cc.log("found payload to process",n),n)switch(n.kind){case"Progress":var r=JSON.parse(cc.sys.localStorage.getItem(s.SYNC_PROGRESS_FAILED)||"[]");Array.isArray(r)&&r.length>0?h.ServiceConfig.getI().handle.syncFailedProgresses(r).then(function(){cc.log("Successfully Synced Failed Progress"),cc.sys.localStorage.removeItem(s.SYNC_PROGRESS_FAILED),e.getInstance().updateProgress(n)}).catch(function(){}):e.getInstance().updateProgress(n);break;case"Monitor":cc.log("calling update monitor API"),a.ParseApi.getInstance().updateMonitor(n).then(function(e){cc.log(e),l.default.logChimpleEvent(s.UPDATE_MONITOR,n)}).catch(function(){});break;case"Profile":cc.log("calling update profile API"),a.ParseApi.getInstance().updateProfile(n).then(function(){cc.log("successfully updated profile ",n.studentId),l.default.logChimpleEvent(s.UPDATE_PROFILE,n)}).catch(function(e){cc.log("failed to update profile ",n.studentId," with error ",e)});break;case"UpdateHomeTeacher":cc.log("calling update home teacher API"),h.ServiceConfig.getI().handle.updateHomeTeacher(n).then(function(e){cc.log(e),t.onHomeTeacherSuccess(n.homeId,n.homeId),l.default.logChimpleEvent(s.UPDATE_HOME_TEACHER,n)}).catch(function(){});break;case"AssignHomeWork":cc.log("calling assign Homework API"),a.ParseApi.getInstance().assignHomeWork(n).then(function(e){cc.log(e),l.default.logChimpleEvent(p.ASSIGN_HOMEWORK,n)}).catch(function(){});default:cc.log("found payload with no handler.. ignoring",n)}};!c.Queue.getInstance().isEmpty();)n();this.isHandlerBusy=!1,cc.log("finished queue processing -> resetting isHandlerBusy",this.isHandlerBusy)}},e.prototype.onHomeTeacherSuccess=function(t,n){var r=u.User.getUsers().find(function(e){return e.id===t});r&&(r.serverId=n,u.User.getCurrentUser().id===t&&(e.getInstance().storeIntoCache(d.CURRENT_STUDENT_ID,n),u.User.getCurrentUser().serverId=n))},e.prototype.startOnlyIfWeb=function(){cc.sys.isBrowser&&(e.getInstance().clearScheduler(),e.getInstance().startScheduler())},e.prototype.startScheduler=function(){this.handler=setInterval(this.consumeMessage,d.QUEUE_OFFLOAD_FREQUENCY)},e.prototype.clearScheduler=function(){this.handler&&clearInterval(this.handler)},e}();n.ParseNetwork=f,cc._RF.pop()},{"../../../chimple":"chimple","../../../queue":"queue","../domain/parseConstants":"parseConstants","../lib/constants":"constants","../lib/profile":"profile","../util-logger":"util-logger","./ServiceConfig":"ServiceConfig","./parseApi":"parseApi"}],ServiceApi:[function(e,t,n){"use strict";cc._RF.push(t,"d77f6wZhCZKfKN+tYODzqnp","ServiceApi"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],ServiceConfig:[function(e,t,n){"use strict";cc._RF.push(t,"df461yN7TNGR7R/gyDF2Kpr","ServiceConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.ServiceConfig=n.APIMode=void 0;var r,o=e("./ApiHandler"),i=e("./parseApi"),a=e("./FirebaseApi"),s=e("./ParseNetwork");(function(e){e[e.PARSE=0]="PARSE",e[e.FIREBASE=1]="FIREBASE"})(r=n.APIMode||(n.APIMode={}));var c=function(){function e(){}return e.getInstance=function(t){switch(e.instance||(e.instance=new e,e.instance.mode=t,s.ParseNetwork.getInstance()),t){case r.FIREBASE:this.instance.initializeFireBase();break;case r.PARSE:this.instance.initializeParse()}return e.instance},e.getI=function(){return e.instance},e.prototype.initializeParse=function(){this._handler=o.ApiHandler.getInstance(i.ParseApi.getInstance())},e.prototype.initializeFireBase=function(){this._handler=o.ApiHandler.getInstance(a.FirebaseApi.getInstance())},Object.defineProperty(e.prototype,"handle",{get:function(){return this._handler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(e){this._mode=e},enumerable:!1,configurable:!0}),e}();n.ServiceConfig=c,cc._RF.pop()},{"./ApiHandler":"ApiHandler","./FirebaseApi":"FirebaseApi","./ParseNetwork":"ParseNetwork","./parseApi":"parseApi"}],Utility:[function(e,t,n){"use strict";cc._RF.push(t,"2dfc9KbwGJJOKsnH1/ZwZLx","Utility"),Object.defineProperty(n,"__esModule",{value:!0}),n.AlphabetUtil=n.LetterType=void 0;var r,o=e("./lib/config"),i=e("./util");(function(e){e[e.Consonant=0]="Consonant",e[e.Vowel=1]="Vowel"})(r=n.LetterType||(n.LetterType={}));var a={"en/":[["a","e","i","o","u"],["b","c","d","f","g","h","j","k","l","m","n","p","q","r","s","t","v","w","x","y","z"]],"hi/":[["\u0905","\u0906","\u0907","\u0908","\u0909","\u090a","\u090b","\u090f","\u0910","\u0913","\u0914","\u0905\u0902","\u0905\u0903","\u0905\u0901"],["\u0915","\u0916","\u0917","\u0918","\u0919","\u091a","\u091b","\u091c","\u091d","\u091e","\u091f","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092a","\u092b","\u092c","\u092d","\u092e","\u092f","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939"]],"kn/":[["\u0c85","\u0c86","\u0c87","\u0c88","\u0c89","\u0c8a","\u0c8b","\u0ce0   \u0c8e","\u0c8f","\u0c90","\u0c92","\u0c93","\u0c94   \u0c82","\u0c83"],["\u0c95","\u0c96","\u0c97","\u0c98","\u0c99","\u0c9a","\u0c9b","\u0c9c","\u0c9d","\u0c9e   \u0c9f","\u0ca0","\u0ca1","\u0ca2","\u0ca3","\u0ca4","\u0ca5","\u0ca6","\u0ca7","\u0ca8","\u0caa","\u0cab","\u0cac","\u0cad","\u0cae   \u0caf","\u0cb0","\u0cb2","\u0cb3","\u0cb5","\u0cb6","\u0cb7","\u0cb8","\u0cb9"]],"mr/":[["\u0905","\u0906","\u0907","\u0908","\u0909","\u090a","\u090f","\u0910","\u0913","\u0914","\u0905\u0902","\u0905\u0903"],["\u0915","\u0916","\u0917","\u0918","\u0918","\u091a","\u091b","\u091c","\u091d","\u091e","\u091f","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092a","\u092b","\u092c","\u092d","\u092e","\u092f","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939","\u0933","\u0915\u094d","\u0937","\u091c\u094d\u091e"]]},s=function(){function e(){}return e.isConsonantOrVowel=function(t){return e.contains(a[o.default.i.course.lang+"/"][0],t)?r.Vowel:r.Consonant},e.getRandomVowel=function(){return a[o.default.i.course.lang+"/"][0][Math.floor(Math.random()*a[o.default.i.course.lang+"/"][0].length)].toUpperCase()},e.getRandomConsonant=function(){return a[o.default.i.course.lang+"/"][1][Math.floor(Math.random()*a[o.default.i.course.lang+"/"][1].length)].toUpperCase()},e.getRandomConsonantArray=function(e){return a[e][1]},e.contains=function(e,t){return e.indexOf(t)>-1},e.getRandomVowelArray=function(t){if(t>5)throw new Error("Size should be less than or equal to 21");for(var n=new Array(t),r=0;r<t;r++){var o=this.getRandomVowel();e.contains(n,o)?r--:n[r]=o}return n.forEach(function(e){console.log("Random Vowels Generated "+e)}),n},e.playLetterSound=function(e,t){t?i.Util.load(o.default.dir+"sound/wordvoice/"+e+".mp3",function(e,t){cc.log("Audio Error: "+e),cc.audioEngine.play(t,!1,1)},!0):i.Util.load(o.default.dir+"sound/lettervoice/"+e+".mp3",function(e,t){cc.log("Audio Error: "+e),cc.audioEngine.play(t,!1,1)},!0)},e}();n.AlphabetUtil=s,cc._RF.pop()},{"./lib/config":"config","./util":"util"}],achievement:[function(e,t,n){"use strict";cc._RF.push(t,"1086d51yhBIZpt83nyiEavl","achievement");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../scripts/util"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.reward=null,t.gold=null,t.silver=null,t.bronze=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;a.Util.load(this.courseId+"/course/res/icons/"+this.image,function(t,n){t||(e.reward.spriteFrame=new cc.SpriteFrame(n))}),this.getComponent(cc.Sprite).spriteFrame=this.score>90?this.gold:this.score>80?this.silver:this.bronze},i([l(cc.Sprite)],t.prototype,"reward",void 0),i([l(cc.SpriteFrame)],t.prototype,"gold",void 0),i([l(cc.SpriteFrame)],t.prototype,"silver",void 0),i([l(cc.SpriteFrame)],t.prototype,"bronze",void 0),i([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"../../scripts/util":"util"}],"answer-grid":[function(e,t,n){"use strict";cc._RF.push(t,"efe32Be6zlNM4Qf/FTLzyS9","answer-grid");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.HELP_BTN=n.CONFIRM_BUTTON_CLICKED=n.CLEAR_BUTTON_CLICKED=n.ANSWER_GRID_BUTTON_CLICKED=n.NUMBER_LABEL=n.BACK_GROUND=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("./lib/error-handler");n.BACK_GROUND="Background",n.NUMBER_LABEL="numberLabel",n.ANSWER_GRID_BUTTON_CLICKED="ANSWER_GRID_BUTTON_CLICKED",n.CLEAR_BUTTON_CLICKED="CLEAR_BUTTON_CLICKED",n.CONFIRM_BUTTON_CLICKED="CONFIRM_BUTTON_CLICKED",n.HELP_BTN="HELP_BTN";var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numberBtnPrefab=null,t.numberpads=[],t.delay=2,t.result=null,t.correctBtns=[],t}return o(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){this.createGrid(this.delay)},t.prototype.createGrid=function(e){var t=this;void 0===e&&(e=2),this.addDummyBtn(this.node,null);for(var r=0;r<=this.numberpads.length-1;r++)this.addNumberBtn(this.node,this.numberpads[r]),0==r&&this.addDummyBtn(this.node,null);this.scheduleOnce(function(){if(null!==t.correctBtns&&t.correctBtns.length>0){var e=new cc.Event.EventCustom(n.HELP_BTN,!0);e.setUserData({helpNodes:t.correctBtns}),t.node.dispatchEvent(e)}},e)},t.prototype.addNumberBtn=function(e,t){var r=cc.instantiate(this.numberBtnPrefab),o=r.getChildByName(n.BACK_GROUND);if(o){var i=o.getChildByName(n.NUMBER_LABEL),a=i.getComponent(cc.Label);i.color=(new cc.Color).fromHEX("#654321"),a.string=t,i.addComponent(cc.LabelOutline).width=2}if(e.addChild(r),this.result&&this.result.includes(t)){var s=this.result.indexOf(t);this.correctBtns.splice(s,0,r)}},t.prototype.addDummyBtn=function(e){var t=new cc.Node;e.addChild(t)},i([s(cc.Prefab)],t.prototype,"numberBtnPrefab",void 0),i([c.default()],t.prototype,"start",null),i([c.default()],t.prototype,"createGrid",null),i([c.default()],t.prototype,"addNumberBtn",null),i([c.default()],t.prototype,"addDummyBtn",null),i([a],t)}(cc.Component);n.default=l,cc._RF.pop()},{"./lib/error-handler":"error-handler"}],"arrow-node":[function(e,t,n){"use strict";cc._RF.push(t,"59fe67aM39CLrMyO7fbCg85","arrow-node");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentPath=null,t.arrowValue=0,t.starCounter=0,t.location=null,t}return o(t,e),t.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},i([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{}],"auto-drag":[function(e,t,n){"use strict";cc._RF.push(t,"3b63fCgv6BHronsT9XJa36c","auto-drag");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./drag"),s=e("./drop"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._originalPosition=null,t._isDragging=!1,t.match=!1,t.matchingNode=null,t._dropObject=null,t}return o(t,e),t.prototype.onLoad=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this)},t.prototype.onTouchStart=function(){a.default.letDrag&&!this.isDragging&&this.allowDrag&&(this._originalPosition=this.node.position,this.updateDropNode())},t.prototype.findMatch=function(){var e=this;this.match?(this.allowDrag=!1,this._isDragging=!1,(new cc.Tween).target(this.node).to(.3,{position:this.node.parent.convertToNodeSpaceAR(this.matchingNode.convertToWorldSpaceAR(cc.Vec2.ZERO))},null).call(this.onMatchOver.bind(this)).start()):this.returnBackOnNoMatch?(new cc.Tween).target(this.node).to(1,{position:this._originalPosition},{progress:null,easing:"sineOut"}).call(function(){e.allowDrag=!0,e._isDragging=!1,a.default.letDrag=!0}).call(this.onMatchFail.bind(this)).start():(this.allowDrag=!0,a.default.letDrag=!0,this._isDragging=!1)},t.prototype.onCollisionEnter=function(e,t){this.allowDrag&&!this.isDragging&&this.collisionEnterCondition(t,e)&&e.node.getComponent(s.default).allowDrop&&(this.match=!0,this.matchingNode=e.node)},t.prototype.onTouchEnd=function(){var e=this;this.allowDrag&&!this._isDragging&&null!==this._dropObject&&(this._isDragging=!0,(new cc.Tween).target(this.node).to(.3,{position:this.node.parent.convertToNodeSpaceAR(this._dropObject.convertToWorldSpaceAR(cc.Vec2.ZERO))},null).call(function(){e.findMatch()}).start())},t.prototype.updateDropNode=function(){this._dropObject=this.findDropNode()},t.prototype.disableTouch=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this)},t.prototype.onDestroy=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this)},t.prototype.onMatchOver=function(){if(a.default.letDrag=!0,this.allowDrag=!1,this.fixOnMatch){var e=this.matchingNode;this.node.opacity=0,this.node.removeFromParent(!1),this.node.position=cc.Vec2.ZERO,e.addChild(this.node),e.getComponent(s.default).onMatchOver()}else this.allowDrag=!0},t.prototype.onMatchFail=function(){},i([l],t)}(a.default));n.default=u,cc._RF.pop()},{"./drag":"drag","./drop":"drop"}],backButton:[function(e,t,n){"use strict";cc._RF.push(t,"7082dngCaFG/b2DSeSfDxXQ","backButton");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./lib/config"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.extraFunction=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;this.node.once("touchend",function(){e.node.getComponent(cc.Button).interactable=!1,e.extraFunction&&e.extraFunction(),a.default.i.popScene()})},i([c],t)}(cc.Component));n.default=l,cc._RF.pop()},{"./lib/config":"config"}],balloon:[function(e,t,n){"use strict";cc._RF.push(t,"eda288WiitPBJHPq4tfrMas","balloon");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.BalloonType=n.MATHS_GAMES=n.LITERACY_GAMES=void 0;var a=e("./lib/config"),s=e("./util"),c=cc._decorator,l=c.ccclass,u=c.property;n.LITERACY_GAMES="literacy",n.MATHS_GAMES="maths";var d,p=!0;(function(e){e[e.Game=0]="Game",e[e.Type=1]="Type"})(d=n.BalloonType||(n.BalloonType={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.game=null,t.seat=null,t.image=null,t.icon=null,t.chimp=null,t.doneIcon=null,t.done=!1,t.waitingIcon=null,t.waiting=!1,t.glow=null,t.stars=null,t.appearAudio=null,t._color=null,t.onClickCallback=null,t.level=0,t.stopZigzag=!1,t.type=d.Game,t}return o(t,e),t.prototype.onLoad=function(){var e=this;a.default.i,p=!0,this.done||null==this.doneIcon||(this.doneIcon.active=!1),this.type==d.Type&&("en"==this.game?(this.label.string="English",this._color=(new cc.Color).fromHEX("#FFD141")):"hi"==this.game?(this.label.string="\u0939\u093f\u0928\u094d\u0926\u0940",this._color=(new cc.Color).fromHEX("#5E9C46")):"en-maths"==this.game?(this.label.string="Maths",this._color=(new cc.Color).fromHEX("#6A5AAB")):"hi-maths"==this.game?(this.label.string="\u0917\u0923\u093f\u0924",this._color=(new cc.Color).fromHEX("#6A5AAB")):"ur"==this.game?(this.label.string="\u0627\u0631\u062f\u0648",this._color=(new cc.Color).fromHEX("#5E9C46")):"ur-maths"==this.game&&(this.label.string="\u0631\u06cc\u0627\u0636\u06cc",this._color=(new cc.Color).fromHEX("#6A5AAB"))),this.image&&this._color&&(this.image.color=this._color);var t=this.node.getComponent(cc.Button);null!=t&&(t.interactable=!1),this.waitingIcon.active=!0,s.Util.downloadIfNeeded(this.node,this.game,this.level,function(t){if(t){var n=e.node.getComponent(cc.Button);null!=n&&(n.interactable=!0),e.setIcon(),e.waitingIcon.active=!1}})},t.prototype.setIcon=function(){var e=this,t=(a.COURSES.indexOf(this.game)>=0?this.game:a.default.i.course.id)+"/common/res/icons/"+this.game+".png";s.Util.load(t,function(t,n){t||(e.icon.spriteFrame=new cc.SpriteFrame(n))})},Object.defineProperty(t.prototype,"color",{set:function(e){this._color=e,this.image.color=e},enumerable:!1,configurable:!0}),t.prototype.onBalloonClick=function(){p&&null!=this.chimp&&(p=!1,this.onClickCallback())},t.prototype.flyToNest=function(e){void 0===e&&(e=null);var t=cc.director.getScene().getChildByName("nest"),n=null!=t?t.position:cc.v2(cc.winSize.width-65,cc.winSize.height-61);this.node.runAction(cc.sequence(cc.bezierTo(2,[cc.v2((n.x-this.node.x)/4,(n.y-118-this.node.y)/4),cc.v2((n.x-this.node.x)/2,(n.y-118-this.node.y)/2),cc.v2(n.x,n.y-118)]),cc.callFunc(function(){null!=e&&e()})))},t.prototype.jumpChimpToBalloon=function(e){var t=this,n=this.chimp.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(this.seat.position));this.chimp.runAction(cc.sequence([cc.bezierTo(1,[cc.v2(this.chimp.x,this.chimp.y+100),cc.v2(n.x/2,n.y+100)]),cc.callFunc(function(){t.chimp.position=cc.Vec2.ZERO,t.chimp.removeFromParent(!1),t.seat.addChild(t.chimp),null!=e&&e()})]))},t.prototype.jumpChimpFromBalloon=function(e){this.chimp.position=cc.director.getScene().convertToNodeSpaceAR(this.chimp.parent.convertToWorldSpaceAR(this.chimp.position)),this.chimp.removeFromParent(),cc.director.getScene().addChild(this.chimp);var t=cc.v2(cc.winSize.width/4,400);this.chimp.runAction(cc.sequence(cc.bezierTo(1,[cc.v2(this.chimp.x,this.chimp.y+100),cc.v2(t.x/2,t.y+100),t]),cc.callFunc(function(){null!=e&&e()})))},t.prototype.flyUpUpAndAbove=function(e){void 0===e&&(e=null),this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(1,.1),cc.bezierTo(1,[cc.v2(this.node.x-400+800*Math.random(),cc.winSize.height/3),cc.v2(this.node.x-400+800*Math.random(),2*cc.winSize.height/3),cc.v2(this.node.x-400+800*Math.random(),5*cc.winSize.height/3)])),cc.callFunc(function(){null!=e&&e()})))},t.prototype.flyZigzag=function(e){var t=this;void 0===e&&(e=null),(new cc.Tween).target(this.node).to(1,{position:this.node.parent.convertToNodeSpaceAR(cc.v2(Math.random()*cc.winSize.width,Math.random()*cc.winSize.height/2))},{progress:null,easing:"cubicInOut"}).call(function(){t.stopZigzag?null!=e&&e():t.flyZigzag(e)}).start()},t.prototype.flyToCenter=function(e){void 0===e&&(e=null),(new cc.Tween).target(this.node).to(1,{position:this.node.parent.convertToNodeSpaceAR(cc.v2(cc.winSize.width/2,cc.winSize.height/4))},{progress:null,easing:"cubicInOut"}).call(function(){null!=e&&e()}).start()},t.prototype.animateGlow=function(){this.glow.active=!0,this.stars.active=!0;var e=this.node.getComponent(cc.Animation);null!=e&&e.play()},i([u(cc.Label)],t.prototype,"label",void 0),i([u],t.prototype,"game",void 0),i([u(cc.Node)],t.prototype,"seat",void 0),i([u(cc.Node)],t.prototype,"image",void 0),i([u(cc.Sprite)],t.prototype,"icon",void 0),i([u(cc.Node)],t.prototype,"chimp",void 0),i([u(cc.Node)],t.prototype,"doneIcon",void 0),i([u],t.prototype,"done",void 0),i([u(cc.Node)],t.prototype,"waitingIcon",void 0),i([u],t.prototype,"waiting",void 0),i([u(cc.Node)],t.prototype,"glow",void 0),i([u(cc.Node)],t.prototype,"stars",void 0),i([u(cc.AudioClip)],t.prototype,"appearAudio",void 0),i([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{"./lib/config":"config","./util":"util"}],chapterIcon:[function(e,t,n){"use strict";cc._RF.push(t,"e053cr7qxBB+I3xXJEh8Bun","chapterIcon");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=e("./lessonIcon"),c=cc._decorator,l=c.ccclass,u=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.open=!0,t}return o(t,e),t.prototype.onLoad=function(){var e=this,t=this.sprite.spriteFrame;this.sprite.spriteFrame=new cc.SpriteFrame,a.Util.load(this.chapter.course.id+"/course/res/icons/"+this.chapter.image,function(n,r){e.sprite&&(e.sprite.spriteFrame=n?t:new cc.SpriteFrame(r))}),this.open?this.bg.color=(new cc.Color).fromHEX(this.chapter.color?this.chapter.color:s.LESSON_BG_COLORS[Math.floor(Math.random()*s.LESSON_BG_COLORS.length)]):(this.sprite.setMaterial(0,this.grayMaterial),this.bg.color=new cc.Color(224,224,224))},i([u(cc.Sprite)],t.prototype,"sprite",void 0),i([u(cc.Node)],t.prototype,"bg",void 0),i([u(cc.Material)],t.prototype,"grayMaterial",void 0),i([l],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./lessonIcon":"lessonIcon","./util":"util"}],"chimple-label":[function(e,t,n){"use strict";cc._RF.push(t,"0ddb3t+49REZ5s0SVkIuotE","chimple-label");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=e("./lib/config"),c=e("./util"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._key=null,t}return o(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.useSystemFont=!1,this._key=this.string;var t=s.default.i;if(null!==t){var n=t.currentFontName;t.hasLoadedTextFont(n)&&(this.font=t.getTextFont(n)),t.direction==s.Direction.RTL&&this.horizontalAlign==cc.Label.HorizontalAlign.LEFT&&(this.horizontalAlign=cc.Label.HorizontalAlign.RIGHT),(null===t.game||void 0===t.game||t.course&&"literacy"!=t.course.type)&&(this.string=c.Util.i18NText(this._key))}},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),i([a],t)}(cc.Label);n.default=l,cc._RF.pop()},{"./lib/config":"config","./util":"util"}],"chimple-richtext":[function(e,t,n){"use strict";cc._RF.push(t,"0f8cbR4trZMipR5IzFHkC0C","chimple-richtext");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=e("./lib/config"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onLoad=function(){if(this.useSystemFont=!1,null!==s.default.getInstance()){var e=s.default.getInstance().currentFontName;s.default.getInstance().hasLoadedTextFont(e)&&(this.font=s.default.getInstance().getTextFont(e))}},i([a],t)}(cc.RichText);n.default=c,cc._RF.pop()},{"./lib/config":"config"}],chimple:[function(e,t,n){"use strict";cc._RF.push(t,"5c222p4y1JFPI6tk6YxS2K8","chimple");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.RECEIVED_TEACHER_REQUESTS=n.DO_HOT_UPDATE=n.PROJECT_MANIFEST=n.UpdateEvent=n.START_SCENE=n.HOME_SCENE=n.LANDING_SCENE=n.LESSON_ID_KEY_FOR_ASSIGN_HW=n.CHAPTER_ID_KEY_FOR_ASSIGN_HW=n.TEACHER_ID_KEY_FOR_ASSIGN_HW=n.STUDENT_ASSIGNMENT_ID_KEY=n.ASSIGNMENT_ID_KEY_FOR_ASSIGN_HW=n.ASSIGN_HOMEWORK=n.TEACHER_ADD_STUDENT_ID=n.TEACHER_SECTION_ID=n.TEACHER_NAME_KEY=n.TEACHER_ID_KEY=n.MICROLINK=n.RECEIVED_TEACHER_REQUEST=n.TEACHER_ADDED=n.ACCEPT_TEACHER_REQUEST_LINKED_USED=n.ACCEPT_TEACHER_REQUEST=n.REJECT_TEACHER_REQUEST=n.NONE=n.REGISTER=n.SCHOOL=n.HOME=n.BASE=n.DEPLOY_MODE=n.CHIMPLE_MODE=void 0;var c,l=e("./common/scripts/lib/config"),u=e("./common/scripts/lib/profile"),d=e("./common/scripts/lib/constants"),p=e("./common/scripts/util-logger"),h=e("./common/scripts/util"),f=e("./common/scripts/services/ServiceConfig"),g=e("@capacitor/core"),_=cc._decorator,m=_.ccclass,y=_.property;n.CHIMPLE_MODE="CHIMPLE_MODE",n.DEPLOY_MODE="DEPLOY_MODE",n.BASE="BASE",n.HOME="HOME",n.SCHOOL="SCHOOL",n.REGISTER="REGISTER",n.NONE="NONE",n.REJECT_TEACHER_REQUEST="reject_teacher_request",n.ACCEPT_TEACHER_REQUEST="accept_teacher_request",n.ACCEPT_TEACHER_REQUEST_LINKED_USED="accept_teacher_request_used",n.TEACHER_ADDED="teacher_added",n.RECEIVED_TEACHER_REQUEST="received_teacher_request",n.MICROLINK="microlink",n.TEACHER_ID_KEY="id",n.TEACHER_NAME_KEY="name",n.TEACHER_SECTION_ID="sectionid",n.TEACHER_ADD_STUDENT_ID="studentid",n.ASSIGN_HOMEWORK="assign_homework",n.ASSIGNMENT_ID_KEY_FOR_ASSIGN_HW="aid",n.STUDENT_ASSIGNMENT_ID_KEY="sid",n.TEACHER_ID_KEY_FOR_ASSIGN_HW="tid",n.CHAPTER_ID_KEY_FOR_ASSIGN_HW="cid",n.LESSON_ID_KEY_FOR_ASSIGN_HW="lid",n.LANDING_SCENE="private/school/scenes/landing",n.HOME_SCENE="menu/home/scenes/home",n.START_SCENE="menu/start/scenes/start",function(e){e[e.Checking=0]="Checking",e[e.Updating=1]="Updating",e[e.UpdateDone=2]="UpdateDone",e[e.Done=3]="Done",e[e.Error=4]="Error"}(c=n.UpdateEvent||(n.UpdateEvent={})),n.PROJECT_MANIFEST="project.manifest",n.DO_HOT_UPDATE=!0,n.RECEIVED_TEACHER_REQUESTS=!1,cc.deep_link=function(e){if(cc.log("deep link called with url:"+e),null!==e&&e.includes("://chimple.cc/")){var t=null,r=e.split("://chimple.cc/");if(null!==r&&2===r.length){var o=r[1].split("?");if(o&&2===o.length){if((t=o.splice(0,1)[0]).includes(n.RECEIVED_TEACHER_REQUEST)||t.includes(n.MICROLINK)){var i=o[0].split(/[&=]+/),a=Object.assign({});if(null!==i&&i.length%2==0){for(var s=i,c=[],u=0;u<i.length;u++)c.push(s.splice(u+1,1)[0]);s.map(function(e,t){return[e,c[t]]}).forEach(function(e){e&&2===e.length&&(a[e[0].toLowerCase()]=e[1])})}if(t.includes(n.MICROLINK)){l.default.isMicroLink=!0;var d=h.Util.removeDuplicateMessages(a,t);cc.sys.localStorage.setItem(t,JSON.stringify(d))}try{cc.log("RECEIVED_TEACHER_REQUEST",JSON.stringify(a)),d=h.Util.removeDuplicateMessages(a,t),t.includes(n.RECEIVED_TEACHER_REQUEST)&&(p.default.logChimpleEvent(n.RECEIVED_TEACHER_REQUEST,a),cc.sys.localStorage.setItem(t,JSON.stringify(d)),n.RECEIVED_TEACHER_REQUESTS=!0)}catch(f){}}cc.log("saved into local storage:"+cc.sys.localStorage.getItem(t))}}}};var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.status=null,t.fileProgress=null,t.manifest=null,t}var r;return o(t,e),r=t,t.prototype.onLoad=function(){var e,t;return a(this,void 0,void 0,function(){var r,o,i,a,c,d,_,m,y,v,b,E,S=this;return s(this,function(){for(cc.sys.isNative&&jsb.fileUtils.setSearchPaths([jsb.fileUtils.getWritablePath()+"HotUpdateSearchPaths","@assets/"]),"android"===g.Capacitor.getPlatform()&&cc.log("platform is android"),r=null!==(t=null===(e=location.href.split("?")[1])||void 0===e?void 0:e.split("&"))&&void 0!==t?t:[],o={},i=0,a=r;i<a.length;i++)c=a[i],o[c.split("=")[0]]=c.split("=")[1];return cc.log("urlParams",o),null!=o.courseid&&null!=o.chapterid&&null!=o.lessonid?(d={courseid:o.courseid,chapterid:o.chapterid,lessonid:o.lessonid},console.log("input",d),l.default.isMicroLink=!0,h.Util.loadDirectLessonWithLink(d,this.node),[2]):(cc.debug.setDisplayStats(!1),f.ServiceConfig.getInstance(f.APIMode.FIREBASE),cc.macro.ENABLE_MULTI_TOUCH=!1,p.default.initPluginFirebase(),h.Util.loadi18NMapping(function(){}),_=u.default.lang||l.Lang.ENGLISH,(m=l.LANG_CONFIGS.get(_))&&l.default.i.loadFontDynamically(m.font),p.default.init(),(y=JSON.parse(cc.sys.localStorage.getItem(n.TEACHER_ADDED)||"[]"))&&y.length>0&&y.forEach(function(e){return p.default.logChimpleEvent(n.TEACHER_ADDED,e)}),cc.sys.isNative&&n.DO_HOT_UPDATE?(v=[{storagePath:"HotUpdateSearchPaths",manifestUrl:this.manifest.nativeUrl}],b=h.Util.getSubpackages().map(function(e){return{storagePath:b+"/"+e,manifestUrl:e+"/project.manifest"}}),E=!1,cc.log("Hot Update"),this.oneByOne(v,0,function(e,t){E=E||t,e==v.length-1&&(E?(cc.audioEngine.stopAll(),cc.game.restart()):S.selectModes())}),[2]):(this.selectModes(),[2]))})})},t.prototype.selectModes=function(){switch(parseInt(u.default.getValue(u.CURRENTMODE))){case d.Mode.Home:l.default.i.pushScene("private/home/loginnew/scenes/welcomePage","private",null,!0);break;case d.Mode.School:null!=cc.sys.localStorage.getItem(d.REMEMBERED_USER)?l.default.i.pushScene("private/school/scenes/currentLoggedUser","private",null,!0):l.default.i.pushScene("private/school/scenes/sectionList","private",null,!0);break;default:l.default.i.pushScene("private/home/loginnew/scenes/welcomeScene","private",null,!0)}},t.navigateToHome=function(){l.default.i.pushScene("private/home/loginnew/scenes/homeLoginScene","private",null,!0)},t.prototype.navigateToBase=function(){var e=u.User.getUsers();(null==e||e.length<=0)&&u.User.createUser("test","",5,u.Gender.GIRL,"test","armydog"),u.User.setCurrentUser(u.User.getUsers()[0]),l.default.i.pushScene("menu/start/scenes/start","menu",null,!0)},t.prototype.oneByOne=function(e,t,n){var o=this;r.doHotUpdate(e[t].storagePath,e[t].manifestUrl,null,function(r,i,a){o.status.string=i,o.fileProgress.progress=a,r!=c.Done&&r!=c.UpdateDone&&r!=c.Error||(n(t,r==c.UpdateDone&&"HotUpdateSearchPaths"==e[t].storagePath),++t<e.length&&o.oneByOne(e,t,n))})},t.doHotUpdate=function(e,t,n,r){var o=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+e,i=new jsb.AssetsManager("",o,function(e,t){return Number(e)-Number(t)});if(i.setVerifyCallback(function(e,t){var n=t.compressed,o=t.md5,i=t.path;return t.size,n?(r(c.Checking,"Verification passed : "+i,0),!0):(r(c.Checking,"Verification passed : "+i+" ("+o+")",0),!0)}),r(c.Checking,"Hot update is ready, please check or directly update",0),cc.sys.os===cc.sys.OS_ANDROID&&(i.setMaxConcurrentTask(2),r(c.Checking,"Max concurrent tasks count have been limited to 2",0)),r(c.Checking,"Checking or updating ...",0),i.getState()===jsb.AssetsManager.State.UNINITED)if(t){var a=t;cc.loader.md5Pipe&&(a=cc.loader.md5Pipe.transformURL(a)),i.loadLocalManifest(a)}else{var s=new jsb.Manifest(n,o);i.loadLocalManifest(s,o)}i.getLocalManifest()&&i.getLocalManifest().isLoaded()||r(c.Error,"Failed to load local manifest ...",0),i.setEventCallback(function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:i.setEventCallback(null),r(c.Error,"No local manifest file found, hot update skipped",0);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:i.setEventCallback(null),r(c.Error,"Fail to download manifest file, hot update skipped",0);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:i.setEventCallback(null),r(c.Done,"Already up to date with the latest remote version",0);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:r(c.Checking,"New version found, please try to update",0),i.setEventCallback(null),i&&(i.setEventCallback(function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:i.setEventCallback(null),r(c.Error,"No local manifest file found, hot update skipped",0);break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var t=e.getMessage();r(c.Updating,t,e.getPercentByFile());break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:i.setEventCallback(null),r(c.Error,"No local manifest file found, hot update skipped",0);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:i.setEventCallback(null),r(c.Done,"Already up to date with the latest remote version",0);break;case jsb.EventAssetsManager.UPDATE_FINISHED:i.setEventCallback(null),r(c.UpdateDone,"Update finished. "+e.getMessage(),1);break;case jsb.EventAssetsManager.UPDATE_FAILED:i.setEventCallback(null),r(c.Error,"Update failed. "+e.getMessage(),0);break;case jsb.EventAssetsManager.ERROR_UPDATING:i.setEventCallback(null),r(c.Error,"Asset update error: "+e.getAssetId()+", "+e.getMessage(),0);break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:i.setEventCallback(null),r(c.Error,e.getMessage(),0)}}),i.update());break;default:return}}),i.checkUpdate()},i([y(cc.Label)],t.prototype,"status",void 0),i([y(cc.ProgressBar)],t.prototype,"fileProgress",void 0),i([y({type:cc.Asset})],t.prototype,"manifest",void 0),r=i([m],t)}(cc.Component);n.default=v,cc._RF.pop()},{"./common/scripts/lib/config":"config","./common/scripts/lib/constants":"constants","./common/scripts/lib/profile":"profile","./common/scripts/services/ServiceConfig":"ServiceConfig","./common/scripts/util":"util","./common/scripts/util-logger":"util-logger","@capacitor/core":1}],commonButton:[function(e,t,n){"use strict";cc._RF.push(t,"b30ec8FPl9AK6k5Jzt+78eL","commonButton");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text="hello",t.label=null,t}return o(t,e),t.prototype.onLoad=function(){this.label.string=a.Util.i18NText(this.text)},t.prototype.start=function(){this.node.width=this.label.node.width+48},i([l],t.prototype,"text",void 0),i([l(cc.Label)],t.prototype,"label",void 0),i([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./util":"util"}],config:[function(e,t,n){"use strict";cc._RF.push(t,"8d626S6TF5HCJ6vnsczwKzj","config");var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.WORLDS=n.World=n.LANG_CONFIGS=n.LangConfig=n.ALL_LANGS=n.Lang=n.Direction=n.ASSIGNMENT_COURSE_ID=n.QUIZ_MATHS=n.QUIZ_LITERACY=n.BRIDGE_NAME=n.BG_NAME=n.StartAction=n.Flow=n.COURSES_LANG_ID=n.COURSES=n.STORY=n.DEFAULT_FONT=void 0;var o,i,a,s,c=e("../util"),l=e("../util-logger"),u=e("./profile"),d=e("./gameConfigs"),p=e("./constants"),h=e("@capacitor/core");n.DEFAULT_FONT="main",n.STORY="story",n.COURSES=["en","en-maths","hi","hi-maths","ur","ur-maths","mr"],n.COURSES_LANG_ID=["en","hi","maths","kn","mr"],function(e){e[e.Default=0]="Default",e[e.Platformer=1]="Platformer",e[e.Debug=2]="Debug",e[e.Open=3]="Open"}(o=n.Flow||(n.Flow={})),function(e){e[e.Start=0]="Start",e[e.MoveLessonPlan=1]="MoveLessonPlan",e[e.LessonComplete=2]="LessonComplete",e[e.Default=3]="Default"}(i=n.StartAction||(n.StartAction={})),n.BG_NAME="bgRoot",n.BRIDGE_NAME="bridge",n.QUIZ_LITERACY="quizliteracy",n.QUIZ_MATHS="quizmaths",n.ASSIGNMENT_COURSE_ID="assignment",function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(a=n.Direction||(n.Direction={})),function(e){e.ENGLISH="en"}(s=n.Lang||(n.Lang={})),n.ALL_LANGS=[s.ENGLISH];n.LangConfig=function(){},n.LANG_CONFIGS=new Map([[s.ENGLISH,{font:"en-main",displayName:"English",symbol:"A",colorCode:"#FFBC00"}]]);var f=function(e,t,n){this.scene=e,this.mapPrefab=t,this.armature=n};n.World=f,n.WORLDS=[new f("platform/scenes/assemble","forestMapPrefab","tiger"),new f("platform/scenes/cityAssemble","cityMapPrefab","dog"),new f("platform/scenes/desertAssemble","desertMapPrefab","camel"),new f("platform/scenes/gardenAssemble","gardenMapPrefab","rabbit"),new f("platform/scenes/seaAssemble","seaMapPrefab","koala"),new f("platform/scenes/skyAssemble","skyMapPrefab","horse"),new f("platform/scenes/snowAssemble","snowMapPrefab","bear"),new f("platform/scenes/beachAssemble","beachMapPrefab","hippo"),new f("platform/scenes/playgroundAssemble","playgroundMapPrefab","cat"),new f("platform/scenes/farmAssemble","farmMapPrefab","duck")];var g=function(e,t){this.scene=e,this.bundle=t},_=function(){function e(){this._scenes=[],this._textFontMap=new Map,this.curriculum=new Map,this.allLessons=new Map,this.startAction=i.Default}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.gameLevelName="1",e.instance.worksheet=1,e.instance.problem=1,e.instance.totalProblems=1,e.instance.flow=o.Default,e.instance._textFontMap=new Map,e.instance.currentFontName=n.DEFAULT_FONT),e.instance},Object.defineProperty(e,"i",{get:function(){return e.getInstance()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"dir",{get:function(){return e.getInstance().course.id+"/"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"wide",{get:function(){return"kn"==e.getInstance().course.id},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.course=null,this.chapter=null,this.lesson=null},Object.defineProperty(e.prototype,"direction",{get:function(){return a.LTR},enumerable:!1,configurable:!0}),e.prototype.setRewardChapter=function(e){this.course=this.curriculum.get("reward"),this.chapter=this.course.chapters.find(function(t){return t.id==e})},e.prototype.unsetRewardChapter=function(){},e.prototype.hasTracing=function(){return this._lessonData.rows.some(function(e){return e[0].startsWith("write")})},e.prototype.addTextFont=function(e,t){this._textFontMap.set(e,t)},e.prototype.hasLoadedTextFont=function(e){var t=this._textFontMap.get(e);return this._textFontMap.has(e)&&t&&t.isValid},e.prototype.hadLoadedTraceFont=function(){var e=null;return Array.from(this._textFontMap,function(t){var n=t[0];t[1],-1!==n.indexOf("trace")&&(e=n)}),e},e.prototype.getTextFont=function(e){return this._textFontMap.get(e)},Object.defineProperty(e.prototype,"textFontMap",{get:function(){return this._textFontMap},enumerable:!1,configurable:!0}),e.prototype.getAssignmentLessonsTodo=function(){return this.assignments?this.assignments.filter(function(t){var n=e.i.allLessons.get(t.lessonId),r=u.User.getCurrentUser().lessonProgressMap.get(t.lessonId);return!(!n||r&&[].concat(r.assignmentIds).includes(t.assignmentId))}).map(function(t){var n=e.i.allLessons.get(t.lessonId),o=r({},n);return o.assignmentId=t.assignmentId,o.name=t.lessonName?t.lessonName:n.name,o}):[]},e.preloadScene=function(e,t){cc.director.preloadScene(e,function(){null!=t&&t()})},e.loadScene=function(t,r,o){void 0===r&&(r=null),void 0===o&&(o=null),c.Util.freeResources();var i="common/scenes/lessonController"==t?"maths"==e.i.course.id?e.i.hasTracing?s.ENGLISH:u.default.lang:e.i.course.lang:u.default.lang||s.ENGLISH,a=n.LANG_CONFIGS.get(i);e.i.currentFontName=a.font,e.i.hasLoadedTextFont(a.font)?e.continueLoadScene(t,r,o):e.i.loadFontDynamically(a.font,function(){cc.log("Loading font ....",a.font),e.continueLoadScene(t,r,o)})},e.continueLoadScene=function(t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),null!=n?(l.default.logChimpleEvent("load_scene",{scene:"common/scenes/lessonController"==t?t+" "+e.i.lesson.id:t,bundle:n}),l.default.logChimpleEvent("screen_view",{scene:"common/scenes/lessonController"==t?t+" "+e.i.lesson.id:t,bundle:n}),cc.assetManager.loadBundle(n,function(e,o){e?cc.log("Failed loading bundle: "+n+" "+e):o.loadScene(t,function(e,t){e?cc.log("Failed loading scene: "+n+" "+e):cc.director.runScene(t,null,function(){cc.sys.garbageCollect(),null!=r&&r()})})})):cc.director.loadScene(t,function(){l.default.logChimpleEvent("load_scene",{scene:"common/scenes/lessonController"==t?t+" "+e.i.lesson.id:t}),l.default.logChimpleEvent("screen_view",{scene:"common/scenes/lessonController"==t?t+" "+e.i.lesson.id:t}),cc.sys.garbageCollect(),null!=r&&r()})},e.prototype.pushScene=function(t,n,r,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=!1),o&&this.popAllScenes(),this._scenes.push(new g(t,n)),e.loadScene(t,n,r)},e.prototype.popScene=function(){var t=this._scenes.pop();l.default.logChimpleEvent("scene_exit",{scene:t.scene,bundle:t.bundle});var n=e.i;if(n&&n.game){var r=d.GAME_CONFIGS[n.game];r&&r.fontName&&n.currentFontName&&n.releaseFont(n.currentFontName),n.game=null}var o=this._scenes[this._scenes.length-1],i=o.scene;i.startsWith("menu/map/scene/map")&&(i=i.substr(0,i.length-1)+u.default.lastWorld),e.loadScene(i,o.bundle)},e.prototype.prePopScene=function(t){var n=this._scenes[this._scenes.length-2].scene;n.startsWith("menu/map/scene/map")&&(n=n.substr(0,n.length-1)+u.default.lastWorld),e.preloadScene(n,t)},e.prototype.popAllScenes=function(){this._scenes=[]},Object.defineProperty(e.prototype,"canPop",{get:function(){return this._scenes.length>1},enumerable:!1,configurable:!0}),e.prototype.releaseFont=function(t){this._textFontMap.has(t)&&(cc.log("releasing current font",t),cc.resources.release(t),this._textFontMap.delete(t),e.i.currentFontName=null)},e.prototype.loadFontDynamically=function(e,t,n){var r=this;void 0===t&&(t=null),void 0===n&&(n=null),this.hasLoadedTextFont(e)?(this.currentFontName=e,t&&t(n)):cc.resources.load("fonts/"+e,cc.Font,function(o,i){o?t&&t(n):(console.log("loading font from Config",e),r._textFontMap.set(e,i),null!==r.hadLoadedTraceFont()?r.currentFontName=r.hadLoadedTraceFont():r.currentFontName=e,t&&t(n))})},e.prototype.loadLessonJson=function(e,t,n,r){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=0),0!=this.problem)e(this._lessonData.rows[this.problem-1]);else if(null!=n){var i=[],a=n.length;n.forEach(function(e){var t=o.course.id+"/"+(e.orig_lesson_id||e.id)+"/res/"+(e.orig_lesson_id||e.id)+".json";c.Util.load(t,function(t,n){var o=(n instanceof cc.JsonAsset?n.json:n).rows.filter(function(e){return e[0].toLowerCase().includes("quiz")}).map(function(t){return t[2]=e.id,t});i=i.concat(r>0?c.Util.shuffle(o).slice(0,r):o),a--})});var s=function(){a<=0&&(cc.director.getScheduler().unschedule(s,t),0==r?(c.Util.shuffle(i),o._lessonData={rows:i.slice(0,Math.min(10,i.length-1))}):o._lessonData={rows:i},o.totalProblems=o._lessonData.rows.length,o.problem=1,null!=e&&e(o._lessonData.rows[o.problem-1]))};cc.director.getScheduler().schedule(s,t,1)}else{var l=this.course.id+"/"+(this.lesson.orig_lesson_id||this.lesson.id)+"/res/"+(this.lesson.orig_lesson_id||this.lesson.id)+".json";c.Util.load(l,function(t,n){if(o._lessonData=n instanceof cc.JsonAsset?n.json:n,o.lesson.id.endsWith("_PreQuiz")){for(var r=Math.floor(o._lessonData.rows.length/4),i=[],a=0;a<4;a++){var s=c.Util.randomBetween(0,r-2),l=c.Util.randomBetween(s+1,r-1),u=c.Util.randomBetween(l+1,r);i.push(o._lessonData.rows[a*r+s]),i.push(o._lessonData.rows[a*r+l]),i.push(o._lessonData.rows[a*r+u]),cc.log(s,l,u)}o._lessonData.rows=i}o._lessonData.rows.forEach(function(e){e[2]=o.lesson.id}),o.totalProblems=o._lessonData.rows.length,o.problem=1,null!=e&&e(o._lessonData.rows[o.problem-1])},!0)}},e.prototype.nextProblem=function(){this.problem<this.totalProblems&&(this.problem++,this.data=[this._lessonData.rows[this.problem-1]])},e.prototype.prevProblem=function(){this.problem>1&&(this.problem--,this.data=[this._lessonData.rows[this.problem-1]])},e.prototype.loadPathJSON=function(e,t,n){void 0===n&&(n=!1);var r=[],o=null,i=null;e=e.trim(),n=!isNaN(Number(e));var a=null;if(-1!==e.indexOf("tutorial"))e=e.replace(".png",""),a="course-"+this.course.id+"/"+(this.lesson.orig_lesson_id||this.lesson.id)+"/res/"+e+"-json";else{var s=e===e.toUpperCase();i=n?"numbers":s?"upper":"lower",a=this.course.id+"/course/res/paths/"+i+"/"+e}a+=".json",c.Util.load(a,function(n,i){if(r=[],null!==i){var a=i instanceof cc.JsonAsset?i.json:i;Array.isArray(a)&&a.forEach(function(e){r.push(e)})}o=r&&r.length>0?JSON.stringify(r):null!=cc.sys.localStorage.getItem(e)&&cc.sys.localStorage.getItem(e).length>0?cc.sys.localStorage.getItem(e):null,t(o)},!0)},e.prototype.loadCourseJsons=function(e,t,n){var r=this,o=0;e.courseProgressMap.forEach(function(e,t){o++,r.loadSingleCourseJson(t,function(){o--})}),o++,this.loadSingleCourseJson("reward",function(){return o--});var i=function(){o<=0&&(e.curriculumLoaded=!0,cc.director.getScheduler().unschedule(i,t),n())};cc.director.getScheduler().schedule(i,t,1)},e.prototype.loadSingleCourseJson=function(e,t){var n=this;cc.assetManager.loadBundle(e,function(r,o){if(r)return cc.log("error in loadSingleJson",r),console.error(r);c.Util.bundles.set(e,o);var i=e+"/course/res/course.json";c.Util.load(i,function(r,o){if(!r){var i=o instanceof cc.JsonAsset?o.json:o;i.chapters.forEach(function(e){e.course=i,e.lessons.forEach(function(t){t.chapter=e,u.User.getCurrentUser()&&u.User.getCurrentUser().debug?t.open=!0:t.open=!1,n.allLessons.set(t.id,t)})}),n.curriculum.set(e,i)}t()})})},e.loadBundle=function(e,t,n){var r,o=u.default.getItem(p.IS_CUBA),i="android"===h.Capacitor.getPlatform(),a=null!==(r=cc.sys.localStorage.getItem("gameUrl"))&&void 0!==r?r:"http://localhost/_capacitor_file_/data/user/0/org.chimple.cuba/files/",s=o&&i&&a?a+e:e;console.log("gameUrl",a,"isCuba",o,cc.sys.localStorage.getItem("gameUrl"),"firstPath",s),cc.assetManager.loadBundle(s,function(r,o){r?cc.assetManager.loadBundle(p.BUNDLE_URL+e,function(r,o){r?(cc.assetManager.loadBundle(e,function(e,r){e?n(e):t(r)}),n(r)):t(o)}):t(o)})},Object.defineProperty(e.prototype,"friend",{get:function(){return"chimp"},enumerable:!1,configurable:!0}),e}();n.default=_,cc._RF.pop()},{"../util":"util","../util-logger":"util-logger","./constants":"constants","./gameConfigs":"gameConfigs","./profile":"profile","@capacitor/core":1}],constants:[function(e,t,n){"use strict";var r,o;cc._RF.push(t,"fd8a7oihmBN6IXQofI2E6oP","constants"),Object.defineProperty(n,"__esModule",{value:!0}),n.FIREBASE_SECTION_ID=n.FIREBASE_SCHOOL_ID=n.CURRENT_SUBJECT_ID=n.CURRENT_SECTION_ID=n.CURRENT_CLASS_ID=n.CURRENT_STUDENT_ID=n.CURRENT_SCHOOL_ID=n.PARSE_ENABLED=n.QUEUE_OFFLOAD_FREQUENCY=n.LEVEL_END=n.LEVEL_NAME=n.LEVEL_START=n.ACHIEVEMENT_ID=n.UNLOCK_ACHIEVEMENT=n.CONTENT_TYPE=n.ITEM_ID=n.SELECT_CONTENT=n.FAIL_TO_COLLECT_ALL_REWARDS=n.APP_END=n.APP_START=n.WORLD_COMPLETED=n.LEVEL_COMPLETED=n.GAME_EXIT=n.GAME_END=n.PROBLEM_END=n.GAME_START=n.PROBLEM_START=n.LOG_TYPE=n.LOG_RIGHT_MOVES=n.LOG_WRONG_MOVES=n.LOG_PROBLEM=n.LOG_GAME_LEVEL=n.SKILLS=n.COURSE=n.LOG_LEVEL=n.LOG_WORLD=n.LOG_GAME=n.ASSET_URL=n.BUNDLE_URL=n.COURSES_URL=n.COURSE_SERVER=n.SIMULATOR_ROOT_DIR=n.ANDROID_ROOT_DIR=n.ASSET_LOAD_METHOD=n.ENV=n.LANG=n.MODE=n.D_MODE=n.Mode=n.DeployMode=void 0,n.courseSortIndex=n.firebaseConfigWeb=n.COUNTRY_CODES=n.MICROLINK_END_BLANK=n.IS_CUBA=n.MIN_PASS=n.EXAM=n.IS_REMEMBER_TOGGLE_ON=n.REMEMBERED_USER=n.LOGGED_IN_USER=n.FIREBASE_STUDENT_ID=void 0,function(e){e[e.Open=0]="Open",e[e.Close=1]="Close"}(r=n.DeployMode||(n.DeployMode={})),function(e){e[e.Base=0]="Base",e[e.Home=1]="Home",e[e.Teacher=2]="Teacher",e[e.School=3]="School",e[e.None=4]="None",e[e.HomeConnect=5]="HomeConnect"}(o=n.Mode||(n.Mode={})),n.D_MODE=r.Close,n.MODE=o.None,n.LANG="en",n.ENV="web",n.ASSET_LOAD_METHOD="file",n.ANDROID_ROOT_DIR="/sdcard/bahama/",n.SIMULATOR_ROOT_DIR="/Users/shyamalupadhyaya/Dev/chimple-git/sdcard/bahama/",n.COURSE_SERVER={local:{hi:"http://localhost:8901/courses/",en:"http://localhost:8901/courses/","en-maths":"http://localhost:8901/courses/","hi-maths":"http://localhost:8901/courses/"},dev:{hi:"https://bahama-hi-stage.web.app/bundles/courses/",en:"https://bahama-hi-stage.web.app/bundles/courses/","en-maths":"https://bahama-hi-stage.web.app/bundles/courses/","hi-maths":"https://bahama-hi-stage.web.app/bundles/courses/"},stage:{hi:"https://bahama-hi-stage.web.app/new/courses/",en:"https://bahama-hi-stage.web.app/new/courses/","en-maths":"https://bahama-hi-stage.web.app/new/courses/","hi-maths":"https://bahama-hi-stage.web.app/new/courses/"},prod:{hi:"https://bahama-hi-prod.web.app/courses/",en:"https://bahama-hi-prod.web.app/courses/","en-maths":"https://bahama-hi-prod.web.app/courses/","hi-maths":"https://bahama-hi-prod.web.app/courses/"}},n.COURSES_URL="web"==n.ENV?"":n.COURSE_SERVER[n.ENV][n.LANG],n.BUNDLE_URL="https://bahama-ta-stage.web.app/remote/",n.ASSET_URL="https://media.githubusercontent.com/media/chimple/help-audio/main",n.LOG_GAME="game",n.LOG_WORLD="world",n.LOG_LEVEL="level",n.COURSE="course",n.SKILLS="skills",n.LOG_GAME_LEVEL="gameLevel",n.LOG_PROBLEM="problem",n.LOG_WRONG_MOVES="wrongMoves",n.LOG_RIGHT_MOVES="rightMoves",n.LOG_TYPE="type",n.PROBLEM_START="problemStart",n.GAME_START="gameStart",n.PROBLEM_END="problemEnd",n.GAME_END="gameEnd",n.GAME_EXIT="gameExit",n.LEVEL_COMPLETED="level_completed",n.WORLD_COMPLETED="world_completed",n.APP_START="app_start",n.APP_END="app_end",n.FAIL_TO_COLLECT_ALL_REWARDS="failToCollectAllRewards",n.SELECT_CONTENT="select_content",n.ITEM_ID="item_id",n.CONTENT_TYPE="content_type",n.UNLOCK_ACHIEVEMENT="unlock_achievement",n.ACHIEVEMENT_ID="achievement_id",n.LEVEL_START="level_start",n.LEVEL_NAME="level_name",n.LEVEL_END="level_end",n.QUEUE_OFFLOAD_FREQUENCY=3e4,n.PARSE_ENABLED=!0,n.CURRENT_SCHOOL_ID="CURRENT_SCHOOL_ID",n.CURRENT_STUDENT_ID="CURRENT_STUDENT_ID",n.CURRENT_CLASS_ID="CURRENT_CLASS_ID",n.CURRENT_SECTION_ID="CURRENT_SECTION_ID",n.CURRENT_SUBJECT_ID="CURRENT_SUBJECT_ID",n.FIREBASE_SCHOOL_ID="schoolId",n.FIREBASE_SECTION_ID="sectionId",n.FIREBASE_STUDENT_ID="studentId",n.LOGGED_IN_USER="loggedInUser",n.REMEMBERED_USER="currentlyRememberedUser",n.IS_REMEMBER_TOGGLE_ON="isRememberToggleOn",n.EXAM="exam",n.MIN_PASS=70,n.IS_CUBA="is_cuba",n.MICROLINK_END_BLANK="blank",n.COUNTRY_CODES=[{name:"Afghanistan",dial_code:"+93",code:"AF"},{name:"Aland Islands",dial_code:"+358",code:"AX"},{name:"Albania",dial_code:"+355",code:"AL"},{name:"Algeria",dial_code:"+213",code:"DZ"},{name:"American Samoa",dial_code:"+684",code:"AS"},{name:"Andorra",dial_code:"+376",code:"AD"},{name:"Angola",dial_code:"+244",code:"AO"},{name:"Anguilla",dial_code:"+1264",code:"AI"},{name:"Antarctica",dial_code:"+672",code:"AQ"},{name:"Antigua & Barbuda",dial_code:"+1268",code:"AG"},{name:"Argentina",dial_code:"+54",code:"AR"},{name:"Armenia",dial_code:"+374",code:"AM"},{name:"Aruba",dial_code:"+297",code:"AW"},{name:"Australia",dial_code:"+61",code:"AU"},{name:"Austria",dial_code:"+43",code:"AT"},{name:"Azerbaijan",dial_code:"+994",code:"AZ"},{name:"Bahamas",dial_code:"+1242",code:"BS"},{name:"Bahrain",dial_code:"+973",code:"BH"},{name:"Bangladesh",dial_code:"+880",code:"BD"},{name:"Barbados",dial_code:"+1246",code:"BB"},{name:"Belarus",dial_code:"+375",code:"BY"},{name:"Belgium",dial_code:"+32",code:"BE"},{name:"Belize",dial_code:"+501",code:"BZ"},{name:"Benin",dial_code:"+229",code:"BJ"},{name:"Bermuda",dial_code:"+1441",code:"BM"},{name:"Bhutan",dial_code:"+975",code:"BT"},{name:"Bolivia",dial_code:"+591",code:"BO"},{name:"Bosnia & Herzegovina",dial_code:"+387",code:"BA"},{name:"Botswana",dial_code:"+267",code:"BW"},{name:"Brazil",dial_code:"+55",code:"BR"},{name:"British Indian Ocean Territory",dial_code:"+246",code:"IO"},{name:"Brunei Darussalam",dial_code:"+673",code:"BN"},{name:"Bulgaria",dial_code:"+359",code:"BG"},{name:"Burkina Faso",dial_code:"+226",code:"BF"},{name:"Burundi",dial_code:"+257",code:"BI"},{name:"Cambodia",dial_code:"+855",code:"KH"},{name:"Cameroon",dial_code:"+237",code:"CM"},{name:"Canada",dial_code:"+1",code:"CA"},{name:"Cape Verde",dial_code:"+238",code:"CV"},{name:"Cayman Islands",dial_code:"+ 345",code:"KY"},{name:"Central African Republic",dial_code:"+236",code:"CF"},{name:"Chad",dial_code:"+235",code:"TD"},{name:"Chile",dial_code:"+56",code:"CL"},{name:"China",dial_code:"+86",code:"CN"},{name:"Christmas Island",dial_code:"+61",code:"CX"},{name:"Cocos (Keeling) Islands",dial_code:"+61",code:"CC"},{name:"Colombia",dial_code:"+57",code:"CO"},{name:"Comoros",dial_code:"+269",code:"KM"},{name:"Congo",dial_code:"+243",code:"CG"},{name:"Cook Islands",dial_code:"+682",code:"CK"},{name:"Costa Rica",dial_code:"+506",code:"CR"},{name:"Cote d'Ivoire",dial_code:"+225",code:"CI"},{name:"Croatia",dial_code:"+385",code:"HR"},{name:"Cuba",dial_code:"+53",code:"CU"},{name:"Cyprus",dial_code:"+537",code:"CY"},{name:"Czechia",dial_code:"+420",code:"CZ"},{name:"Denmark",dial_code:"+45",code:"DK"},{name:"Djibouti",dial_code:"+253",code:"DJ"},{name:"Dominica",dial_code:"+1767",code:"DM"},{name:"Dominican Republic",dial_code:"+1849",code:"DO"},{name:"Ecuador",dial_code:"+593",code:"EC"},{name:"Egypt",dial_code:"+20",code:"EG"},{name:"El Salvador",dial_code:"+503",code:"SV"},{name:"Equatorial Guinea",dial_code:"+240",code:"GQ"},{name:"Eritrea",dial_code:"+291",code:"ER"},{name:"Estonia",dial_code:"+372",code:"EE"},{name:"Ethiopia",dial_code:"+251",code:"ET"},{name:"Falkland Islands (Malvinas)",dial_code:"+500",code:"FK"},{name:"Faroe Islands",dial_code:"+298",code:"FO"},{name:"Fiji",dial_code:"+679",code:"FJ"},{name:"Finland",dial_code:"+358",code:"FI"},{name:"France",dial_code:"+33",code:"FR"},{name:"French Guiana",dial_code:"+594",code:"GF"},{name:"French Polynesia",dial_code:"+689",code:"PF"},{name:"Gabon",dial_code:"+241",code:"GA"},{name:"Gambia",dial_code:"+220",code:"GM"},{name:"Georgia",dial_code:"+995",code:"GE"},{name:"Germany",dial_code:"+49",code:"DE"},{name:"Ghana",dial_code:"+233",code:"GH"},{name:"Gibraltar",dial_code:"+350",code:"GI"},{name:"Greece",dial_code:"+30",code:"GR"},{name:"Greenland",dial_code:"+299",code:"GL"},{name:"Grenada",dial_code:"+1473",code:"GD"},{name:"Guadeloupe",dial_code:"+590",code:"GP"},{name:"Guam",dial_code:"+1671",code:"GU"},{name:"Guatemala",dial_code:"+502",code:"GT"},{name:"Guernsey",dial_code:"+44",code:"GG"},{name:"Guinea",dial_code:"+224",code:"GN"},{name:"Guinea-Bissau",dial_code:"+245",code:"GW"},{name:"Guyana",dial_code:"+595",code:"GY"},{name:"Haiti",dial_code:"+509",code:"HT"},{name:"Honduras",dial_code:"+504",code:"HN"},{name:"Hong Kong",dial_code:"+852",code:"HK"},{name:"Hungary",dial_code:"+36",code:"HU"},{name:"Iceland",dial_code:"+354",code:"IS"},{name:"India",dial_code:"+91",code:"IN"},{name:"Indonesia",dial_code:"+62",code:"ID"},{name:"Iran, Islamic Republic of",dial_code:"+98",code:"IR"},{name:"Iraq",dial_code:"+964",code:"IQ"},{name:"Ireland",dial_code:"+353",code:"IE"},{name:"Isle of Man",dial_code:"+44",code:"IM"},{name:"Israel",dial_code:"+972",code:"IL"},{name:"Italy",dial_code:"+39",code:"IT"},{name:"Jamaica",dial_code:"+1876",code:"JM"},{name:"Japan",dial_code:"+81",code:"JP"},{name:"Jersey",dial_code:"+44",code:"JE"},{name:"Jordan",dial_code:"+962",code:"JO"},{name:"Kazakhstan",dial_code:"+7",code:"KZ"},{name:"Kenya",dial_code:"+254",code:"KE"},{name:"Kiribati",dial_code:"+686",code:"KI"},{name:"Kuwait",dial_code:"+965",code:"KW"},{name:"Kyrgyzstan",dial_code:"+996",code:"KG"},{name:"Laos",dial_code:"+856",code:"LA"},{name:"Latvia",dial_code:"+371",code:"LV"},{name:"Lebanon",dial_code:"+961",code:"LB"},{name:"Lesotho",dial_code:"+266",code:"LS"},{name:"Liberia",dial_code:"+231",code:"LR"},{name:"Libyan Arab Jamahiriya",dial_code:"+218",code:"LY"},{name:"Liechtenstein",dial_code:"+423",code:"LI"},{name:"Lithuania",dial_code:"+370",code:"LT"},{name:"Luxembourg",dial_code:"+352",code:"LU"},{name:"Macao",dial_code:"+853",code:"MO"},{name:"Macedonia",dial_code:"+389",code:"MK"},{name:"Madagascar",dial_code:"+261",code:"MG"},{name:"Malawi",dial_code:"+265",code:"MW"},{name:"Malaysia",dial_code:"+60",code:"MY"},{name:"Maldives",dial_code:"+960",code:"MV"},{name:"Mali",dial_code:"+223",code:"ML"},{name:"Malta",dial_code:"+356",code:"MT"},{name:"Marshall Islands",dial_code:"+692",code:"MH"},{name:"Martinique",dial_code:"+596",code:"MQ"},{name:"Mauritania",dial_code:"+222",code:"MR"},{name:"Mauritius",dial_code:"+230",code:"MU"},{name:"Mayotte",dial_code:"+262",code:"YT"},{name:"Mexico",dial_code:"+52",code:"MX"},{name:"Micronesia, Federated States of",dial_code:"+691",code:"FM"},{name:"Moldova, Republic of",dial_code:"+373",code:"MD"},{name:"Monaco",dial_code:"+377",code:"MC"},{name:"Mongolia",dial_code:"+976",code:"MN"},{name:"Montenegro",dial_code:"+382",code:"ME"},{name:"Montserrat",dial_code:"+1664",code:"MS"},{name:"Morocco",dial_code:"+212",code:"MA"},{name:"Mozambique",dial_code:"+258",code:"MZ"},{name:"Myanmar",dial_code:"+95",code:"MM"},{name:"Namibia",dial_code:"+264",code:"NA"},{name:"Nauru",dial_code:"+674",code:"NR"},{name:"Nepal",dial_code:"+977",code:"NP"},{name:"Netherlands",dial_code:"+31",code:"NL"},{name:"Netherlands Antilles",dial_code:"+599",code:"AN"},{name:"New Caledonia",dial_code:"+687",code:"NC"},{name:"New Zealand",dial_code:"+64",code:"NZ"},{name:"Nicaragua",dial_code:"+505",code:"NI"},{name:"Niger",dial_code:"+227",code:"NE"},{name:"Nigeria",dial_code:"+234",code:"NG"},{name:"Niue",dial_code:"+683",code:"NU"},{name:"Norfolk Island",dial_code:"+672",code:"NF"},{name:"North Korea",dial_code:"+850",code:"KP"},{name:"Northern Mariana Islands",dial_code:"+1670",code:"MP"},{name:"Norway",dial_code:"+47",code:"NO"},{name:"Oman",dial_code:"+968",code:"OM"},{name:"Pakistan",dial_code:"+92",code:"PK"},{name:"Palau",dial_code:"+680",code:"PW"},{name:"Palestinian Territory, Occupied",dial_code:"+970",code:"PS"},{name:"Panama",dial_code:"+507",code:"PA"},{name:"Papua New Guinea",dial_code:"+675",code:"PG"},{name:"Paraguay",dial_code:"+595",code:"PY"},{name:"Peru",dial_code:"+51",code:"PE"},{name:"Philippines",dial_code:"+63",code:"PH"},{name:"Pitcairn",dial_code:"+872",code:"PN"},{name:"Poland",dial_code:"+48",code:"PL"},{name:"Portugal",dial_code:"+351",code:"PT"},{name:"Puerto Rico",dial_code:"+1939",code:"PR"},{name:"Qatar",dial_code:"+974",code:"QA"},{name:"Romania",dial_code:"+40",code:"RO"},{name:"Russia",dial_code:"+7",code:"RU"},{name:"Rwanda",dial_code:"+250",code:"RW"},{name:"R\xe9union",dial_code:"+262",code:"RE"},{name:"Saint Barth\xe9lemy",dial_code:"+590",code:"BL"},{name:"Saint Helena",dial_code:"+290",code:"SH"},{name:"Saint Kitts & Nevis",dial_code:"+1869",code:"KN"},{name:"Saint Lucia",dial_code:"+1758",code:"LC"},{name:"Saint Martin",dial_code:"+590",code:"MF"},{name:"Saint Pierre & Miquelon",dial_code:"+508",code:"PM"},{name:"Saint Vincent & the Grenadines",dial_code:"+784",code:"VC"},{name:"Samoa",dial_code:"+685",code:"WS"},{name:"San Marino",dial_code:"+378",code:"SM"},{name:"Sao Tome & Principe",dial_code:"+239",code:"ST"},{name:"Saudi Arabia",dial_code:"+966",code:"SA"},{name:"Senegal",dial_code:"+221",code:"SN"},{name:"Serbia",dial_code:"+381",code:"RS"},{name:"Seychelles",dial_code:"+248",code:"SC"},{name:"Sierra Leone",dial_code:"+232",code:"SL"},{name:"Singapore",dial_code:"+65",code:"SG"},{name:"Slovakia",dial_code:"+421",code:"SK"},{name:"Slovenia",dial_code:"+386",code:"SI"},{name:"Solomon Islands",dial_code:"+677",code:"SB"},{name:"Somalia",dial_code:"+252",code:"SO"},{name:"South Africa",dial_code:"+27",code:"ZA"},{name:"South Georgia Islands",dial_code:"+500",code:"GS"},{name:"South Korea",dial_code:"+82",code:"KR"},{name:"Spain",dial_code:"+34",code:"ES"},{name:"Sri Lanka",dial_code:"+94",code:"LK"},{name:"Sudan",dial_code:"+249",code:"SD"},{name:"Suriname",dial_code:"+597",code:"SR"},{name:"Svalbard & Jan Mayen",dial_code:"+47",code:"SJ"},{name:"Swaziland",dial_code:"+268",code:"SZ"},{name:"Sweden",dial_code:"+46",code:"SE"},{name:"Switzerland",dial_code:"+41",code:"CH"},{name:"Syrian Arab Republic",dial_code:"+963",code:"SY"},{name:"Taiwan",dial_code:"+886",code:"TW"},{name:"Tajikistan",dial_code:"+992",code:"TJ"},{name:"Tanzania",dial_code:"+255",code:"TZ"},{name:"Thailand",dial_code:"+66",code:"TH"},{name:"Timor-Leste",dial_code:"+670",code:"TL"},{name:"Togo",dial_code:"+228",code:"TG"},{name:"Tokelau",dial_code:"+690",code:"TK"},{name:"Tonga",dial_code:"+676",code:"TO"},{name:"Trinidad & Tobago",dial_code:"+1868",code:"TT"},{name:"Trinidad & Tobago",dial_code:"+868",code:"TT"},{name:"Tunisia",dial_code:"+216",code:"TN"},{name:"Turkey",dial_code:"+90",code:"TR"},{name:"Turkmenistan",dial_code:"+993",code:"TM"},{name:"Turks & Caicos Islands",dial_code:"+1649",code:"TC"},{name:"Tuvalu",dial_code:"+688",code:"TV"},{name:"Uganda",dial_code:"+256",code:"UG"},{name:"Ukraine",dial_code:"+380",code:"UA"},{name:"United Arab Emirates",dial_code:"+971",code:"AE"},{name:"United Kingdom",dial_code:"+44",code:"GB"},{name:"United States",dial_code:"+1",code:"US"},{name:"Uruguay",dial_code:"+598",code:"UY"},{name:"Uzbekistan",dial_code:"+998",code:"UZ"},{name:"Vanuatu",dial_code:"+678",code:"VU"},{name:"Vatican City",dial_code:"+379",code:"VA"},{name:"Venezuela",dial_code:"+58",code:"VE"},{name:"Vietnam",dial_code:"+84",code:"VN"},{name:"Virgin Islands, British",dial_code:"+1284",code:"VG"},{name:"Virgin Islands, U.S.",dial_code:"+1340",code:"VI"},{name:"Wallis & Futuna",dial_code:"+681",code:"WF"},{name:"Yemen",dial_code:"+967",code:"YE"},{name:"Zambia",dial_code:"+260",code:"ZM"},{name:"Zimbabwe",dial_code:"+263",code:"ZW"}],n.firebaseConfigWeb={apiKey:"AIzaSyAi92k8nf7IDaviagF86wq164kqpZ_-3PA",authDomain:"bahama-stage.firebaseapp.com",databaseURL:"https://bahama-stage.firebaseio.com",projectId:"bahama-stage",storageBucket:"bahama-stage.appspot.com",messagingSenderId:"105857221433",appId:"1:105857221433:web:424f71c230302a6b70dee8",measurementId:"G-DB6WEMCZ0D"},n.courseSortIndex={assignment:0,en:1,maths:2,hi:3,kn:4,mr:5,puzzle:6,"test-lit":7,"test-maths":8},cc._RF.pop()},{}],convert:[function(e,t,n){"use strict";cc._RF.push(t,"9cd80ua1RVJ7q7zB04OVwxd","convert"),Object.defineProperty(n,"__esModule",{value:!0}),n.Convert=void 0;var r=function(){function e(){}return e.toCourse=function(e){return JSON.parse(e)},e.courseToJson=function(e){return JSON.stringify(e)},e}();n.Convert=r,cc._RF.pop()},{}],"counting-answer":[function(e,t,n){"use strict";cc._RF.push(t,"1ac78XfkPFH+rXRaCKhHdaG","counting-answer");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.VALIDATE_RESULT=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("./answer-grid"),l=e("./lib/error-handler"),u=e("./util"),d=e("./chimple-richtext");n.VALIDATE_RESULT="VALIDATE_RESULT";var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.answerGridPrefab=null,t.touchAudio=null,t.numberpads=[],t.result=null,t.delay=2,t._answerGrid=null,t._isValidResult=!1,t}return o(t,e),t.prototype.onLoad=function(){this._answerGrid=cc.instantiate(this.answerGridPrefab),this._answerGrid.setPosition(new cc.Vec2(0,-125)),this.node.addChild(this._answerGrid);var e=this._answerGrid.getComponent(c.default);e.numberpads=this.numberpads,e.result=this.result,e.delay=this.delay,this.updateRichText(),this.updateDigits("?".repeat(this.result.length),!0),this.registerEvents()},t.prototype.registerEvents=function(){var e=this;this.node.on(c.ANSWER_GRID_BUTTON_CLICKED,function(t){t.stopPropagation();try{e.touchAudio&&u.Util.playSfx(e.touchAudio)}catch(r){}if(!e.isValidResult){var n=t.getUserData().selectedDigit;e.updateDigits(n,!1)}})},t.prototype.updateDigits=function(e,t){var n=this;void 0===t&&(t=!1);var r=this.node.getChildByName("digits").getChildByName("label").getComponent(d.default),o=r.string||"";o=o.concat(e),t?r.string=o:(o=o.substring(1,o.length),r.string=o,-1===o.indexOf("?")&&o.length===this.result.length&&this.scheduleOnce(function(){n.checkResult()},.25))},t.prototype.clearDigits=function(e){void 0===e&&(e=!1),this.node.getChildByName("digits").getChildByName("label").getComponent(d.default).string="?".repeat(this.result.length)},t.prototype.checkResult=function(){var e=this.node.getChildByName("digits").getChildByName("label").getComponent(d.default);if(e.string){var t=new cc.Event.EventCustom(n.VALIDATE_RESULT,!0);t.setUserData({result:e.string}),this.node.dispatchEvent(t)}},t.prototype.updateRichText=function(){this.node.getChildByName("countingLabel").getChildByName("chimple-richtext").getComponent(d.default).string="<color=#8B4513><bold>"+u.Util.i18NText("How Many??")+"</bold></color>"},Object.defineProperty(t.prototype,"isValidResult",{get:function(){return this._isValidResult},set:function(e){this._isValidResult=e},enumerable:!1,configurable:!0}),i([s(cc.Prefab)],t.prototype,"answerGridPrefab",void 0),i([s(cc.AudioClip)],t.prototype,"touchAudio",void 0),i([l.default()],t.prototype,"onLoad",null),i([l.default()],t.prototype,"registerEvents",null),i([l.default()],t.prototype,"updateDigits",null),i([l.default()],t.prototype,"clearDigits",null),i([l.default()],t.prototype,"checkResult",null),i([l.default()],t.prototype,"updateRichText",null),i([a],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./answer-grid":"answer-grid","./chimple-richtext":"chimple-richtext","./lib/error-handler":"error-handler","./util":"util"}],countingLayout:[function(e,t,n){"use strict";cc._RF.push(t,"8d7ffg2/nlOO5z9Ai5B9mse","countingLayout");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fullCount=1,t.emptyCount=0,t.fullTexture=null,t.emptyTexture=null,t.scale=1,t}return o(t,e),t.prototype.onLoad=function(){for(var e=0;e<this.fullCount;e++){var t=new cc.Node;t.scale=this.scale;var n=t.addComponent(cc.Sprite);e<this.fullCount-this.emptyCount?n.spriteFrame=this.fullTexture:n.spriteFrame=this.emptyTexture,this.node.addChild(t)}cc.log("CountingLayout:init"+this.node.childrenCount)},t.prototype.feed=function(e){var t=e.convertToWorldSpaceAR(cc.Vec2.ZERO);t.y+=128;for(var n=function(){var e=r.node.children[r.node.childrenCount-1],n=e.convertToWorldSpaceAR(cc.Vec2.ZERO);e.removeFromParent(!1),e.position=n,cc.director.getScene().addChild(e),(new cc.Tween).target(e).to(1,{position:t},null).call(function(){e.active=!1}).start()},r=this;this.node.childrenCount>0;)n()},i([c],t.prototype,"fullCount",void 0),i([c],t.prototype,"emptyCount",void 0),i([c(cc.SpriteFrame)],t.prototype,"fullTexture",void 0),i([c(cc.SpriteFrame)],t.prototype,"emptyTexture",void 0),i([c],t.prototype,"scale",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],drag:[function(e,t,n){"use strict";cc._RF.push(t,"ba476WS2vlGRrmbU5ZUEfu+","drag");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./drop"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.resizeWithLabel=!1,t.fixOnMatch=!0,t.allowDrag=!0,t.returnBackOnNoMatch=!0,t.multipleDrags=!1,t.match=!1,t.matchingNode=null,t.multipleNode=null,t.isDragging=!1,t.touchStartOriginPos=null,t.isMoved=!1,t.isReverseXNeeded=!1,t}var n;return o(t,e),n=t,t.prototype.onLoad=function(){},t.prototype.onEnable=function(){this.enableTouch()},t.prototype.enableTouch=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this),this.node.on("touchmove",this.onTouchMove,this)},t.prototype.onDisable=function(){this.disableTouch()},t.prototype.disableTouch=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this),this.node.off("touchmove",this.onTouchMove,this)},t.prototype.start=function(){if(this.resizeWithLabel&&null!=this.label){var e=this.label.node.width;this.node.width=e+20,this.node.getComponent(cc.BoxCollider).size.width=this.node.width,this.node.parent.width=this.node.width}},t.prototype.onTouchStart=function(){n.letDrag&&!this.isDragging&&this.allowDrag&&(this.touchStartOriginPos=this.node.getPosition(),n.letDrag=!1,this.isDragging=!0,this.allowDrag&&this.touchStartAnimation(),this.allowDrag&&this.multipleDrags&&null==this.multipleNode&&(this.multipleNode=cc.instantiate(this.node),this.node.parent.insertChild(this.multipleNode,0)))},t.prototype.onTouchMove=function(e){this.allowDrag&&this.isDragging&&(this.isReverseXNeeded?this.node.setPosition(this.node.position.x-e.getDelta().x,this.node.position.y+e.getDelta().y):this.node.setPosition(this.node.position.add(e.getDelta())))},t.prototype.onTouchEnd=function(e,t){var r=this;if(void 0===t&&(t=!0),this.allowDrag&&this.isDragging){var o=this.node.getPosition().sub(this.touchStartOriginPos);if(this.isMoved=o.magSqr()>=10,this.touchEndAnimation(),this.match)this.allowDrag=!1,this.disableTouch(),this.matchingNode.getComponent(a.default).onMatchOver(this.node),(new cc.Tween).target(this.node).to(.25,{position:this.matchPos(e.getLocation())},null).call(function(){r.onMatchOver()}).start();else if(this.returnBackOnNoMatch){if(this.disableTouch(),!t)return void this.onReturnBackOnNoMatch();(new cc.Tween).target(this.node).to(.35,{position:this.returnBackOnNoMatchPos()},{progress:null,easing:"sineOut"}).call(function(){r.onReturnBackOnNoMatch()}).start()}else this.isDragging=!1,n.letDrag=!0}},t.prototype.onReturnBackOnNoMatch=function(){this.multipleDrags&&null!=this.multipleNode&&(this.multipleNode.removeFromParent(),this.multipleNode=null),this.enableTouch(),this.isDragging=!1,n.letDrag=!0},t.prototype.onCollisionEnter=function(e,t){this.allowDrag&&this.isDragging&&this.collisionEnterCondition(t,e)&&e.node.getComponent(a.default).allowDrop&&(this.match=!0,this.matchingNode=e.node)},t.prototype.onCollisionExit=function(e){this.allowDrag&&this.isDragging&&this.collisionExitCondition(this.matchingNode,e.node)&&(this.match=!1,this.matchingNode=null)},t.prototype.onDestroy=function(){this.disableTouch()},t.prototype.onMatchOver=function(){if(this.isDragging=!1,n.letDrag=!0,this.fixOnMatch){this.allowDrag=!1;var e=this.matchingNode;this.node.removeFromParent(),this.node.position=cc.Vec2.ZERO,e.addChild(this.node),this.node.getChildByName("shouldFlip")&&(this.node.scaleX=-1),this.disableTouch()}else this.enableTouch(),this.allowDrag=!0},t.prototype.returnBackOnNoMatchPos=function(){return cc.Vec2.ZERO},t.prototype.matchPos=function(){return this.node.parent.convertToNodeSpaceAR(this.matchingNode.convertToWorldSpaceAR(cc.Vec2.ZERO))},t.prototype.collisionEnterCondition=function(e,t){return t.node.name===e.node.name},t.prototype.collisionExitCondition=function(e,t){return e===t},t.prototype.touchStartAnimation=function(){(new cc.Tween).target(this.node).to(.25,{scale:1.1},{progress:null,easing:"elasticOut"}).start()},t.prototype.touchEndAnimation=function(){(new cc.Tween).target(this.node).to(.25,{scale:1},{progress:null,easing:"elasticOut"}).start()},t.letDrag=!0,i([l(cc.Label)],t.prototype,"label",void 0),i([l],t.prototype,"resizeWithLabel",void 0),i([l],t.prototype,"fixOnMatch",void 0),i([l],t.prototype,"allowDrag",void 0),i([l],t.prototype,"returnBackOnNoMatch",void 0),i([l],t.prototype,"multipleDrags",void 0),n=i([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./drop":"drop"}],drop:[function(e,t,n){"use strict";cc._RF.push(t,"08edb7X3GlB7rjongfPHlr4","drop");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./drag"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowDrop=!0,t.allowOnlyOneDrop=!0,t.match=!1,t.matchingNode=null,t}return o(t,e),t.prototype.onLoad=function(){},t.prototype.onCollisionEnter=function(e,t){this.allowDrop&&this.collisionEnterCondition(t,e)&&e.node.getComponent(a.default).allowDrag&&(this.match=!0,this.matchingNode=e.node)},t.prototype.onCollisionExit=function(){this.allowDrop&&(this.match=!1,this.matchingNode=null)},t.prototype.onMatchOver=function(e){void 0===e&&(e=null),this.match=!1,this.allowOnlyOneDrop&&(this.allowDrop=!1)},t.prototype.collisionEnterCondition=function(e,t){return t.node.name===e.node.name},i([l],t.prototype,"allowDrop",void 0),i([l],t.prototype,"allowOnlyOneDrop",void 0),i([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./drag":"drag"}],"error-handler":[function(e,t,n){"use strict";cc._RF.push(t,"9e5224HgUhODLrW4Q2cpHSn","error-handler");var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.catchError=void 0;var a=e("../util-logger");function s(e,t){var n=t.catchFunction,r=t.className,a=t.funcName;function s(e,t,r,o,i){void 0===o&&(o=this),void 0===i&&(i=[]),n(e.message,e.stack,t,r,o,i)}var c=e;return"AsyncFunction"===c.constructor.name?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:t=this,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c.apply(t,e)];case 2:return[2,n.sent()];case 3:return[2,s(n.sent(),a,r,t,e)];case 4:return[2]}})})}:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;try{var o=c.apply(n,e);return o instanceof Promise?o.catch(function(t){return s(t,a,r,n,e)}):o}catch(i){return s(i,a,r,n,e)}}}function c(e,t,n,r,o){if(cc.log("errMessage:"+e+"from className:"+r+" funcName:"+n),o){var i={errMessage:e,className:r,funcName:n};a.default.logChimpleEvent("errorInfo",i)}}function l(e){return function(t,n,o){var i,a,l,u;if(e={catchFunction:c},a=r({funcName:n,className:t.constructor.name},e),"function"==typeof t&&void 0===o)return s(t,r(r({},a),{funcName:t.name}));var d=o.get,p=o.value;if(d)l=d,u="get";else{if("function"!=typeof p)throw new TypeError("Invalid decoration");l=p,u="value"}return"function"==typeof t&&void 0!==o&&(a.className="static "+("get"===u?"getter":"method"),a.funcName=l.name),r(r({},o),((i={})[u]=s(l,a),i))}}n.catchError=l,n.default=l,cc._RF.pop()},{"../util-logger":"util-logger"}],friend:[function(e,t,n){"use strict";cc._RF.push(t,"066afartCZBcbeIZXwSH9JA","friend");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./lib/profile"),s=e("./util"),c=cc._decorator,l=c.ccclass,u=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.db=null,t.button=null,t.helpSpoken=new Set,t.speakFullHelp=!0,t.isFace=!1,t.extraClip=null,t.helpAudioId=-1,t.helpFile=null,t}return o(t,e),t.prototype.playHappyAnimation=function(e){this.playAnimation(this.isFace?"face_happy":"happy",e)},t.prototype.playSadAnimation=function(e){this.playAnimation(this.isFace?"face_wrong":"sad",e)},t.prototype.playSpeakAnimation=function(e){this.playAnimation(this.isFace?"face_eating":"talking",e)},t.prototype.playIdleAnimation=function(e){this.playAnimation(this.isFace?"face_touch":"idle",e)},t.prototype.playAnimation=function(e,t){this.db&&this.db.playAnimation(e,t)},t.prototype.speakHelp=function(e){var t=this;if(void 0===e&&(e=!0),(e||this.speakFullHelp&&this.extraClip)&&this.helpSpoken.has(this.helpFile))this.speakFullHelp=!1,this.speakExtra();else{var n=a.default.lang+"-help",r=s.Util.bundles.get(n);r?this.loadAndPlay(r):cc.assetManager.loadBundle(a.default.lang+"-help",function(e,r){e?t.speakExtra():(s.Util.bundles.set(n,r),t.loadAndPlay(r))})}},t.prototype.loadAndPlay=function(e){var t=this;e.load(this.helpFile,cc.AudioClip,function(e,n){!e&&t.isValid?(t.helpSpoken.add(t.helpFile),t.speakFullHelp=!0,t.helpAudioId=t.speak(n,t.speakExtra.bind(t))):t.speakExtra()})},t.prototype.speakExtra=function(e){void 0===e&&(e=null),this.helpAudioId=this.speak(this.extraClip,e)},t.prototype.speak=function(e,t,n,r){var o=this;void 0===t&&(t=null),void 0===n&&(n=!1),void 0===r&&(r=null);var i=-1;return!e||n&&0!=a.default.getItem(a.SFX_OFF)?(null!=r&&this.playAnimation(r,1),t&&t()):(this.stopAudio(),-1!=(i=s.Util.play(e,!1))?null==r?(this.playSpeakAnimation(0),this.button.interactable=!1,cc.audioEngine.setFinishCallback(i,function(){o.helpAudioId=-1,o.playIdleAnimation(1),o.button.interactable=!0,t&&t()})):(this.playAnimation(r,1),t&&t()):t&&t()),i},t.prototype.speakGameAudioOrPhonics=function(e,t){var n=this;this.playSpeakAnimation(0),this.button.interactable=!1,s.Util.speakGameAudioOrPhonics(e,function(e){n.playIdleAnimation(1),n.button.interactable=!0,t(e)})},t.prototype.speakEquation=function(e,t){var n=this;this.playSpeakAnimation(0),this.button.interactable=!1,s.Util.speakEquation(e,function(r){r+1>=e.length&&(n.playIdleAnimation(1),n.button.interactable=!0),t(r)})},t.prototype.speakPhonicsOrLetter=function(e,t){var n=this;this.playSpeakAnimation(0),this.button.interactable=!1,s.Util.speakPhonicsOrLetter(e,function(e){n.playIdleAnimation(1),n.button.interactable=!0,t(e)})},t.prototype.stopAudio=function(){try{cc.audioEngine.stopEffect(this.helpAudioId)}catch(e){cc.log(e)}this.button.interactable=!0,this.helpAudioId=-1},t.prototype.stopAnimation=function(e){this.db.armature().animation.stop(e)},t.prototype.onClick=function(){-1==this.helpAudioId&&this.speakHelp(!1)},Object.defineProperty(t.prototype,"interactable",{get:function(){return this.button.interactable},set:function(e){this.button.interactable=e},enumerable:!1,configurable:!0}),i([u(dragonBones.ArmatureDisplay)],t.prototype,"db",void 0),i([u(cc.Button)],t.prototype,"button",void 0),i([l],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./lib/profile":"profile","./util":"util"}],gameConfigs:[function(e,t,n){"use strict";cc._RF.push(t,"d347fp/dOxG7oNayW5uZph3","gameConfigs"),Object.defineProperty(n,"__esModule",{value:!0}),n.GAME_CONFIGS=void 0,n.GAME_CONFIGS={letterpair:{bundle:"letterpair",prefab:"prefabs/letterpair",youtube:"fDwymtxwy9s"},balloonpop:{bundle:"balloonpop",prefab:"prefabs/balloonpop",youtube:"Z5rnMcNKPD8"},fillblank:{bundle:"fillblank",prefab:"prefabs/fillblank",youtube:"j6fANDptuvo"},bubbletype:{bundle:"bubbletype",prefab:"prefabs/bubbletype",youtube:"MjFTkxrMbdc"},spelldoor:{bundle:"spelldoor",prefab:"prefabs/spelldoor",youtube:"enFOu65Uwx4"},jumpsentence:{bundle:"jumpsentence",prefab:"prefabs/jumpsentence",youtube:"ceXy55PXp-U"},createsentence:{bundle:"createsentence",prefab:"prefabs/createsentence",center:!0,youtube:"slZwEasK-jo"},phonictractor:{bundle:"phonictractor",prefab:"prefabs/phonictractor",youtube:"a24jtA7oThk"},grid:{bundle:"grid",prefab:"prefabs/grid",youtube:"pDsB_CZxX5E"},tag:{bundle:"tag",prefab:"prefabs/tag",youtube:"-0GQkGkncJo"},speakingpet:{bundle:"speakingpet",prefab:"prefabs/speakingpet",youtube:"-Fonf3qzguY"},alphabetrecorder:{bundle:"alphabetrecorder",prefab:"prefabs/alphabetrecorder",fontName:"en-main",youtube:"Ez9oouE2pOE"},writeletter:{bundle:"writeletter",prefab:"prefabs/writeletter",fontName:"en-main",youtube:"n2F8q4I6zi8"},writecard:{bundle:"writecard",prefab:"prefabs/writecard",fontName:"en-main",youtube:"76TnIpzhXdA"},writeword:{bundle:"writeword",prefab:"prefabs/writeword",fontName:"en-main",youtube:"-u6-MF9iIus"},letterboard:{bundle:"board",prefab:"prefabs/board",youtube:"ekDV8yQKV38"},pictureboard:{bundle:"pictureboard",prefab:"prefabs/pictureboard",youtube:"fOoNh8HJ6u4"},stamp:{bundle:"stamp",prefab:"prefabs/stamp",youtube:"fOoNh8HJ6u4"},imagerecorder:{bundle:"imagerecorder",prefab:"prefabs/imagerecorder",youtube:"Ez9oouE2pOE"},drawshape:{bundle:"drawshape",prefab:"prefabs/drawshape",center:!0,youtube:"9y_Bxu3d7QI"},rocket:{bundle:"rocket",prefab:"prefabs/rocket",youtube:"BIyAbT1hvTA"},openwindow:{bundle:"openwindow",prefab:"prefabs/openwindow",youtube:"VwVEw3cexvI"},openwindow1:{bundle:"openwindow1",prefab:"prefabs/openwindow1",youtube:"VwVEw3cexvI"},picturemeaning:{bundle:"picturemeaning",prefab:"prefabs/picturemeaning",youtube:"HjGkNcubLSY"},story:{bundle:"story",prefab:"prefabs/story",fontName:"en-main",youtube:"HqNviQM4Dlg"},storyquiz:{bundle:"storyquiz",prefab:"prefabs/storyquiz",fontName:"en-main",youtube:"JOPV3cMwE_A"},youtube:{bundle:"youtube",prefab:"prefabs/youtube",youtube:"Ez9oouE2pOE"},monster:{bundle:"monster",prefab:"prefabs/monster",youtube:"YzzfbTQ61I4"},stickerbook:{bundle:"stickerbook",prefab:"prefabs/stickerbook",youtube:""},calculator:{bundle:"calculator",prefab:"prefabs/calculator",youtube:"FdPshuC9xss"},rowblocks:{bundle:"rowblocks",prefab:"prefabs/rowblocks",youtube:"3b-Eqm31ITA"},matchbox:{bundle:"matchbox",prefab:"prefabs/matchbox",youtube:"_ZfxpZKDfA0"},multiplybeads:{bundle:"multiplybeads",prefab:"prefabs/multiplybeads",youtube:"Ss1-87ACiwc"},groupsum:{bundle:"groupsum",prefab:"prefab/groupsum",youtube:"cuBJc_OfYSo"},nimbletable:{bundle:"nimbletable",prefab:"prefabs/nimbletable",youtube:"rmqaFgpZgSY"},foodjar:{bundle:"foodjar",prefab:"prefabs/foodjar",youtube:"G8xRZoGMtt8"},writenumber:{bundle:"writenumber",prefab:"prefabs/writenumber",fontName:"en-main",youtube:"DlnrR7bdtgU"},writeset:{bundle:"writeset",prefab:"prefabs/writeset",fontName:"en-main",youtube:"HVBzuMqbLLw"},numberboard:{bundle:"board",prefab:"prefabs/board",youtube:"-cPVMr-LR_Q"},sumtogether:{bundle:"sumtogether",prefab:"prefabs/sumtogether",youtube:"jOqT2l4YSF0"},shapepair:{bundle:"letterpair",prefab:"prefabs/letterpair",youtube:"81wKOqF3UJM"},numberpair:{bundle:"letterpair",prefab:"prefabs/letterpair",youtube:"UvevHCxxJ2o"},questionboard:{bundle:"questionboard",prefab:"prefabs/questionboard",youtube:"zgAInxZ0ZAc"},matchingcard:{bundle:"matchingcard",prefab:"prefabs/matchingcard",youtube:"Vl0OX5oJY_I"},blender:{bundle:"blender",prefab:"prefabs/blender",youtube:"uYHbJ191884"},sequencebox:{bundle:"sequencebox",prefab:"prefabs/sequencebox",youtube:"ttqUscQd88g"},tenbox:{bundle:"tenbox",prefab:"prefabs/tenbox",youtube:"39zIZ3OAE5c"},taprise:{bundle:"taprise",prefab:"prefabs/taprise",youtube:"-7dYda3w1Rg"},total:{bundle:"total",prefab:"prefabs/total",youtube:"vD6wssd-97g"},checkerblocks:{bundle:"checkerblocks",prefab:"prefabs/checkerblocks",youtube:"SzV4lhawfPY"},ordertractor:{bundle:"ordertractor",prefab:"prefabs/ordertractor",youtube:"o3hhduN0KoY"},balancing:{bundle:"balancing",prefab:"prefabs/balancing",youtube:"H2nLW8CyfOw"},shapetractor:{bundle:"shapetractor",prefab:"prefabs/shapetractor",youtube:"5fFmHM1OfyU"},fillanswer:{bundle:"fillblank",prefab:"prefabs/fillblank",youtube:"5Ws5ouABV8o"},quizliteracy:{bundle:"quiz",prefab:"quizliteracy/prefabs/quizliteracy",youtube:"rNyr6GPVjH4"},quizmaths:{bundle:"quiz",prefab:"quizmaths/prefabs/quizmaths",youtube:"WF90chix1jU"},arrangeletters:{bundle:"arrangeletters",prefab:"prefabs/arrangeletters",youtube:"bcLLqULE5_0"},dragthealphabet:{bundle:"dragthealphabet",prefab:"prefabs/dragthealphabet",youtube:"2mU3FDZMgoY"},jungle:{bundle:"platform",prefab:"prefabs/assemble/Platform",youtube:"Fxbmzp7rvkE"},beach:{bundle:"platform",prefab:"prefabs/beach/Platform",youtube:"Fxbmzp7rvkE"},city:{bundle:"platform",prefab:"prefabs/city/Platform",youtube:"Fxbmzp7rvkE"},desert:{bundle:"platform",prefab:"prefabs/desert/Platform",youtube:"Fxbmzp7rvkE"},farm:{bundle:"platform",prefab:"prefabs/farm/Platform",youtube:"Fxbmzp7rvkE"},garden:{bundle:"platform",prefab:"prefabs/garden/Platform",youtube:"Fxbmzp7rvkE"},playground:{bundle:"platform",prefab:"prefabs/playground/Platform",youtube:"Fxbmzp7rvkE"},sea:{bundle:"platform",prefab:"prefabs/sea/Platform",youtube:"Fxbmzp7rvkE"},sky:{bundle:"platform",prefab:"prefabs/sky/Platform",youtube:"Fxbmzp7rvkE"},snow:{bundle:"platform",prefab:"prefabs/snow/Platform",youtube:"Fxbmzp7rvkE"}},cc._RF.pop()},{}],game:[function(e,t,n){"use strict";cc._RF.push(t,"4c3bbRj+LpBv4jZ+9BBLq4z","game");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.friendPos=null,t.friend=null,t}return o(t,e),i([c(cc.Node)],t.prototype,"friendPos",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],globals:[function(e,t){"use strict";cc._RF.push(t,"52453a3z3xFCYsUXqHjog5c","globals"),cc._RF.pop()},{}],headerButton:[function(e,t,n){"use strict";cc._RF.push(t,"3681eSnAN5MGoPeKVSnGUjg","headerButton");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),i([c(cc.Label)],t.prototype,"label",void 0),i([c(cc.Button)],t.prototype,"button",void 0),i([c(cc.Sprite)],t.prototype,"sprite",void 0),i([c(cc.Sprite)],t.prototype,"selected",void 0),i([c(cc.SpriteFrame)],t.prototype,"homeSprite",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],header:[function(e,t,n){"use strict";cc._RF.push(t,"1a43dS1gWNM66gKUikPcRGy","header");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./headerButton"),s=e("./lib/config"),c=e("./util"),l=cc._decorator,u=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.courseLayout=null,t.headerButtonPrefab=null,t.showHome=!0,t.homePos=null,t.rightPos=null,t.firstSelected=!0,t}var n;return o(t,e),n=t,t.prototype.onLoad=function(){var e=this,t=s.default.i;if(this.user.courseProgressMap.forEach(function(r,o){var i=cc.instantiate(e.headerButtonPrefab),s=i.getComponent(a.default);s.selected.node.active=!1,e.courseLayout.addChild(i),e.firstSelected&&(e.selectHeaderButton(s),e.firstSelected=!1);var l=t.curriculum.get(o);s.label.string=c.Util.i18NText(l.name),c.Util.load(o+"/course/res/icons/"+o+".png",function(e,t){s.sprite.spriteFrame=e?null:new cc.SpriteFrame(t)}),s.button.node.on("touchend",function(r){r.target.getComponent(cc.Button).enabled&&(n.homeSelected=!1,e.selectHeaderButton(s),t.course=l,e.onCourseClick&&e.onCourseClick())}),!n.homeSelected&&t.course&&t.course.id==l.id&&e.selectHeaderButton(s)}),this.showHome){var r=cc.instantiate(this.headerButtonPrefab),o=r.getComponent(a.default);o.button.node.on("touchend",function(t){if(t.target.getComponent(cc.Button).enabled){n.homeSelected=!0;var r=s.default.i;r.course=null,r.chapter=null,r.lesson=null,e.selectHeaderButton(o),e.onHomeClick&&e.onHomeClick()}}),o.label.string=c.Util.i18NText("Home"),this.homePos.addChild(r),o.selected.node.active=!1,n.homeSelected&&this.selectHeaderButton(o)}this.onRightClick&&this.rightPos.on("touchend",this.onRightClick),this.node.width=cc.winSize.width;var i=Math.max(0,(this.courseLayout.width-this.courseLayout.childrenCount*this.courseLayout.children[0].width)/(this.courseLayout.childrenCount+1));this.courseLayout.getComponent(cc.Layout).spacingX=i,this.courseLayout.getComponent(cc.Layout).paddingLeft=i,this.courseLayout.getComponent(cc.Layout).paddingRight=i},t.prototype.selectHeaderButton=function(e){null!=this.selectedHeaderButton&&(this.selectedHeaderButton.selected.node.active=!1,this.selectedHeaderButton.button.enabled=!0),e.selected.node.active=!0,e.button.enabled=!1,this.selectedHeaderButton=e},t.homeSelected=!0,i([d(cc.Node)],t.prototype,"courseLayout",void 0),i([d(cc.Prefab)],t.prototype,"headerButtonPrefab",void 0),i([d()],t.prototype,"showHome",void 0),i([d(cc.Node)],t.prototype,"homePos",void 0),i([d(cc.Node)],t.prototype,"rightPos",void 0),n=i([u],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./headerButton":"headerButton","./lib/config":"config","./util":"util"}],helpChimp:[function(e,t,n){"use strict";cc._RF.push(t,"9ea8252xShAnYFifciKMS2w","helpChimp");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./lib/profile"),s=e("./util"),c=cc._decorator,l=c.ccclass,u=c.property,d=new Map,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chimp=null,t.helpKey=null,t.helpAudioId=-1,t}return o(t,e),t.prototype.onLoad=function(){var e=this;this.node.x=-cc.winSize.width/2-70,(new cc.Tween).target(this.node).to(.25,{x:-cc.winSize.width/2+70},{}).start(),this.chimp.playAnimation("idle",0),this.node.getComponent(cc.Button).interactable=!1;var t=a.default.lang+"-help",n=s.Util.bundles.get(t);n?this.loadAndPlay(n):cc.assetManager.loadBundle(t,function(n,r){n||(s.Util.bundles.set(t,r),e.loadAndPlay(r))})},t.prototype.loadAndPlay=function(e){var t=this;e.load(this.helpKey,cc.AudioClip,function(e,n){null!=t.node&&(e||(t.clip=n,d.has(t.helpKey)?t.node.getComponent(cc.Button).interactable=!0:(d.set(t.helpKey,1),t.speak())))})},t.prototype.speak=function(){var e=this;-1==this.helpAudioId&&this.clip&&(this.helpAudioId=s.Util.play(this.clip,!1),-1!=this.helpAudioId&&(this.chimp.armature().animation.stop("idle"),this.chimp.playAnimation("talking",0),this.node.getComponent(cc.Button).interactable=!1,cc.audioEngine.setFinishCallback(this.helpAudioId,function(){e.chimp.armature().animation.stop("talking"),e.chimp.playAnimation("idle",0),e.node.getComponent(cc.Button).interactable=!0,e.helpAudioId=-1})))},t.prototype.onDisable=function(){-1!=this.helpAudioId&&cc.audioEngine.stop(this.helpAudioId)},i([u(dragonBones.ArmatureDisplay)],t.prototype,"chimp",void 0),i([u],t.prototype,"helpKey",void 0),i([l],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./lib/profile":"profile","./util":"util"}],helper:[function(e,t,n){"use strict";cc._RF.push(t,"3795bHNzUtOY6Snt9nuSu8q","helper"),Object.defineProperty(n,"__esModule",{value:!0}),n.Helper=n.GO_TO_NEXT_PROBLEM=n.BOTTOM_MIDDLE=n.AUTO_TOUCH_START=n.TUTORIAL_IMAGES=n.LETTER_VOICE=n.PHONIC_VOICE=n.NUMBER_VOICE=n.QUIZ_MATHS_DIR=n.QUESTION_BOARD=n.HELP_DIR=n.SOUND_LOADED_EVENT=n.WRONG_EVENT=n.CORRECT_EVENT=n.PROBLEM_OVER_EVENT=n.GAME_OVER_EVENT=n.GAME_START_EVENT=n.MOVE_NOT_MATCH=n.MOVE_MATCH=n.RESET_TRACING=n.BACK_FINISHED=n.RECORDING_FINISHED=n.MOVE_TO_NEXT_LETTER_EVENT=n.TRACING_WRONG=n.RESET_TRACING_NOT_ALLOWED=n.RESET_TRACING_ALLOWED=n.TRACING_CORRECT=n.SHOW_CHILD_IMAGE=n.TRACING_FINISHED=n.CONFIG_LOADED=n.DEFAULT_FONT_COLOR=n.LEVEL_FONT_SIZE=n.FONT_SIZE=n.ALL_REWARDS=n.DIAMOND_BOX=n.DIAMOND=n.CROWN=n.BANANA=n.COIN=n.FILLER_GROUP=n.QUIZ_GROUP=n.OBSTACLE_GROUP=n.REWARD_GROUP=n.PLAYER_GROUP=n.WALL_GROUP=n.GROUND_GROUP=void 0;var r=e("../Tracing/scripts/singlelettertracing");n.GROUND_GROUP="ground",n.WALL_GROUP="wall",n.PLAYER_GROUP="player",n.REWARD_GROUP="reward",n.OBSTACLE_GROUP="obstacle",n.QUIZ_GROUP="quizcollect",n.FILLER_GROUP="fillerwait",n.COIN="coin",n.BANANA="banana",n.CROWN="crown",n.DIAMOND="diamond",n.DIAMOND_BOX="diamondbox",n.ALL_REWARDS=[n.COIN,n.BANANA,n.CROWN,n.DIAMOND,n.DIAMOND_BOX],n.FONT_SIZE="65",n.LEVEL_FONT_SIZE="40",n.DEFAULT_FONT_COLOR=cc.Color.BLACK,n.CONFIG_LOADED="configLoaded",n.TRACING_FINISHED="tracingFinished",n.SHOW_CHILD_IMAGE="showChildImage",n.TRACING_CORRECT="tracingCorrect",n.RESET_TRACING_ALLOWED="resetTracingAllowed",n.RESET_TRACING_NOT_ALLOWED="resetTracingNotAllowed",n.TRACING_WRONG="tracingWrong",n.MOVE_TO_NEXT_LETTER_EVENT="moveToNextLetter",n.RECORDING_FINISHED="recordingFinished",n.BACK_FINISHED="backFinished",n.RESET_TRACING="resetTracing",n.MOVE_MATCH="MoveMatch",n.MOVE_NOT_MATCH="MoveNotMatch",n.GAME_START_EVENT="gameStart",n.GAME_OVER_EVENT="gameOver",n.PROBLEM_OVER_EVENT="problemOver",n.CORRECT_EVENT="correct",n.WRONG_EVENT="wrong",n.SOUND_LOADED_EVENT="soundLoaded",n.HELP_DIR="help/",n.QUESTION_BOARD="questionboard",n.QUIZ_MATHS_DIR="quizmaths",n.NUMBER_VOICE="numbervoice/",n.PHONIC_VOICE="course/res/sound/phonicvoice/",n.LETTER_VOICE="course/res/sound/lettervoice/",n.TUTORIAL_IMAGES="drawshape/res/image/",n.AUTO_TOUCH_START="autoTouchStart",n.BOTTOM_MIDDLE=new cc.Vec2(0,.5),n.GO_TO_NEXT_PROBLEM="goToNextProblem";var o=function(){function e(){}return e.subScribeToTracingEvents=function(e,t,r){e.on(n.TRACING_FINISHED,function(){r()}),e.on(n.TRACING_CORRECT,function(e){e.stopPropagation(),t.emit("correct")}),e.on(n.TRACING_WRONG,function(e){e.stopPropagation(),t.emit("wrong")})},e.buildLetters=function(e,t,n,o,i,a){var s=t.getComponent(cc.Layout);s.spacingX=50,t.scale=.75,n.forEach(function(t,n){var c=cc.instantiate(o);c.width=i,c.height=a,c.name="L"+n;var l=c.getComponent(r.SingleLetterTracing);l.order=n,l.letter=t,l.wordTracingContainer=e,s.node.addChild(c)})},e}();n.Helper=o,cc._RF.pop()},{"../Tracing/scripts/singlelettertracing":"singlelettertracing"}],help:[function(e,t,n){"use strict";cc._RF.push(t,"753cd133+lDWoibLGRa2OFk","help");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callBack=null,t.hand=null,t.grayL=null,t.grayR=null,t.grayT=null,t.grayB=null,t}return o(t,e),t.prototype.initNodes=function(e,t,n){this.from=e,this.to=t,this.callBack=n},t.prototype.onLoad=function(){this.drawGray(this.from)},t.prototype.drawGray=function(e){var t=e.getBoundingBoxToWorld();this.grayL.right=cc.winSize.width-t.xMin,this.grayR.left=t.xMax,this.grayT.right=cc.winSize.width-t.xMin,this.grayT.left=t.xMax,this.grayT.bottom=t.yMax,this.grayB.right=cc.winSize.width-t.xMin,this.grayB.left=t.xMax,this.grayB.top=cc.winSize.height-t.yMin,this.grayL.updateAlignment(),this.grayR.updateAlignment(),this.grayT.updateAlignment(),this.grayB.updateAlignment()},t.prototype.start=function(){this.help()},t.prototype.help=function(){var e=this;this.node.active=!0,(new cc.Tween).target(this.hand).set({position:this.node.convertToNodeSpaceAR(this.from.getBoundingBoxToWorld().center)}).to(.25,{scale:.8},null).delay(1).call(function(){e.drawGray(e.to)}).to(1,{position:this.node.convertToNodeSpaceAR(this.to.getBoundingBoxToWorld().center)},null).to(.25,{scale:1},null).call(function(){e.node.active=!1,null!=e.callBack&&e.callBack()}).start()},i([c(cc.Node)],t.prototype,"hand",void 0),i([c(cc.Widget)],t.prototype,"grayL",void 0),i([c(cc.Widget)],t.prototype,"grayR",void 0),i([c(cc.Widget)],t.prototype,"grayT",void 0),i([c(cc.Widget)],t.prototype,"grayB",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],"indicator-node":[function(e,t,n){"use strict";cc._RF.push(t,"406a0I1/jFKSKXx9lktO5FY","indicator-node");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=e("./tracing-node"),c=e("./arrow-node"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._collisionCount=0,t._counterValue=0,t._arrowValue=0,t.traceGraphics=null,t.currentPath=null,t}return o(t,e),t.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},t.prototype.onCollisionEnter=function(e,t){switch(e.node.group){case"choice":this.collisionEnter(e,t)}},t.prototype.collisionEnter=function(e){if("tracingNode"===e.node.name){var t=e.node.getComponent(s.default);if(null!==t){var n=t.currentPath;this.currentPath===n&&(this._collisionCount++,this._counterValue=t.counter)}}else if("arrowNode"===e.node.name){var r=e.node.getComponent(c.default);cc.log("checking contact with arrow Node",r.arrowValue,"with path",r.currentPath," and current value",this.traceGraphics.currentArrowValue),null!==r&&(n=r.currentPath,this.currentPath===n&&(this._arrowValue=r.arrowValue,this.traceGraphics.currentArrowValue+1===r.arrowValue&&(this.traceGraphics.currentArrowValue=r.arrowValue,this.traceGraphics.nextArrowValue=this.traceGraphics.currentArrowValue+1,this.traceGraphics.arrowPos=e.node.getPosition(),this.traceGraphics.arrowStarCounter=r.starCounter,cc.log("contact with arrow Node",r.arrowValue))))}},t.prototype.onCollisionExit=function(e,t){switch(e.node.group){case"choice":this.collisionExit(e,t)}},t.prototype.collisionExit=function(e){if("tracingNode"===e.node.name){var t=e.node.getComponent(s.default);if(null!==t){var n=t.currentPath;this.currentPath===n&&(this._collisionCount--,this._collisionCount<=0&&this.traceGraphics.disableTouchAsNoCollision(!1))}}else if("arrowNode"===e.node.name){var r=e.node.getComponent(c.default);null!==r&&(n=r.currentPath,this.currentPath===n&&cc.log("contact lost with arrow Node",r.arrowValue))}},Object.defineProperty(t.prototype,"collisionCount",{get:function(){return this._collisionCount},set:function(e){this._collisionCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"counterValue",{get:function(){return this._counterValue},enumerable:!1,configurable:!0}),i([a],t)}(cc.Component);n.default=l,cc._RF.pop()},{"./arrow-node":"arrow-node","./tracing-node":"tracing-node"}],kannada:[function(e,t,n){"use strict";cc._RF.push(t,"982ebVMHqpNWo/tGaCwLVow","kannada");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return o(t,e),t.prototype.onLoad=function(){this.node.width=256},t.prototype.start=function(){this.node.width=256},i([c(cc.Label)],t.prototype,"label",void 0),i([c],t.prototype,"text",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],lessonController:[function(e,t,n){"use strict";cc._RF.push(t,"b559c8Ur4pLyZP4wRVFDP7W","lessonController");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../queue"),l=e("./friend"),u=e("./game"),d=e("./lib/config"),p=e("./lib/constants"),h=e("./lib/gameConfigs"),f=e("./lib/profile"),g=e("./progressMonitor"),_=e("./quiz-monitor"),m=e("./util"),y=e("./util-logger"),v=e("../scorecard/scripts/scorecard"),b=e("./services/ServiceConfig"),E=e("./services/ParseNetwork"),S=e("./domain/parseConstants"),I=e("./services/FirebaseApi"),C=cc._decorator,w=C.ccclass,P=C.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressMonitor=null,t.correctAudio=null,t.wrongAudio=null,t.startAudio=null,t.scorecardPrefab=null,t.blockPrefab=null,t.gameParent=null,t.loading=null,t.backButton=null,t.progressMonitorNode=null,t.gameNode=null,t.wrongMoves=0,t.rightMoves=0,t.nest=null,t.quizScore=0,t.totalQuizzes=0,t.isQuizAnsweredCorrectly=!1,t.lessonStartTime=0,t.lessonSessionId=null,t.problemSessionId=null,t.problemStartTime=(new Date).getTime(),t.problemTime=0,t.isGameCompleted=!1,t.isQuizCompleted=!1,t.isQuiz=!1,t.gameTime=0,t.quizTime=0,t.quizScores=[],t.tempWrongMoves=0,t.isCuba=f.default.getItem(p.IS_CUBA),t}var n;return o(t,e),n=t,t.prototype.onLoad=function(){var e=this;this.loading.width=cc.winSize.width,this.loading.zIndex=10,this.progressMonitorNode=cc.instantiate(this.progressMonitor),this.progressMonitorNode.zIndex=2,this.node.addChild(this.progressMonitorNode),this.node.addChild(n.friend.node),m.Util.loadAccessoriesAndEquipAcc(n.friend.node.children[1],n.friend.node),n.friend.node.removeFromParent(),this.lessonStart(),d.default.isMicroLink&&!this.isCuba?this.backButton.active=!1:this.backButton.on("touchend",function(){e.node.getChildByName("quit").active=!0,(parseInt(f.default.getValue(f.CURRENTMODE))==p.Mode.School||e.isCuba)&&(e.node.getChildByName("quit").getChildByName("quit_bg").getChildByName("exit_game").y=e.node.getChildByName("quit").getPosition().y,e.node.getChildByName("quit").getChildByName("quit_bg").getChildByName("help_video").active=!1)})},t.preloadLesson=function(e,t){n.bundles.forEach(function(e){cc.log("Releasing bundle: "+e.name),e.releaseAll()}),n.bundles.length=0;var r=d.default.i;if(r.problem=0,r.lesson.type==p.EXAM){var o=[],i=!1;r.chapter.lessons.forEach(function(e){i||(e.type!=p.EXAM?o.push(e):e.type==p.EXAM&&(e.id==r.lesson.id?i=!0:o.length=0))}),n.loadQuizzes(o,t,e)}else d.default.loadBundle(r.lesson.orig_lesson_id||r.lesson.id,function(e){n.preloadAndFirst(e,t)},t)},t.preloadAndFirst=function(e,t){e.preloadDir("res",null,null,function(){m.Util.bundles.set(d.default.i.lesson.orig_lesson_id||d.default.i.lesson.id,e),n.bundles.push(e),n.loadDataAndFirstGame(t)})},t.loadDataAndFirstGame=function(e,t,r,o){var i=this;void 0===t&&(t=null),void 0===r&&(r=null),void 0===o&&(o=0);var a=d.default.i;a.loadLessonJson(function(t){a.data=[t],i.preloadGame(function(t){i.gamePrefab=t,m.Util.loadFriend(function(t){n.friend=t.getComponent(l.default),e()})})},t,r,o)},t.loadQuizzes=function(e,t,r,o){void 0===o&&(o=0);var i=e.length;e.forEach(function(e){d.default.loadBundle(e.orig_lesson_id||e.id,function(t){t.preloadDir("res",null,null,function(){m.Util.bundles.set(e.orig_lesson_id||e.id,t),n.bundles.push(t),i--})},t)});var a=function(){i<=0&&(cc.director.getScheduler().unschedule(a,r),n.loadDataAndFirstGame(t,r,e,o))};cc.director.getScheduler().schedule(a,r,1)},t.preloadGame=function(e){var t=d.default.i;cc.log("in preload",t.data),t.game=t.data[0][0],t.currentGameLessonId=t.lesson.orig_lesson_id||t.lesson.id;var n=h.GAME_CONFIGS[t.game],r=t.course.id.split("-")[0]+"-"+d.DEFAULT_FONT;if(null!=n.fontName){var o=n.fontName.split("-");if(o&&2===o.length){var i=t.course.lang,a=o[1];r=i+"-"+a}}d.default.i.hasLoadedTextFont(r)?cc.assetManager.loadBundle(n.bundle,function(t,r){r.load(n.prefab,cc.Prefab,function(t,n){e(n)})}):d.default.i.loadFontDynamically(r,function(){cc.log("Loading font for game ...",r),cc.assetManager.loadBundle(n.bundle,function(t,r){r.load(n.prefab,cc.Prefab,function(t,n){e(n)})})})},t.prototype.lessonStart=function(){this.lessonStartTime=(new Date).getTime(),this.lessonSessionId=f.User.createUUID(),this.startGame(n.gamePrefab),this.loading.active=!1},t.prototype.problemStart=function(e){var t=this;this.problemStartTime=(new Date).getTime(),this.problemSessionId=f.User.createUUID(),e?n.preloadGame(function(e){n.friend.extraClip=null,n.friend.node.removeFromParent(),n.friend.isFace=!1,t.startGame(e),t.loading.active=!1}):(null!=this.gameNode&&this.gameNode.emit("nextIteration"),this.loading.active=!1)},t.prototype.startGame=function(e){var t=cc.instantiate(e),r=t.getComponent(u.default);r&&(r.friendPos||(r.friendPos=new cc.Node,r.friendPos.position=cc.v3(-512,-384),r.node.addChild(r.friendPos)),r.friend=n.friend,r.friend.node.position=cc.Vec3.ZERO,r.friendPos.addChild(n.friend.node),n.friend.helpFile="games/"+d.default.i.game,n.friend.playIdleAnimation(1)),null!=this.gameNode&&this.gameNode.removeFromParent(),this.gameNode=t,this.gameParent.addChild(this.gameNode),h.GAME_CONFIGS[d.default.i.game].center?(this.gameNode.x=-512,this.gameNode.y=-384):(this.gameNode.x=0,this.gameNode.y=0),this.setupEventHandlers()},t.prototype.problemEnd=function(e,t){var r=this;void 0===t&&(t=!0);var o=d.default.i,i=h.GAME_CONFIGS[o.game];i&&i.fontName&&o.releaseFont(o.currentFontName);var a=Math.ceil(((new Date).getTime()-this.problemStartTime)/1e3),s=this.progressMonitorNode.getComponent(g.default),l=o.problem;this.isQuiz=o.game.toLowerCase().includes("quizmaths")||o.game.toLowerCase().includes("quizliteracy"),this.isQuizCompleted=!!this.isQuiz,this.isGameCompleted=!this.isQuiz,this.isQuiz&&(this.totalQuizzes++,this.quizScores.push(this.isQuizAnsweredCorrectly?1:0));var u="story"==o.game;if(cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID)){var _={chapter:o.chapter.id,lesson:o.lesson.id,incorrect:this.wrongMoves,totalQuestions:o.totalProblems,correct:this.rightMoves,totalChallenges:o.totalProblems,totalSeconds:a,activity:o.game,kind:"Monitor",schoolId:cc.sys.localStorage.getItem(p.CURRENT_SCHOOL_ID),studentId:cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID),classId:cc.sys.localStorage.getItem(p.CURRENT_CLASS_ID)};c.Queue.getInstance().push(_)}var m=this.isQuiz?"quizEnd":"gameEnd",v={lessonSessionId:this.lessonSessionId,gameName:o.game,totalGames:o.totalProblems,currentGameNumber:o.problem,problemSessionId:this.problemSessionId,chapterName:o.chapter.name,chapterId:o.chapter.id,lessonName:o.lesson.name,lessonId:o.lesson.id,courseName:o.course.id,problemNo:o.problem,timeSpent:Math.abs(a),wrongMoves:this.wrongMoves,correctMoves:this.rightMoves,correct:this.isQuizAnsweredCorrectly?1:0,skills:o.lesson.skills&&o.lesson.skills.length>0?o.lesson.skills.join(","):"",game_completed:this.isGameCompleted,quiz_completed:this.isQuizCompleted,assignmentId:o.lesson.assignmentId||null,mlStudentId:o.lesson.mlStudentId||null,mlClassId:o.lesson.mlClassId||null,mlPartnerId:o.lesson.mlPartnerId||null};if(f.default.getItem(p.IS_CUBA)){var b=new CustomEvent("problemEnd",{detail:v});window.parent.document.body.dispatchEvent(b),console.log("problemEnd event dispatched",b)}if(y.default.logChimpleEvent(m,v),!d.default.isMicroLink){var E=y.default.currentDeviceId(),S={lessonSessionId:this.lessonSessionId,gameName:o.game,totalGames:o.totalProblems,currentGameNumber:o.problem,problemSessionId:this.problemSessionId,chapterName:o.chapter.name,chapterId:o.chapter.id,lessonName:o.lesson.name,lessonId:o.lesson.id,courseName:o.course.id,problemNo:o.problem,timeSpent:Math.abs(a),userId:f.User.getCurrentUser().id,deviceId:E},I=Object.keys(S).join(","),C=Object.values(S).join(",");y.default.logToDaily(E,I,C)}var w=this.isQuiz?this.isQuizAnsweredCorrectly?g.StarType.Correct:g.StarType.Wrong:u?t?g.StarType.NextPage:g.StarType.PrevPage:g.StarType.Default;s.updateProgress(l,w,function(){n.getFriend().stopAudio(),s.stopStar=!1,t&&l<o.totalProblems||!t&&l>1?(r.loading.active=!0,t?o.nextProblem():o.prevProblem(),r.problemStart(e)):r.lessonEnd()})},t.prototype.lessonEnd=function(){return a(this,void 0,void 0,function(){var e,t,r,o,i,a,l,u,g,_,C,w,P,O,A,R,N,T,L;return s(this,function(s){switch(s.label){case 0:if(m.Util.playSfx(this.startAudio),e=d.default.getInstance(),t=Math.ceil(((new Date).getTime()-this.lessonStartTime)/1e3),Math.abs(t)>1200&&(t=1200),r=Math.round(this.totalQuizzes>0?this.quizScore/this.totalQuizzes*70+this.rightMoves/(this.rightMoves+this.wrongMoves)*30:this.rightMoves/(this.rightMoves+this.wrongMoves)*100),isNaN(r)&&(r=0),(o=f.default.getItem(p.IS_CUBA))&&(i={chapterName:e.chapter.name,chapterId:e.chapter.id,lessonName:e.lesson.name,lessonId:e.lesson.id,courseName:e.course.id,lessonType:e.lesson.type,score:r,timeSpent:Math.abs(t),totalGames:e.totalProblems,wrongMoves:this.wrongMoves,correctMoves:this.rightMoves,correct:this.isQuizAnsweredCorrectly?1:0},e.lesson.id==e.course.id+"_PreQuiz"&&(i.preQuizChapterId=y.default.getChapterIdForPrequiz(this.quizScores)),a=new CustomEvent("lessonEnd",{detail:i}),window.parent.document.body.dispatchEvent(a),console.log("event dispatched",a)),l=f.User.getCurrentUser())switch(u=l.updateLessonProgress(e.lesson.id,r,this.quizScores,e.lesson.assignmentId),g=0,_=0,e.chapter&&e.chapter.lessons&&e.chapter.lessons.length>0&&(e.chapter.lessons.forEach(function(e){l.lessonProgressMap.has(e.id)&&g++}),_=g/e.chapter.lessons.length),b.ServiceConfig.getI().mode){case b.APIMode.FIREBASE:C={lessonName:e.lesson.name,chapterName:e.chapter.name,chapter:e.chapter.id,lesson:e.lesson.id,courseName:e.course.id,percentComplete:_,timespent:Math.abs(t),assignmentId:e.lesson.assignmentId,assessment:r,kind:"Progress",studentId:f.User.getCurrentUser().id,dateTimeStamp:(new Date).getTime()},(w=parseInt(f.default.getValue(f.CURRENTMODE)))===p.Mode.School||w===p.Mode.HomeConnect?(w===p.Mode.School||l.isConnected)&&y.default.historyProgress(C.chapter,C.chapterName,C.lesson,C.lessonName,f.User.getCurrentUser().id,f.User.getCurrentUser().schoolId,f.User.getCurrentUser().sectionId,C.courseName,""+C.assessment,e.lesson.assignmentId,f.User.getCurrentUser().name,t.toString()):c.Queue.getInstance().push(C);break;case b.APIMode.PARSE:cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID)&&(P={chapter:e.chapter.id,lesson:e.lesson.id,courseName:e.course.id,percentComplete:_,timespent:Math.abs(t),assessment:r,kind:"Progress",schoolId:cc.sys.localStorage.getItem(p.CURRENT_SCHOOL_ID),studentId:cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID),sectionId:cc.sys.localStorage.getItem(p.CURRENT_SECTION_ID),subjectId:cc.sys.localStorage.getItem(p.CURRENT_SUBJECT_ID)},c.Queue.getInstance().push(P))}y.default.logChimpleEvent("lessonEnd",{lessonSessionId:this.lessonSessionId,chapterName:e.chapter.name,chapterId:e.chapter.id,lessonName:e.lesson.name,lessonId:e.lesson.id,courseName:e.course.id,lessonType:e.lesson.type,score:r,timeSpent:Math.abs(t),skills:e.lesson.skills&&e.lesson.skills.length>0?e.lesson.skills.join(","):"",attempts:l&&l.lessonProgressMap.get(e.lesson.id)?l.lessonProgressMap.get(e.lesson.id).attempts:1,assignmentId:e.lesson.assignmentId,mlStudentId:e.lesson.mlStudentId,mlClassId:e.lesson.mlClassId,mlPartnerId:e.lesson.mlPartnerId}),s.label=1;case 1:return s.trys.push([1,4,,5]),"true"!==e.microLinkData.webclass||null==e.lesson.assignmentId?[3,3]:(cc.log("config.microLinkData.isprod ",e.microLinkData.test),cc.log("config.microLinkData.isprod ",e.microLinkData),O={url:"true"==e.microLinkData.test?S.WEBCLASS_HISTORICAL_PROGRESS_URL_TEST:S.WEBCLASS_HISTORICAL_PROGRESS_URL_PROD,body:{lessonId:e.lesson.id,chapterId:e.chapter.id,lessonName:e.lesson.name,chapterName:e.chapter.name,assignmentId:e.lesson.assignmentId,score:r,sectionId:e.lesson.mlClassId,subjectCode:e.course.id}},[4,E.ParseNetwork.getInstance().post(O,I.FirebaseApi.getInstance().getAuthHeader())]);case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:return A=s.sent(),cc.log("WEBCLASS_HISTORICAL_PROGRESS_URL Lamda function failed to call:",A),[3,5];case 5:return R=cc.instantiate(this.blockPrefab),this.node.addChild(R),N=cc.instantiate(this.scorecardPrefab),(T=N.getComponent(v.default)).score=r,T.text=e.lesson.name,T.reward=u,!d.default.isMicroLink||cc.sys.isNative||o||(T.continueButton.active=!1),n.friend.node.removeFromParent(),this.node.addChild(N),(L=h.GAME_CONFIGS[e.game])&&L.fontName&&e.releaseFont(e.currentFontName),e.game=null,[2]}})})},t.prototype.setupEventHandlers=function(){var e=this,t=this.backButton.getComponent(cc.Animation);this.gameNode.on("nextProblem",function(t){void 0===t&&(t=!0),e.problemEnd(t,!0)}),this.gameNode.on("prevProblem",function(t){void 0===t&&(t=!0),e.problemEnd(t,!1)}),this.gameNode.on("correct",function(){e.rightMoves++,e.tempWrongMoves=0,t.stop("icon_highlight"),n.friend.speak(e.correctAudio,null,!0,"happy")}),this.gameNode.on("wrong",function(){e.wrongMoves++,e.tempWrongMoves++,e.tempWrongMoves>1&&t.play("icon_highlight"),n.friend.speak(e.wrongAudio,null,!0,"sad")}),this.gameNode.on(_.QUIZ_ANSWERED,function(t){t?(cc.log("QUIZ_ANSWERED correctly"),e.isQuizAnsweredCorrectly=!0,e.quizScore++):(cc.log("QUIZ_ANSWERED wrongly"),e.isQuizAnsweredCorrectly=!1)})},t.prototype.onDisable=function(){if(!this.isQuizCompleted&&!this.isGameCompleted){var e=Math.ceil(((new Date).getTime()-this.problemStartTime)/1e3),t=this.isQuiz?"quizIncomplete":"gameIncomplete",n=d.default.i;y.default.logChimpleEvent(t,{gameName:n.game,totalGames:n.totalProblems,currentGameNumber:n.problem,lessonSessionId:this.lessonSessionId,problemSessionId:this.problemSessionId,chapterName:n.chapter.name,chapterId:n.chapter.id,lessonName:n.lesson.name,lessonId:n.lesson.id,courseName:n.course.id,problemNo:n.problem,timeSpent:Math.abs(e),wrongMoves:this.wrongMoves,correctMoves:this.rightMoves,skills:n.lesson.skills&&n.lesson.skills.length>0?n.lesson.skills.join(","):"",mlStudentId:n.lesson.mlStudentId,mlClassId:n.lesson.mlClassId,mlPartnerId:n.lesson.mlPartnerId,assignmentId:n.lesson.assignmentId,game_completed:this.isGameCompleted,quiz_completed:this.isQuizCompleted})}},t.getFriend=function(){return n.friend},t.prototype.onClickHelpVideoButton=function(){y.default.launchYoutube(h.GAME_CONFIGS[d.default.i.game].youtube)},t.bundles=[],t.friend=null,i([P(cc.Prefab)],t.prototype,"progressMonitor",void 0),i([P(cc.AudioClip)],t.prototype,"correctAudio",void 0),i([P(cc.AudioClip)],t.prototype,"wrongAudio",void 0),i([P(cc.AudioClip)],t.prototype,"startAudio",void 0),i([P(cc.Prefab)],t.prototype,"scorecardPrefab",void 0),i([P(cc.Prefab)],t.prototype,"blockPrefab",void 0),i([P(cc.Node)],t.prototype,"gameParent",void 0),i([P(cc.Node)],t.prototype,"loading",void 0),i([P(cc.Node)],t.prototype,"backButton",void 0),n=i([w],t)}(cc.Component);n.default=O,cc._RF.pop()},{"../../queue":"queue","../scorecard/scripts/scorecard":"scorecard","./domain/parseConstants":"parseConstants","./friend":"friend","./game":"game","./lib/config":"config","./lib/constants":"constants","./lib/gameConfigs":"gameConfigs","./lib/profile":"profile","./progressMonitor":"progressMonitor","./quiz-monitor":"quiz-monitor","./services/FirebaseApi":"FirebaseApi","./services/ParseNetwork":"ParseNetwork","./services/ServiceConfig":"ServiceConfig","./util":"util","./util-logger":"util-logger"}],lessonIcon:[function(e,t,n){"use strict";cc._RF.push(t,"7407aPuuqZI0qdT3Wu96Q1l","lessonIcon");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.LESSON_BG_COLORS=void 0;var a=e("./util"),s=e("./lib/profile"),c=cc._decorator,l=c.ccclass,u=c.property;n.LESSON_BG_COLORS=["#72DDD3","#FC8E83","#B8D855","#D48FF9","#F98AC9"];var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.open=!1,t}return o(t,e),t.prototype.onLoad=function(){var e=this,t=this.sprite.spriteFrame;if(this.sprite.spriteFrame=new cc.SpriteFrame,a.Util.load(this.lesson.chapter.course.id+"/course/res/icons/"+this.lesson.image,function(n,r){e.sprite&&(e.sprite.spriteFrame=n?t:new cc.SpriteFrame(r))}),this.open){var r=s.User.getCurrentUser().lessonProgressMap.get(this.lesson.id);if(1!=s.User.getCurrentUser().debug)try{r.score<0&&this.getComponent(cc.Animation).play("lesson_highlight")}catch(o){this.getComponent(cc.Animation).play("lesson_highlight")}this.bg.color=(new cc.Color).fromHEX(this.lesson.color?this.lesson.color:n.LESSON_BG_COLORS[Math.floor(Math.random()*n.LESSON_BG_COLORS.length)])}else this.sprite.setMaterial(0,this.grayMaterial),this.bg.color=new cc.Color(224,224,224)},i([u(cc.Sprite)],t.prototype,"sprite",void 0),i([u(cc.Node)],t.prototype,"bg",void 0),i([u(cc.Material)],t.prototype,"grayMaterial",void 0),i([l],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./lib/profile":"profile","./util":"util"}],loading:[function(e,t,n){"use strict";cc._RF.push(t,"95aebuS+FpPyYalDcbBPw4a","loading");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.block=null,t.animationPrefab=null,t.animation=null,t.messageLabel=null,t.cancelBtn=null,t.allowCancel=!1,t.animate=!0,t}return o(t,e),t.prototype.onLoad=function(){this.node.width=cc.winSize.width},t.prototype.start=function(){this.showLoading()},t.prototype.onEnable=function(){this.showLoading()},t.prototype.showLoading=function(){this.block.opacity=0,this.animation.active=!1,this.messageLabel.string="",this.messageLabel.node.active=!1,this.cancelBtn.active=!1,this.cancelBtn.active=!1,this.messageLabel.node.active=!0,this.block.color=cc.Color.GRAY,this.block.opacity=128,this.animate&&(this.animation.active=!0)},t.prototype.addMessage=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),this.messageLabel.string=n?e:this.messageLabel.string+"\n"+e,t&&(this.animation.active=!1,this.cancelBtn.active=!0)},t.prototype.onCancel=function(){this.node.active=!1},i([c(cc.Node)],t.prototype,"block",void 0),i([c(cc.Prefab)],t.prototype,"animationPrefab",void 0),i([c(cc.Node)],t.prototype,"animation",void 0),i([c(cc.Label)],t.prototype,"messageLabel",void 0),i([c(cc.Node)],t.prototype,"cancelBtn",void 0),i([c(Boolean)],t.prototype,"allowCancel",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],nest:[function(e,t,n){"use strict";cc._RF.push(t,"7d6ccHPU2dK8pv4dYNNSQ+I","nest");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./lib/config"),s=e("./util"),c=e("./lib/profile"),l=cc._decorator,u=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chimp=null,t.blockPrefab=null,t.homeButton=null,t.backButton=null,t.settingsButton=null,t.soundEnable=null,t.soundDisable=null,t.backButtonAudio=null,t.isOpen=!1,t.isTrasitioning=!1,t.numClicks=0,t.gameNode=null,t}return o(t,e),t.prototype.onLoad=function(){if(this.node.zIndex=4,this.setSfxButton(),a.default.getInstance().flow==a.Flow.Debug){var e=new cc.Node;e.addComponent(cc.Label),e.y=48,this.node.addChild(e)}},t.prototype.onDisable=function(){this.chimp.active=!0},t.prototype.onSettingsClicked=function(){if(!this.isTrasitioning){this.isTrasitioning=!0;var e=0==c.default.getItem(c.SFX_OFF);c.default.setItem(c.SFX_OFF,e?1:0),e&&cc.audioEngine.stopMusic(),this.setSfxButton(),this.goBack()}},t.prototype.setSfxButton=function(){this.settingsButton.getComponent(cc.Sprite).spriteFrame=0==c.default.getItem(c.SFX_OFF)?this.soundEnable:this.soundDisable},t.prototype.onButtonClick=function(){var e=this;if(!this.isTrasitioning)if(this.isTrasitioning=!0,this.isOpen)this.goBack();else{this.isOpen=!0;var t=cc.instantiate(this.blockPrefab);t.getComponent(cc.Widget).target=cc.director.getScene(),t.on("touchstart",this.onButtonClick,this),this.node.insertChild(t,0),a.default.getInstance().canPop&&(new cc.Tween).target(this.backButton).to(.5,{x:-300},{progress:null,easing:"elasticOut"}).start(),(new cc.Tween).target(this.settingsButton).to(.5,{x:-200},{progress:null,easing:"elasticOut"}).call(function(){cc.director.pause(),e.isTrasitioning=!1}).start()}},t.prototype.onBackClick=function(){var e=this;this.isTrasitioning||(this.isTrasitioning=!0,this.goBack(function(){s.Util.playSfx(e.backButtonAudio),e.homeButton.interactable=!1,a.default.getInstance().popScene()}))},t.prototype.goBack=function(e){var t=this;void 0===e&&(e=null),cc.director.resume(),(new cc.Tween).target(this.backButton).to(.5,{x:0},{progress:null,easing:"elasticIn"}).call(function(){t.node.removeChild(t.node.children[0]),t.isOpen=!1,t.isTrasitioning=!1,null!=e&&e()}).start(),(new cc.Tween).target(this.settingsButton).to(.5,{x:0},{progress:null,easing:"elasticIn"}).call(function(){}).start()},i([d(cc.Node)],t.prototype,"chimp",void 0),i([d(cc.Prefab)],t.prototype,"blockPrefab",void 0),i([d(cc.Button)],t.prototype,"homeButton",void 0),i([d(cc.Node)],t.prototype,"backButton",void 0),i([d(cc.Node)],t.prototype,"settingsButton",void 0),i([d(cc.SpriteFrame)],t.prototype,"soundEnable",void 0),i([d(cc.SpriteFrame)],t.prototype,"soundDisable",void 0),i([d({type:cc.AudioClip})],t.prototype,"backButtonAudio",void 0),i([u],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./lib/config":"config","./lib/profile":"profile","./util":"util"}],"number-script":[function(e,t,n){"use strict";cc._RF.push(t,"d188cem8MZKo4EZw1jZ/0t0","number-script");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("./lib/error-handler"),l=e("./answer-grid"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.normalLabelColor="",t.pressedLabelColor="",t}return o(t,e),t.prototype.onLoad=function(){},t.prototype.onButtonClick=function(e){var t=e.target.getChildByName(l.BACK_GROUND);if(t){var n=t.getChildByName(l.NUMBER_LABEL),r=n.getComponent(cc.Label);n.addComponent(cc.LabelOutline).width=2;var o=new cc.Event.EventCustom(l.ANSWER_GRID_BUTTON_CLICKED,!0);o.setUserData({selectedDigit:r.string}),this.node.dispatchEvent(o)}},i([s],t.prototype,"normalLabelColor",void 0),i([s],t.prototype,"pressedLabelColor",void 0),i([c.default()],t.prototype,"onButtonClick",null),i([a],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./answer-grid":"answer-grid","./lib/error-handler":"error-handler"}],parseACL:[function(e,t,n){"use strict";cc._RF.push(t,"cf983q0+mVH+61RSwOZxCBw","parseACL"),Object.defineProperty(n,"__esModule",{value:!0}),n.ReadWriteACL=n.ParseACL=void 0;n.ParseACL=function(){};n.ReadWriteACL=function(){},cc._RF.pop()},{}],parseApi:[function(e,t,n){"use strict";cc._RF.push(t,"2f3b4FOtDhA+6YMUhF2+Mai","parseApi");var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ParseApi=n.SelectionMode=void 0;var i=e("../domain/parseUser"),a=e("./ParseNetwork"),s=e("../domain/parseConstants"),c=e("../lib/constants"),l=e("../domain/parseConnection"),u=e("../domain/parseSchool"),d=e("../domain/parseChapterAssignment"),p=e("../domain/parseSubject"),h=e("../domain/parseSection"),f=e("../domain/parseStudent"),g=e("../domain/parseClass"),_=e("../domain/parseMonitor"),m=e("../lib/profile"),y=e("../domain/parseAssignmentForChapter"),v=e("../domain/parseTeachersForStudent"),b=e("../domain/parseChapterProgress"),E=e("../domain/parseAssignment"),S=e("../../../queue");(function(e){e[e.Home=0]="Home",e[e.Section=1]="Section",e[e.Student=2]="Student",e[e.Subject=3]="Subject",e[e.TeacherHome=4]="TeacherHome"})(n.SelectionMode||(n.SelectionMode={}));var I=function(){function e(){}return e.prototype.teacherRequestAccepted=function(t){return r(this,void 0,Promise,function(){var n,r;return o(this,function(o){switch(o.label){case 0:return[4,e.getInstance().schoolById(t.teacherId)];case 1:return n=o.sent(),r={homeId:t.studentId,teacherId:n.user.objectId,kind:"UpdateHomeTeacher",studentName:t.studentName,schoolId:n.objectId,sectionId:t.sectionId},S.Queue.getInstance().push(r),[2,!0]}})})},e.prototype.getAuthHeader=function(){var t=e.getInstance().getLoggedInUser(),n={"X-Parse-Application-Id":s.APPLICATION_ID,"X-Parse-REST-API-Key":s.PARSE_REST_API_KEY,Accept:"application/json"};return t&&t.sessionToken&&(n["x-parse-session-token"]=t.sessionToken),{ignoreCache:!1,headers:n,timeout:s.DEFAULT_TIMEOUT}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.login=function(t,n){return r(this,void 0,Promise,function(){var r;return o(this,function(o){switch(o.label){case 0:return r={url:s.LOGIN_URL,queryParams:{username:t,password:n}},[4,a.ParseNetwork.getInstance().get(r,c.LOGGED_IN_USER,this.getAuthHeader())];case 1:return o.sent(),[2,e.instance.getLoggedInUser()]}})})},e.prototype.loginUser=function(t,n){return r(this,void 0,Promise,function(){return o(this,function(){return[2,e.instance.login(t,n)]})})},e.prototype.registerUser=function(e,t){return r(this,void 0,Promise,function(){var n,r;return o(this,function(o){switch(o.label){case 0:return(n=new i.ParseUser).email=e,n.username=e,n.password=t,r={url:s.USER_URL,body:n},[4,a.ParseNetwork.getInstance().post(r,this.getAuthHeader())];case 1:return[2,o.sent()]}})})},e.prototype.isUserExists=function(e){return r(this,void 0,Promise,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return t={url:s.USER_URL,queryParams:{username:e},isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(t,e,this.getAuthHeader())];case 1:return[2,!!((n=r.sent())&&Array.isArray(n)&&n.length>0)]}})})},e.prototype.getLoggedInUser=function(){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(c.LOGGED_IN_USER),i.ParseUser)},e.prototype.logout=function(){a.ParseNetwork.getInstance().removeFromCache(c.LOGGED_IN_USER),a.ParseNetwork.getInstance().removeFromCache(s.LOGIN_TYPE)},e.prototype.connections=function(){return r(this,void 0,Promise,function(){var t,n,r;return o(this,function(o){switch(o.label){case 0:return t=e.instance.getLoggedInUser(),n={user:a.ParseNetwork.getInstance().createPointer("_User",t.objectId)},r={url:s.CONNECTION_URL,queryParams:n,isWhereQuery:!0,includeParam:"school,school.user"},[4,a.ParseNetwork.getInstance().get(r,s.CURRENT_CONNECTION,this.getAuthHeader())];case 1:return o.sent(),[2,e.instance.selectedConnections()]}})})},e.prototype.schoolForTeacher=function(){return r(this,void 0,Promise,function(){var t,n,r;return o(this,function(o){switch(o.label){case 0:return t=e.instance.getLoggedInUser(),n={user:a.ParseNetwork.getInstance().createPointer("_User",t.objectId)},r={url:s.SCHOOL_URL,queryParams:n,isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(r,s.CURRENT_TEACHER_SCHOOL,this.getAuthHeader())];case 1:return o.sent(),[2,e.instance.selectedSchool(s.CURRENT_TEACHER_SCHOOL)]}})})},e.prototype.schoolById=function(t){return r(this,void 0,Promise,function(){var n;return o(this,function(r){switch(r.label){case 0:return n={url:s.SCHOOL_URL+"/"+t},[4,a.ParseNetwork.getInstance().get(n,t,this.getAuthHeader())];case 1:return r.sent(),[2,e.instance.selectedSchool(t)]}})})},e.prototype.getChapterAssignment=function(t,n,i){return r(this,void 0,Promise,function(){var r,c,l;return o(this,function(o){switch(o.label){case 0:return r=s.CHAPTER_ASSIGNMENT+t+n+i,c={school:a.ParseNetwork.getInstance().createPointer("School",t),subject:a.ParseNetwork.getInstance().createPointer("Subject",i),section:a.ParseNetwork.getInstance().createPointer("Section",n)},l={url:s.CHAPTER_ASSIGNMENT_URL,queryParams:c,isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(l,r,this.getAuthHeader())];case 1:return o.sent(),[2,e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(r),d.ParseChapterAssignment,!1)]}})})},e.prototype.selectedConnections=function(){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.CURRENT_CONNECTION),l.ParseConnection,!1)},e.prototype.selectedSchool=function(t){var n=e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(t),u.ParseSchool,!1);return Array.isArray(n)&&n.length>0?n[0]:n},e.prototype.getAllSubjects=function(){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return t={url:s.SUBJECT_URL},[4,a.ParseNetwork.getInstance().get(t,s.SUBJECTS,this.getAuthHeader())];case 1:return n.sent(),[2,e.instance.allSubjects()]}})})},e.prototype.getSectionsForSchool=function(t){return r(this,void 0,Promise,function(){var n,r;return o(this,function(o){switch(o.label){case 0:return n={school:a.ParseNetwork.getInstance().createPointer("School",t)},r={url:s.SECTION_URL,queryParams:n,isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(r,s.SECTIONS+t,this.getAuthHeader())];case 1:return o.sent(),[2,e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.SECTIONS+t),h.ParseSection,!1)]}})})},e.prototype.getStudentsForTeacher=function(){return r(this,void 0,Promise,function(){var t,n,r;return o(this,function(o){switch(o.label){case 0:return t=e.instance.getLoggedInUser(),[],n={teacher:a.ParseNetwork.getInstance().createPointer("_User",t.objectId)},r={url:s.TUITION_URL,queryParams:n,isWhereQuery:!0,includeParam:"student",keysParam:"student"},[4,a.ParseNetwork.getInstance().get(r,s.STUDENTS_FOR_TEACHER+t.objectId,this.getAuthHeader())];case 1:return[2,(o.sent()||[]).map(function(e){return{name:e.student.name,objectId:e.student.objectId,image:e.student.image?e.student.image.url:""}})]}})})},e.prototype.getProgressForChapter=function(e){return r(this,void 0,Promise,function(){var t,n,r,i,c;return o(this,function(o){switch(o.label){case 0:return t=[],e.studentInfos?(r=e.studentInfos.map(function(e){return{student:a.ParseNetwork.getInstance().createPointer("Student",e)}}),null,i=e.subjectId?{chapter:e.chapterId,max:!0,subject:a.ParseNetwork.getInstance().createPointer("Subject",e.subjectId),$or:r}:{chapter:e.chapterId,max:!0,$or:r},c={url:s.PROGRESS_URL,queryParams:i,isWhereQuery:!0,includeParam:"student",keysParam:"student,lesson,assessment,timeSpent"},[4,a.ParseNetwork.getInstance().get(c,null,this.getAuthHeader())]):[3,2];case 1:t=o.sent()||[],n=t.map(function(e){return{objectId:e.student.objectId,lesson:e.lesson,assessment:e.assessment,timeSpent:e.timeSpent,studentName:e.student.name}}),cc.log("result",n),o.label=2;case 2:return[2,n]}})})},e.prototype.getProgressForStudentByChapterAndLesson=function(t,n){return r(this,void 0,Promise,function(){var r,i,l,u,d,p,h,f;return o(this,function(o){switch(o.label){case 0:return r=cc.sys.localStorage.getItem(c.CURRENT_SCHOOL_ID),i=cc.sys.localStorage.getItem(c.CURRENT_SECTION_ID),[4,e.getInstance().getStudentsForSection(r,i)];case 1:return l=o.sent(),u=[],p=l.map(function(e){return{student:a.ParseNetwork.getInstance().createPointer("Student",e.objectId)}}),h={chapter:t,lesson:n,max:!0,$or:p},f={url:s.PROGRESS_URL,queryParams:h,isWhereQuery:!0,includeParam:"student",keysParam:"student,lesson,assessment,timeSpent"},[4,a.ParseNetwork.getInstance().get(f,null,this.getAuthHeader())];case 2:return u=o.sent()||[],d=u.map(function(e){return{objectId:e.student.objectId,lesson:e.lesson,assessment:e.assessment,timeSpent:e.timeSpent,studentName:e.student.name}}),cc.log("result",d),[2,d]}})})},e.prototype.selectedSection=function(t){var n=e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.SECTIONS+t),h.ParseSection,!1),r=a.ParseNetwork.getInstance().getStringFromCache(c.CURRENT_SECTION_ID);return n.filter(function(e){return e.objectId===r})},e.prototype.allSubjects=function(){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.SUBJECTS),p.ParseSubject,!1)},e.prototype.selectedClasses=function(t){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.CLASSES+t),g.ParseClass,!1)},e.prototype.getStudentsForSection=function(t,n){return r(this,void 0,Promise,function(){var r,i;return o(this,function(o){switch(o.label){case 0:return r=[],i={url:s.SCHOOL_STUDENT_URL,queryParams:{school:a.ParseNetwork.getInstance().createPointer("School",t),section:a.ParseNetwork.getInstance().createPointer("Section",n)},isWhereQuery:!0,includeParam:"student"},[4,a.ParseNetwork.getInstance().get(i,s.STUDENTS+t+n,this.getAuthHeader())];case 1:return r=(r=o.sent()||[]).map(function(e){return e.student}),[2,e.instance.fromJson(r,f.ParseStudent,!1)]}})})},e.prototype.selectedStudents=function(t,n){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.STUDENTS+t+n),f.ParseStudent,!1)},e.prototype.getActiveClassesForSchoolAndSection=function(t,n){return void 0===n&&(n=null),r(this,void 0,Promise,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:return n={school:a.ParseNetwork.getInstance().createPointer("School",t),active:!0},r={url:s.CLASS_URL,queryParams:n,isWhereQuery:!0,includeParam:"subject,teacher"},[4,a.ParseNetwork.getInstance().get(r,s.CLASSES+t,this.getAuthHeader())];case 1:return o.sent(),i=e.instance.selectedClasses(t),cc.log("classes",i),i.map(function(t){var n={subject:t.subject,teacher:t.teacher,classId:t.objectId};e.instance.storeSubjectAndTeacherByClass(t.objectId,n)}),[2,i]}})})},e.prototype.storeSubjectAndTeacherByClass=function(e,t){a.ParseNetwork.getInstance().storeIntoCache(s.SUBJECT+e,t.subject),a.ParseNetwork.getInstance().storeIntoCache(s.TEACHER+e,t.teacher)},e.prototype.getSubjectByClass=function(t){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.SUBJECT+t),p.ParseSubject)},e.prototype.getTeacherByClass=function(t){return e.instance.fromJson(a.ParseNetwork.getInstance().getParseObjectFromCache(s.TEACHER+t),i.ParseUser)},e.prototype.fromJson=function(e,t,n){void 0===n&&(n=!0);var r=null;if(null==e)r=n?Object.assign({}):Object.assign([]);else if(e&&Array.isArray(e))r=e.map(function(e){var n=new t;return Object.assign(n,e)});else if(e){var o=new t;r=Object.assign(o,e)}return r},e.prototype.asyncForEach=function(e,t){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<e.length?[4,t(e[n],n,e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.convertDataURIToBinary=function(e){for(var t=e.indexOf(";base64,")+";base64,".length,n=e.substring(t),r=window.atob(n),o=r.length,i=new Uint8Array(new ArrayBuffer(o)),a=0;a<o;a++)i[a]=r.charCodeAt(a);return i},e.prototype.findOrCreateMonitor=function(t,n,i,l,u){return r(this,void 0,void 0,function(){var r;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,4,5]),[4,e.instance.getMonitorBySchoolAndStudentAndClass(t,n,i)];case 1:return o.sent()?[2]:[4,e.instance.createMonitor(t,n,i)];case 2:return o.sent(),[3,5];case 3:return r=o.sent(),cc.log(r),[3,5];case 4:return a.ParseNetwork.getInstance().storeIntoCache(c.CURRENT_CLASS_ID,i),a.ParseNetwork.getInstance().storeIntoCache(s.CURRENT_SUBJECT_NAME,l),a.ParseNetwork.getInstance().storeIntoCache(c.CURRENT_SUBJECT_ID,u),[7];case 5:return[2]}})})},e.prototype.buildAndLoginUser=function(t){return r(this,void 0,void 0,function(){var n,r,i,c,l;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=a.ParseNetwork.getInstance().getStringFromCache(s.SCHOOL_CODE),r=a.ParseNetwork.getInstance().getStringFromCache(s.SCHOOL_PASSWORD),[4,e.instance.login(n,r)];case 1:return o.sent(),i=t.gender?"male"===t.gender.toLowerCase()?m.Gender.BOY:m.Gender.GIRL:m.Gender.UNKNOWN,c=m.User.createUserOrFindExistingUser({id:t.objectId,name:t.name,age:t.age,gender:i,imgPath:t.image?t.image.url:""}),m.User.setCurrentUser(c),m.default.fromJsonUsingParse(t.profile),[3,3];case 2:return l=o.sent(),cc.log(l),[3,3];case 3:return[2]}})})},e.prototype.createMonitor=function(t,n,i){return r(this,void 0,Promise,function(){var r,c;return o(this,function(o){switch(o.label){case 0:return(r=new _.ParseMonitor).school=e.instance.createPointer("School",t),r.student=e.instance.createPointer("Student",n),r.class=e.instance.createPointer("Class",i),r.activity="school-class",c={url:s.MONITOR_URL,body:r},[4,a.ParseNetwork.getInstance().post(c,this.getAuthHeader())];case 1:return o.sent(),[2]}})})},e.prototype.signUpUser=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.username&&e.password&&e.email&&e.fullName?(t={url:s.SIGN_UP_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.signUpTestUser=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.username&&e.phoneNumber&&e.verficationId&&e.code&&e.password?(t={url:s.SIGN_UP_TEST_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.listAssignments=function(e,t){return void 0===t&&(t=10),r(this,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:return n=[],r={url:s.LIST_ASSIGNMENTS,body:{studentId:e,limit:t}},[4,a.ParseNetwork.getInstance().post(r,this.getAuthHeader())];case 1:return(i=o.sent())&&i.data&&i.data.result&&(this.buildAssignments(n,i.data.result.myAssignments),this.buildAssignments(n,i.data.result.allAssignments)),[2,n]}})})},e.prototype.buildAssignments=function(e,t){var n=m.User.getCurrentUser().lessonProgressMap;return t.forEach(function(t){t.forEach(function(t){var r={},o=!0;r.chapterId=t.chapter,r.lessonId=t.lesson,r.courseCode=t.subject.courseCode,r.createAt=new Date(t.createAt),n.has(t.lesson)&&(o=m.User.getCurrentUser().lessonProgressMap.get(t.lesson).date.getTime()<r.createAt.getTime()),o&&e.push(r)})}),e=e.filter(function(e,t,n){return n.findIndex(function(t){return t.chapterId===e.chapterId&&t.lessonId===e.lessonId})===t})},e.prototype.updateProgress=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.studentId&&e.studentId.length>0?(t={url:s.UPDATE_PROGRESS_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.assignHomeWork=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e?(t={url:s.ASSIGN_HOMEWORK_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.updateMonitor=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.studentId&&e.studentId.length>0?(t={url:s.UPDATE_MONITOR_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.createSection=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return t={url:s.CREATE_SECTION_URL,body:{schoolId:cc.sys.localStorage.getItem(c.CURRENT_SCHOOL_ID),sectionName:e}},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())];case 1:return[2,n.sent()]}})})},e.prototype.removeFromCache=function(e){a.ParseNetwork.getInstance().removeFromCache(e)},e.prototype.updateHomeTeacher=function(e){return r(this,void 0,Promise,function(){var t;return o(this,function(n){switch(n.label){case 0:return e.teacherId&&e.teacherId.length>0&&e.homeId&&e.homeId.length>0?(t={url:s.UPDATE_HOME_TEACHER_URL,body:e},[4,a.ParseNetwork.getInstance().post(t,this.getAuthHeader())]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}})})},e.prototype.updateProfile=function(e){return r(this,void 0,Promise,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return(t=e.studentId)&&t.length>0?(n={url:s.STUDENT_URL+"/"+t,body:{profile:e.profile}},[4,a.ParseNetwork.getInstance().update(n,this.getAuthHeader())]):[3,2];case 1:return[2,r.sent()];case 2:return[2]}})})},e.prototype.getMonitorBySchoolAndStudentAndClass=function(t,n,i){return r(this,void 0,Promise,function(){var r,c,l;return o(this,function(o){switch(o.label){case 0:return r=[],c={url:s.MONITOR_URL,queryParams:{school:a.ParseNetwork.getInstance().createPointer("School",t),student:a.ParseNetwork.getInstance().createPointer("Student",n),class:a.ParseNetwork.getInstance().createPointer("Class",i)},isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(c,null,this.getAuthHeader())];case 1:return r=o.sent(),[2,(l=e.instance.fromJson(r,_.ParseMonitor,!1))&&l.length>0?l[0]:null]}})})},e.prototype.createPointer=function(e,t){return{__type:"Pointer",className:e,objectId:t}},e.prototype.getAssignmentsForChapterForWholeClass=function(t,n){return r(this,void 0,Promise,function(){var r,i,c;return o(this,function(o){switch(o.label){case 0:return r=s.ASSIGNMENTS_FOR_CHAPTER+t+n,i=[],c={url:s.ASSIGNMENTS_API_URL,queryParams:{school:a.ParseNetwork.getInstance().createPointer("School",t),student:null,chapter:n},isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(c,r,this.getAuthHeader())];case 1:return i=o.sent(),[2,e.instance.fromJson(i,y.ParseAssignmentForChapter,!1)]}})})},e.prototype.getAssignmentsForStudentsByChapterAndLesson=function(t,n,i,c,l){return r(this,void 0,Promise,function(){var r,u,d;return o(this,function(o){switch(o.label){case 0:return r=[],u=l.map(function(e){return{student:a.ParseNetwork.getInstance().createPointer("Student",e.objectId)}}),d={url:s.ASSIGNMENTS_API_URL,queryParams:{school:a.ParseNetwork.getInstance().createPointer("School",t),section:a.ParseNetwork.getInstance().createPointer("Section",n),chapter:i,lesson:c,$or:u},isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(d,null,this.getAuthHeader())];case 1:return r=o.sent(),[2,e.instance.fromJson(r,y.ParseAssignmentForChapter,!1)]}})})},e.prototype.getTeachers=function(e){return r(this,void 0,Promise,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.getTeachersByStudent(e)];case 1:return[2,t.sent().map(function(e){return e.school.user.fullName})]}})})},e.prototype.getChapterProgressByStudent=function(t){return r(this,void 0,Promise,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:return n=s.CHAPTER_PROGRESS+t,r=[],i={url:s.CHAPTER_PROGRESS_URL,queryParams:{student:a.ParseNetwork.getInstance().createPointer("Student",t)},isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(i,n,this.getAuthHeader())];case 1:return r=o.sent(),[2,e.instance.fromJson(r,b.ParseChapterProgress,!1)]}})})},e.prototype.getTeachersByStudent=function(t){return r(this,void 0,Promise,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:return n=s.TEACHERS_FOR_STUDENT+t,r=[],i={url:s.SCHOOL_STUDENT_URL,queryParams:{student:a.ParseNetwork.getInstance().createPointer("Student",t)},isWhereQuery:!0,includeParam:"school.user"},[4,a.ParseNetwork.getInstance().get(i,n,this.getAuthHeader())];case 1:return r=o.sent(),[2,e.instance.fromJson(r,v.ParseTeachersForStudent,!1)]}})})},e.prototype.getAssignments=function(t,n){return r(this,void 0,Promise,function(){var r,i,c,l,u,d;return o(this,function(o){switch(o.label){case 0:r=s.ASSIGNMENTS+t+n,(i=new E.ParseAssignment).schoolId=t,i.sectionId=n,i.assignments=[],i.students=[],o.label=1;case 1:return o.trys.push([1,3,,4]),c=void 0,l={url:s.ASSIGNMENTS_URL,body:{schoolId:t,sectionId:n}},[4,a.ParseNetwork.getInstance().post(l,this.getAuthHeader())];case 2:return(c=o.sent())&&c.data&&c.data.result?(u=c.data.result.progressResults||[],d=c.data.result.students||[],i.students=d.map(function(e){return{name:e.student.name,studentId:e.student.objectId}}),i.assignments=u.map(function(e){var t={};return i.assignments.push(t),t.chapter=e.chapter,t.subject=e.subject.courseCode,t.lesson=e.lesson,t.studentAssessments=[],e.progressInfo&&e.progressInfo.length>0&&e.progressInfo.forEach(function(e){t.studentAssessments.push({studentId:e.pStudent.objectId,assessment:e.assessment})}),t}),a.ParseNetwork.getInstance().storeIntoCache(r,i),[2,e.instance.fromJson(i,E.ParseAssignment,!0)]):[3,4];case 3:return o.sent(),[2,i];case 4:return[2]}})})},e.prototype.getLearningSummary=function(e){return r(this,void 0,Promise,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:return t=e.map(function(e){return{student:a.ParseNetwork.getInstance().createPointer("Student",e)}}),n=[],r={$or:t},i={url:s.LEARNING_SUMMARY_URL,queryParams:r,isWhereQuery:!0},[4,a.ParseNetwork.getInstance().get(i,null,this.getAuthHeader())];case 1:return(o.sent()||[]).forEach(function(e){n.push({studentId:e.student.objectId,totalTime:e.totalTime,totalLessons:e.totalLessons})}),cc.log("result",n),[2,n]}})})},e.prototype.linkStudent=function(){return r(this,void 0,Promise,function(){return o(this,function(){return[2,null]})})},e.prototype.syncFailedProgresses=function(){return r(this,void 0,Promise,function(){return o(this,function(){return[2,null]})})},e.prototype.getLeaderboard=function(){return r(this,void 0,Promise,function(){return o(this,function(){return[2,null]})})},e.prototype.customAuth=function(){return r(this,void 0,Promise,function(){return o(this,function(){return[2,null]})})},e}();n.ParseApi=I,cc._RF.pop()},{"../../../queue":"queue","../domain/parseAssignment":"parseAssignment","../domain/parseAssignmentForChapter":"parseAssignmentForChapter","../domain/parseChapterAssignment":"parseChapterAssignment","../domain/parseChapterProgress":"parseChapterProgress","../domain/parseClass":"parseClass","../domain/parseConnection":"parseConnection","../domain/parseConstants":"parseConstants","../domain/parseMonitor":"parseMonitor","../domain/parseSchool":"parseSchool","../domain/parseSection":"parseSection","../domain/parseStudent":"parseStudent","../domain/parseSubject":"parseSubject","../domain/parseTeachersForStudent":"parseTeachersForStudent","../domain/parseUser":"parseUser","../lib/constants":"constants","../lib/profile":"profile","./ParseNetwork":"ParseNetwork"}],parseAssignmentForChapter:[function(e,t,n){"use strict";cc._RF.push(t,"3dc3dMpA/VAUIpW71YMnW5V","parseAssignmentForChapter"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseAssignmentForChapter=void 0;n.ParseAssignmentForChapter=function(){},cc._RF.pop()},{}],parseAssignment:[function(e,t,n){"use strict";cc._RF.push(t,"44306Au2r1DaJ5mZ4psO148","parseAssignment"),Object.defineProperty(n,"__esModule",{value:!0}),n.StudentAssessment=n.Result=n.Student=n.ParseAssignment=void 0;n.ParseAssignment=function(){};n.Student=function(){};n.Result=function(){};n.StudentAssessment=function(){},cc._RF.pop()},{}],parseChapterAssignment:[function(e,t,n){"use strict";cc._RF.push(t,"9d910HI50lGMZpnNTfVJ5YO","parseChapterAssignment"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseChapterAssignment=void 0;n.ParseChapterAssignment=function(){},cc._RF.pop()},{}],parseChapterProgress:[function(e,t,n){"use strict";cc._RF.push(t,"1b613TbD3pJAJsRpf5/lx7V","parseChapterProgress"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseChapterProgress=void 0;n.ParseChapterProgress=function(){},cc._RF.pop()},{}],parseChapter:[function(e,t,n){"use strict";cc._RF.push(t,"0e4c5JAtXJCY6A9EsSGR85e","parseChapter"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseChapter=void 0;n.ParseChapter=function(){},cc._RF.pop()},{}],parseClass:[function(e,t,n){"use strict";cc._RF.push(t,"1a89e795RNCsZtKwQ1AFQ9R","parseClass"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseClass=void 0;n.ParseClass=function(){},cc._RF.pop()},{}],parseConnection:[function(e,t,n){"use strict";cc._RF.push(t,"352115XVTNLhbSKoWKum1oP","parseConnection"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseConnection=void 0;n.ParseConnection=function(){},cc._RF.pop()},{}],parseConstants:[function(e,t,n){"use strict";cc._RF.push(t,"0457bG92QRKcKcRDWQsqcDr","parseConstants"),Object.defineProperty(n,"__esModule",{value:!0}),n.UPDATE_MONITOR_URL=n.LIST_ASSIGNMENTS=n.SIGN_UP_TEST_URL=n.SIGN_UP_URL=n.ASSIGN_HOMEWORK_URL=n.UPDATE_PROGRESS_URL=n.SCHOOL_STUDENT_URL=n.LEARNING_SUMMARY_URL=n.STUDENT_URL=n.USER_URL=n.MONITOR_URL=n.CLASS_URL=n.SUBJECT_URL=n.SECTION_URL=n.CHAPTER_ASSIGNMENT_URL=n.SCHOOL_URL=n.CONNECTION_URL=n.LOGIN_URL=n.TEACHERS_FOR_STUDENT=n.ASSIGNMENTS_FOR_CHAPTER=n.CURRENT_SUBJECT_NAME=n.STUDENTS_FOR_TEACHER=n.ASSIGNMENTS=n.MONITORS=n.TEACHER=n.SUBJECT=n.CLASSES=n.STUDENTS=n.SUBJECTS=n.SECTIONS=n.SCHOOL_BY_ID=n.CHAPTER_PROGRESS=n.CHAPTER_ASSIGNMENT=n.CURRENT_TEACHER_SCHOOL=n.CURRENT_CONNECTION=n.CURRENT_SELECTED_SCHOOL=n.LOGGED_IN_USER=n.TEACHER_PASSWORD=n.TEACHER_EMAIL=n.SCHOOL_PASSWORD=n.SCHOOL_CODE=n.LOGIN_TYPE=n.LoginType=n.PUT=n.POST=n.GET=n.MINUTE_TIMEOUT=n.DEFAULT_TIMEOUT=n.PARSE_REST_API_KEY=n.APPLICATION_ID=void 0,n.WEBCLASS_HISTORICAL_PROGRESS_URL_TEST=n.WEBCLASS_HISTORICAL_PROGRESS_URL_PROD=n.FIREBASE_CUSTOM_AUTH_URL=n.FIREBASE_GET_LEADERBOARD_URL=n.FIREBASE_LINK_STUDENT_URL=n.FIREBASE_SYNC_FAILED_PROGRESS_URL=n.FIREBASE_UPDATE_PROGRESS_URL=n.FIREBASE_LIST_ASSIGNMENTS=n.FIREBASE_UPDATE_HOME_TEACHER_URL=n.FIREBASE_SCHOOL_URL=n.SYNC_PROGRESS_FAILED=n.UPDATE_PROGRESS_FAILED=n.UPDATE_MONITOR_FAILED=n.ASSIGN_HOMEWORK_FAILED=n.UPDATE_PROFILE_FAILED=n.UPDATE_HOME_TEACHER_FAILED=n.ASSIGN_HOMEWORK=n.UPDATE_HOME_TEACHER=n.UPDATE_PROGRESS=n.UPDATE_MONITOR=n.UPDATE_PROFILE=n.CHAPTER_PROGRESS_URL=n.CREATE_SECTION_URL=n.ASSIGNMENTS_API_URL=n.ASSIGNMENTS_URL=n.PROGRESS_URL=n.TUITION_URL=n.UPDATE_HOME_TEACHER_URL=void 0,n.APPLICATION_ID="x45P2SW2h1UfyDT8F0C9vpKmOGe7eFCnIo33Q2dk",n.PARSE_REST_API_KEY="PIvgGRHCSFYNN9h1qhpHQ9KtEbtbwNbZ2oGknZ3g",n.DEFAULT_TIMEOUT=6e4,n.MINUTE_TIMEOUT=6e4,n.GET="get",n.POST="post",n.PUT="put",function(e){e[e.School=0]="School",e[e.Teacher=1]="Teacher"}(n.LoginType||(n.LoginType={})),n.LOGIN_TYPE="LOGIN_TYPE",n.SCHOOL_CODE="SCHOOL_CODE",n.SCHOOL_PASSWORD="SCHOOL_PASSWORD",n.TEACHER_EMAIL="TEACHER_EMAIL",n.TEACHER_PASSWORD="TEACHER_PASSWORD",n.LOGGED_IN_USER="loggedInUser",n.CURRENT_SELECTED_SCHOOL="selectedSchool",n.CURRENT_CONNECTION="selectedConnection",n.CURRENT_TEACHER_SCHOOL="selectedTeacherSchool",n.CHAPTER_ASSIGNMENT="chapterAssignment",n.CHAPTER_PROGRESS="chapterProgress",n.SCHOOL_BY_ID="schoolById",n.SECTIONS="sections",n.SUBJECTS="subjects",n.STUDENTS="students",n.CLASSES="classes",n.SUBJECT="subject",n.TEACHER="teacher",n.MONITORS="monitors",n.ASSIGNMENTS="assignments",n.STUDENTS_FOR_TEACHER="studentsForTeacher",n.CURRENT_SUBJECT_NAME="CURRENT_SUBJECT_NAME",n.ASSIGNMENTS_FOR_CHAPTER="ASSIGNMENTS_FOR_CHAPTER",n.TEACHERS_FOR_STUDENT="TEACHERS_FOR_STUDENT",n.LOGIN_URL="https://parseapi.back4app.com/login",n.CONNECTION_URL="https://parseapi.back4app.com/classes/Connection",n.SCHOOL_URL="https://parseapi.back4app.com/classes/School",n.CHAPTER_ASSIGNMENT_URL="https://parseapi.back4app.com/classes/ChapterAssignmentStatus",n.SECTION_URL="https://parseapi.back4app.com/classes/Section",n.SUBJECT_URL="https://parseapi.back4app.com/classes/Subject",n.CLASS_URL="https://parseapi.back4app.com/classes/Class",n.MONITOR_URL="https://parseapi.back4app.com/classes/Monitor",n.USER_URL="https://parseapi.back4app.com/users",n.STUDENT_URL="https://parseapi.back4app.com/classes/Student",n.LEARNING_SUMMARY_URL="https://parseapi.back4app.com/classes/LearningSummary",n.SCHOOL_STUDENT_URL="https://parseapi.back4app.com/classes/SchoolStudents",n.UPDATE_PROGRESS_URL="https://parseapi.back4app.com/functions/updateProgress",n.ASSIGN_HOMEWORK_URL="https://parseapi.back4app.com/functions/updateAssignment",n.SIGN_UP_URL="https://parseapi.back4app.com/functions/signUp",n.SIGN_UP_TEST_URL="https://parseapi.back4app.com/functions/signUpTest",n.LIST_ASSIGNMENTS="https://parseapi.back4app.com/functions/listAssignment",n.UPDATE_MONITOR_URL="https://parseapi.back4app.com/functions/updateMonitor",n.UPDATE_HOME_TEACHER_URL="https://parseapi.back4app.com/functions/createStudent",n.TUITION_URL="https://parseapi.back4app.com/classes/Tuition",n.PROGRESS_URL="https://parseapi.back4app.com/classes/Progress",n.ASSIGNMENTS_URL="https://parseapi.back4app.com/functions/assignments",n.ASSIGNMENTS_API_URL="https://parseapi.back4app.com/classes/Assignment",n.CREATE_SECTION_URL="https://parseapi.back4app.com/functions/createSection",n.CHAPTER_PROGRESS_URL="https://parseapi.back4app.com/classes/ChapterProgress",n.UPDATE_PROFILE="update_profile",n.UPDATE_MONITOR="update_monitor",n.UPDATE_PROGRESS="update_progress",n.UPDATE_HOME_TEACHER="update_home_teacher",n.ASSIGN_HOMEWORK="assign_homework",n.UPDATE_HOME_TEACHER_FAILED="update_home_teacher_failed",n.UPDATE_PROFILE_FAILED="update_profile_failed",n.ASSIGN_HOMEWORK_FAILED="assign_homework_failed",n.UPDATE_MONITOR_FAILED="update_monitor_failed",n.UPDATE_PROGRESS_FAILED="update_progress_failed",n.SYNC_PROGRESS_FAILED="sync_progress_failed",n.FIREBASE_SCHOOL_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/getSchool?id=",n.FIREBASE_UPDATE_HOME_TEACHER_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/createStudent",n.FIREBASE_LIST_ASSIGNMENTS="https://us-central1-bahama-stage.cloudfunctions.net/chimple/assignments?studentId=",n.FIREBASE_UPDATE_PROGRESS_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/updateProgressOnHttp",n.FIREBASE_SYNC_FAILED_PROGRESS_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/syncProgressOnHttp",n.FIREBASE_LINK_STUDENT_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/LinkStudent",n.FIREBASE_GET_LEADERBOARD_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/getLeaderboard",n.FIREBASE_CUSTOM_AUTH_URL="https://us-central1-bahama-stage.cloudfunctions.net/chimple/customAuth",n.WEBCLASS_HISTORICAL_PROGRESS_URL_PROD="https://cvjgnzup21.execute-api.ap-south-1.amazonaws.com/webclasshistoricaldata-prod",n.WEBCLASS_HISTORICAL_PROGRESS_URL_TEST="https://cvjgnzup21.execute-api.ap-south-1.amazonaws.com/webclasshistoricaldata-test",cc._RF.pop()},{}],parseMonitor:[function(e,t,n){"use strict";cc._RF.push(t,"1d7c1bWu75IM6h4Qbsbf7XZ","parseMonitor"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseMonitor=void 0;n.ParseMonitor=function(){},cc._RF.pop()},{}],parseProgress:[function(e,t,n){"use strict";cc._RF.push(t,"0e5c03JcvhOQ7sSwEI5D6Fl","parseProgress"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseProgress=void 0;n.ParseProgress=function(){},cc._RF.pop()},{}],parseSchool:[function(e,t,n){"use strict";cc._RF.push(t,"4535amQJ29GB4/ktUT/Uxzp","parseSchool"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseSchool=void 0;n.ParseSchool=function(){},cc._RF.pop()},{}],parseSection:[function(e,t,n){"use strict";cc._RF.push(t,"44cd6SSTEBA3YGj3eJ5Uasp","parseSection"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseSection=void 0;n.ParseSection=function(){},cc._RF.pop()},{}],parseStudent:[function(e,t,n){"use strict";cc._RF.push(t,"b6ec9aklhxLX7oVcfkhoBjU","parseStudent"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseStudent=n.ParseSchoolStudent=void 0;n.ParseSchoolStudent=function(){};n.ParseStudent=function(){},cc._RF.pop()},{}],parseSubject:[function(e,t,n){"use strict";cc._RF.push(t,"657d7HSnyFPbptfVc+X9L3S","parseSubject"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseSubject=void 0;n.ParseSubject=function(){},cc._RF.pop()},{}],parseTeachersForStudent:[function(e,t,n){"use strict";cc._RF.push(t,"86f34UrfZBBqLlPUUPjj0j5","parseTeachersForStudent"),Object.defineProperty(n,"__esModule",{value:!0}),n.SchoolWithTeacher=n.ParseTeachersForStudent=void 0;n.ParseTeachersForStudent=function(){};n.SchoolWithTeacher=function(){},cc._RF.pop()},{}],parseTuition:[function(e,t,n){"use strict";cc._RF.push(t,"f48b1lL7nJIxrdwyrwCd0yz","parseTuition"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseTuition=void 0;n.ParseTuition=function(){},cc._RF.pop()},{}],parseUser:[function(e,t,n){"use strict";cc._RF.push(t,"32690Lm67pC5JfFr5+f7Pfy","parseUser"),Object.defineProperty(n,"__esModule",{value:!0}),n.ParseUser=void 0;n.ParseUser=function(){},cc._RF.pop()},{}],profile:[function(e,t,n){"use strict";cc._RF.push(t,"a96c31hmTFFGZ19nXKggkBB","profile");var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.User=n.LessonProgressClass=n.CourseProgressClass=n.Gender=n.IN_LOGIN_FLOW=n.IS_OTP_VERIFIED=n.PASSWORD=n.CONTACT=n.EMAIL=n.CURRENTMODE=n.LANGUAGE=n.MAX_AGE=n.MAX_USERS=n.USER_ID=n.AGE=n.MUSIC_OFF=n.GENDER=n.SFX_OFF=n.DIALING_CODE=void 0;var i,a=e("../../../queue"),s=e("../header"),c=e("../util"),l=e("../util-logger"),u=e("./config"),d=e("./constants");n.DIALING_CODE="dialingCode",n.SFX_OFF="sfxOff",n.GENDER="gender",n.MUSIC_OFF="musicOff",n.AGE="age",n.USER_ID="UserId",n.MAX_USERS=3,n.MAX_AGE=12,n.LANGUAGE="language",n.CURRENTMODE="currentMode",n.EMAIL="email",n.CONTACT="contact",n.PASSWORD="password",n.IS_OTP_VERIFIED="isOtpVerified",n.IN_LOGIN_FLOW="in_login_flow",function(e){e[e.BOY=0]="BOY",e[e.GIRL=1]="GIRL",e[e.UNKNOWN=2]="UNKNOWN"}(i=n.Gender||(n.Gender={}));var p=function(){function e(e){void 0===e&&(e=null),this.currentChapterId=e,this.date=new Date,this.assignments=[],this.lessonPlan=[],this.lessonPlanIndex=0,this.isCourseCompleted=!1}return e.prototype.updateChapterId=function(e){this.currentChapterId=e,u.default.i.course&&l.default.logChimpleEvent("student_level",{level:e,subject:u.default.i.course.name})},e}();n.CourseProgressClass=p;var h=function(e,t,n,r,o){var i=this;void 0===t&&(t=0),void 0===n&&(n=u.default.i.course.id),void 0===r&&(r=null),void 0===o&&(o=null),this.achievement=0,this.date=null,this.assignmentIds=[],this.score=e,this.attempts=t,o?this.date=o:new Date,this.course=n;var a=r?r.split(","):[];a.length>0?a.forEach(function(e){i.assignmentIds.push(e)}):r&&this.assignmentIds.push(r)};n.LessonProgressClass=h;var f=function(){function e(e,t,n,r,o,i,a,s,c,u,d,p,h,f,g,_,m,y,v,b,E,S,I,C,w){void 0===_&&(_=!1),void 0===y&&(y=""),void 0===v&&(v=""),void 0===b&&(b=""),void 0===E&&(E=""),void 0===S&&(S=""),void 0===I&&(I=""),void 0===C&&(C=[]),void 0===w&&(w=new Map),this.isConnected=!1,this.debug=!1,this.curriculumLoaded=!1,this._id=e,this._name=t,this._age=n,this._gender=r,this._imgPath=o,this._avatarImage=i,this._isTeacher=a,this._inventory=s,this._unlockedInventory=f,this._unlockedRewards=g,this._currentBg=c,this._currentCharacter=u,this._courseProgressMap=d,this._lessonProgressMap=p,this._chapterFinishedMap=h,l.default.setUserIdEvent(e),l.default.setUserPropertiesEvent("userName",t),l.default.setUserPropertiesEvent("userAge",n),this._genderEvent(r),this.debug=_,this._serverId=y,this._assignments=[],this._currentReward=C,this._schoolId=v,this._sectionId=b,this._studentId=E,this._schoolName=S,this._sectionName=I,this._last5Lessons=w}return e.prototype._genderEvent=function(e){switch(e){case i.BOY:l.default.setUserPropertiesEvent("userGender","Boy");break;case i.GIRL:l.default.setUserPropertiesEvent("userGender","Girl");break;case i.UNKNOWN:l.default.setUserPropertiesEvent("userGender","Unknown")}},Object.defineProperty(e.prototype,"serverId",{get:function(){return this._serverId},set:function(e){this._serverId=e,this.storeUser(),l.default.setUserIdEvent(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this.storeUser(),l.default.setUserIdEvent(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e,this.storeUser(),l.default.setUserPropertiesEvent("userName",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"age",{get:function(){return this._age},set:function(e){this._age=e,this.storeUser(),l.default.setUserPropertiesEvent("userAge",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gender",{get:function(){return this._gender},set:function(e){this._gender=e,this.storeUser(),this._genderEvent(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imgPath",{get:function(){return this._imgPath},set:function(e){this._imgPath=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"avatarImage",{get:function(){return this._avatarImage},set:function(e){console.log(" avatar image : ",e),this._avatarImage=e,l.default.setUserPropertiesEvent("userAvatarImage",e),this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inventory",{get:function(){return this._inventory},set:function(e){this._inventory=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentBg",{get:function(){return this._currentBg},set:function(e){this._currentBg=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentCharacter",{get:function(){return this._currentCharacter},set:function(e){this._currentCharacter=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"courseProgressMap",{get:function(){return this._courseProgressMap},set:function(e){this._courseProgressMap=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lessonProgressMap",{get:function(){return this._lessonProgressMap},set:function(e){this._lessonProgressMap=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unlockedInventory",{get:function(){return this._unlockedInventory},set:function(e){this._unlockedInventory=null!=e?e:{},this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unlockedRewards",{get:function(){return this._unlockedRewards},set:function(e){this._unlockedRewards=null!=e?e:{},this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTeacher",{set:function(e){this._isTeacher=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"assignments",{get:function(){return this._assignments},set:function(e){this._assignments=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentCourseId",{get:function(){return this._currentCourseId},set:function(e){this._currentCourseId=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentReward",{get:function(){return this._currentReward},set:function(e){this._currentReward=e,this.storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schoolId",{get:function(){return this._schoolId},set:function(e){this._schoolId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sectionId",{get:function(){return this._sectionId},set:function(e){this._sectionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"studentId",{get:function(){return this._studentId},set:function(e){this._studentId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sectionName",{get:function(){return this._sectionName},set:function(e){this._sectionName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schoolName",{get:function(){return this._schoolName},set:function(e){this._schoolName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last5Lessons",{get:function(){return this._last5Lessons},set:function(e){this._last5Lessons=e},enumerable:!1,configurable:!0}),e.prototype.updateLast5Lessons=function(e){var t,n=u.default.i.course.id,r=null!==(t=this._last5Lessons.get(n))&&void 0!==t?t:[];r.unshift(e),r=r.slice(0,5),this._last5Lessons.set(n,r)},e.prototype.unlockInventoryForItem=function(e){this._unlockedInventory[e]=!0,this.storeUser()},e.prototype.unlockRewardsForItem=function(e,t){this._unlockedRewards[e]=t,this.storeUser()},e.prototype.updateInventory=function(e,t){this._inventory[e]=t,this.storeUser()},e.prototype.openAllRewards=function(){var e=this;c.REWARD_CHARACTERS.forEach(function(t){e._unlockedRewards[c.REWARD_TYPES[0]+"-"+t]=1,c.INVENTORY_DATA.forEach(function(n){n.forEach(function(n){e._unlockedRewards[c.REWARD_TYPES[3]+"-"+t+"-"+n]=1})})}),c.REWARD_BACKGROUNDS.forEach(function(t){e._unlockedRewards[c.REWARD_TYPES[1]+"-"+t]=1}),c.STICKER_REWARDS.forEach(function(t){c.STICKER_BOOK.forEach(function(n){e._unlockedRewards[c.REWARD_TYPES[4]+"-sticker-"+n]=1,t.forEach(function(t){e._unlockedRewards[c.REWARD_TYPES[4]+"-sticker-"+n+"-"+t]=1})})}),this.storeUser()},e.prototype.openAllRewardsForCharacter=function(e){var t=this;c.INVENTORY_DATA.forEach(function(n){n.forEach(function(n){t._unlockedRewards[c.REWARD_TYPES[3]+"-"+e+"-"+n]=1})})},e.prototype.openOnlyTheSelectedRewards=function(e){var t=this;c.INVENTORY_DATA.forEach(function(n,r){var o=t._inventory[e+"-"+n[0].split("-")[0]];n.forEach(function(n){delete t._unlockedRewards[c.REWARD_TYPES[3]+"-"+e+"-"+n]}),null!=o&&(t._unlockedRewards[c.REWARD_TYPES[3]+"-"+e+"-"+n[r].split("-")[0].concat("-"+o)]=1)})},e.prototype.unlockBydefaultRewards=function(){this.unlockRewardsForItem(c.REWARD_TYPES[0]+"-"+c.REWARD_CHARACTERS[0],1),this.unlockRewardsForItem(c.REWARD_TYPES[1]+"-"+c.REWARD_BACKGROUNDS[0],1)},e.prototype.updateLessonProgress=function(e,t,n,r){var o,i,a=this;void 0===r&&(r=null);var s=u.default.i,p=this.courseProgressMap.get(s.course.id);if(this.updateLast5Lessons({lesson:e,score:t,date:(new Date).toISOString()}),p){if(this._lessonProgressMap.has(e)){var f=this._lessonProgressMap.get(e);f.assignmentIds.push(u.default.i.lesson.assignmentId),f.attempts++,f.date=new Date,t>(null!==(o=f.score)&&void 0!==o?o:0)&&(f.score=t,u.default.i.lesson.type==d.EXAM&&t>=d.MIN_PASS&&(i=[c.REWARD_TYPES[2],u.default.i.lesson.image])),u.default.i.lesson.type==d.EXAM&&d.MIN_PASS}else u.default.i.lesson.type==d.EXAM&&t>=d.MIN_PASS&&(i=[c.REWARD_TYPES[2],u.default.i.lesson.image]),this._lessonProgressMap.set(e,new h(t,1,u.default.i.course.id,u.default.i.lesson.assignmentId));if(e==s.course.id+"_PreQuiz"){var g=l.default.getChapterIdForPrequiz(n);console.log("on prequiz chapterid",g),p.updateChapterId(g)}else if(u.default.i.lesson.type!=d.EXAM||t>=d.MIN_PASS){var _=(y=u.default.i.chapter.lessons).findIndex(function(t){return t.id==e});if(y.length>_+1){var m=y[_+1];this._lessonProgressMap.has(m.id)||this._lessonProgressMap.set(m.id,new h(-1))}}if((S=p.lessonPlan)&&S[p.lessonPlanIndex]==s.lesson.id)if(u.default.i.startAction=u.StartAction.MoveLessonPlan,u.default.i.lesson.type!=d.EXAM||t>=d.MIN_PASS){var y;if(p.lessonPlanIndex++,_=(y=u.default.i.chapter.lessons).findIndex(function(t){return t.id==e}),y.length>_+1)m=y[_+1],p.currentLessonId=m.id;else if(this.courseProgressMap.get(u.default.i.course.id).currentChapterId==u.default.i.chapter.id){var v=void 0;if(u.default.i.course.chapters[u.default.i.course.chapters.length-1].id==u.default.i.chapter.id||!0===this.courseProgressMap.get(u.default.i.course.id).isCourseCompleted){var b=Math.floor(Math.random()*(u.default.i.course.chapters.length-1-1+1)+0);v=u.default.i.course.chapters[b],this.courseProgressMap.get(u.default.i.course.id).isCourseCompleted=!0}if(!v){var E=!1;v=u.default.i.course.chapters.find(function(e){return!!E||(E=e.id==a.courseProgressMap.get(u.default.i.course.id).currentChapterId,!1)})}v&&(p.currentLessonId=null,p.updateChapterId(v.id))}}else p.lessonPlanIndex=0}if(s.startCourse.id==u.ASSIGNMENT_COURSE_ID){var S,I=this.courseProgressMap.get(s.startCourse.id);(S=I.lessonPlan)&&S[I.lessonPlanIndex]==s.lesson.id&&(u.default.i.startAction=u.StartAction.MoveLessonPlan,I.lessonPlanIndex++)}if(this.assignments){var C=this.assignments.indexOf(s.lesson.id);C>-1&&this.assignments.splice(C,1)}var w=this.courseProgressMap.get(u.default.i.course.id);if(w){w.date=new Date,this._chapterFinishedMap=this._chapterFinishedMap?this._chapterFinishedMap:new Map;var P=s.curriculum.get(s.course.id).chapters.find(function(e){return e.id===w.currentChapterId});if(P&&!this._chapterFinishedMap.has(P.id)){var O=P.lessons.map(function(e){return e.id}),A=Array.from(this._lessonProgressMap.keys());0===O.filter(function(e){return!A.includes(e)}).length&&(this._chapterFinishedMap.set(P.id,!0),l.default.logChimpleEvent("chapterEnd",{chapterName:s.chapter.name,chapterId:s.chapter.id,courseName:s.course.id}))}}return this.storeUser(),i},e.prototype.storeUser=function(){e.storeUser(this)},e.storeUser=function(t){if(cc.log("serverid",t._serverId),cc.sys.localStorage.setItem(t.id,e.toJson(t)),!t.debug&&(l.default.logChimpleEvent("userProfile",{userAge:t.age,gender:t.gender,userId:t.id}),cc.sys.localStorage.getItem(d.CURRENT_STUDENT_ID))){var n={profile:e.toJson(t),kind:"Profile",studentId:cc.sys.localStorage.getItem(d.CURRENT_STUDENT_ID)};a.Queue.getInstance().push(n)}e.syncProfile()},e.syncProfile=function(){var t=e._currentUser,r=parseInt(g.getValue(n.CURRENTMODE));if(cc.sys.isNative&&t&&t.schoolId&&t.sectionId&&t.studentId&&t.id){if(!(null==t?void 0:t.isConnected)&&r===d.Mode.HomeConnect)return;l.default.syncProfile(t.schoolId,t.sectionId,t.studentId,e.toJson(t),t.id)}},e.createUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})},e.createUser=function(t,n,r,o,a,s,c){void 0===a&&(a=null),void 0===s&&(s=null),void 0===c&&(c=!1);var l=a||e.createUUID(),u="debug15"==t&&"teacherbird"==s&&8==r&&o==i.GIRL,h=new e(l,t,r,o,n,s,c,{},"camp","chimp",u?new Map([["assignment",new p],["en",new p("en00")],["maths",new p("maths00")],["puzzle",new p("puzzle00")],["test-lit",new p("chapter_0")],["test-maths",new p("chapter_0")]]):new Map([["assignment",new p],["en",new p],["maths",new p],["puzzle",new p("puzzle00")]]),new Map,new Map,{},{},u,["","","","","","","","","1","2","r","1","2","r","1","2","r"]);u&&h.openAllRewards(),h.unlockBydefaultRewards();var f=cc.sys.localStorage.getItem(d.FIREBASE_SCHOOL_ID);h.schoolId=f||null;var g=cc.sys.localStorage.getItem(d.FIREBASE_SECTION_ID);h.sectionId=g||null;var _=cc.sys.localStorage.getItem(d.FIREBASE_STUDENT_ID);h.studentId=_||null,e.storeUser(h);var m=e.getUserIds();return null==m?m=[l]:m.push(l),e.setUserIds(m),console.log("User created ",e.fromJson(cc.sys.localStorage.getItem(l))),h},e.getUsers=function(){var t=[],n=e.getUserIds();return null!=n&&n.forEach(function(n){var r=e.fromJson(cc.sys.localStorage.getItem(n));!r.isTeacher&&r.age>0&&t.push(r)}),t},e.getUserIds=function(){return JSON.parse(cc.sys.localStorage.getItem(n.USER_ID))},e.setUserIds=function(e){cc.sys.localStorage.setItem(n.USER_ID,JSON.stringify(e)),console.log("User Id aray created ",JSON.parse(cc.sys.localStorage.getItem(n.USER_ID)))},e.fromJson=function(t){var n=JSON.parse(t);if(!n)return null;var r=new Map;for(var o in n.courseProgressMap){var i=n.courseProgressMap[o],a=new p(i.currentChapterId);a.currentLessonId=i.currentLessonId,a.date=new Date(i.date),a.assignments=i.assignments,a.lessonPlan=i.lessonPlan,a.lessonPlanIndex=i.lessonPlanIndex,a.isCourseCompleted=i.isCourseCompleted,a.lessonPlanDate&&(i.lessonPlanDate=new Date(a.lessonPlanDate)),r.set(o,a)}var s=new Map;for(var o in n.lessonProgressMap){var c=n.lessonProgressMap[o];c.date=new Date(c.date),s.set(o,c)}var l=new Map;for(var o in n.chapterFinishedMap)l.set(o,n.chapterFinishedMap[o]);var u=new Map;if(n.last5Lessons)for(var o in n.last5Lessons){for(var d=[],h=0,f=n.last5Lessons[o];h<f.length;h++){var g=f[h],_={lesson:g.lesson,score:g.score,date:g.date};d.push(_)}u.set(o,d)}var m=new e(n.id,n.name,n.age,n.gender,n.imgPath,n.avatarImage,n.isTeacher,n.inventory,n.currentBg,n.currentCharacter,r,s,l,n.unlockedInventory,n.unlockedRewards,n.debug,n.lessonPlan,n.serverId,n.schoolId,n.sectionId,n.studentId,n.schoolName,n.sectionName,n.currentReward,u);return m.isConnected=n.isConnected,n.assignments&&(m._assignments=n.assignments),m},e.toJson=function(e){var t={};e.courseProgressMap.forEach(function(e,n){t[n]=e});var n={};e.lessonProgressMap.forEach(function(e,t){n[t]=e});var r={};e._chapterFinishedMap.forEach(function(e,t){r[t]=e});var o={};return e._last5Lessons.forEach(function(e,t){o[t]=e}),JSON.stringify({id:e.id,name:e.name,age:e.age,gender:e.gender,imgPath:e.imgPath,avatarImage:e.avatarImage,isTeacher:e.isTeacher,inventory:e.inventory,currentBg:e.currentBg,currentCharacter:e.currentCharacter,courseProgressMap:t,lessonProgressMap:n,unlockedInventory:e.unlockedInventory,unlockedRewards:e.unlockedRewards,debug:e.debug,serverId:e.serverId,assignments:e.assignments,chapterFinishedMap:r,isConnected:e.isConnected,schoolId:e.schoolId,sectionId:e.sectionId,studentId:e.studentId,schoolName:e.schoolName,sectionName:e.sectionName,currentReward:e.currentReward,last5Lessons:o})},e.setCurrentUser=function(e){this._currentUser=e,u.default.i.clear(),s.default.homeSelected=!0},e.getCurrentUser=function(){return this._currentUser},e.getUser=function(t){return e.fromJson(cc.sys.localStorage.getItem(t))},e.deleteUser=function(t){cc.sys.localStorage.removeItem(t);var r=e.getUserIds(),o=r.indexOf(t);r.splice(o,1),cc.sys.localStorage.setItem(n.USER_ID,JSON.stringify(r))},e.replaceUserID=function(t,r){cc.sys.localStorage.removeItem(t);var o=e.getUserIds(),i=o.indexOf(t);o.splice(i,1),o.push(r),cc.sys.localStorage.setItem(n.USER_ID,JSON.stringify(o))},e.createUserOrFindExistingUser=function(t){var n=null;return t&&t.id&&(n=this.getUser(t.id))?n:e.createUser(t.name,t.imgPath,t.age,t.gender,t.id,t.avatarImage||t.imgPath,t.isTeacher)},e}();n.User=f;var g=function(){function e(){}return e.initialize=function(){var t=this;if("true"!=e.getValue("isInitialized")){this.setItem(n.SFX_OFF,0),this.setItem(n.MUSIC_OFF,0),this.setItem(n.IS_OTP_VERIFIED,0),this.setValue("isInitialized","true");var r=l.default.getCountryCode();r?d.COUNTRY_CODES.forEach(function(e){e.code.toLowerCase()===r&&t.setValue(n.DIALING_CODE,e.dial_code)}):this.setValue(n.DIALING_CODE,"+91")}},e.getValue=function(e){return cc.sys.localStorage.getItem(e)},e.setValue=function(e,t){cc.sys.localStorage.setItem(e,t)},e.getItem=function(t){return Number(e.getValue(t)||0)},e.setItem=function(t,n){e.setValue(t,n.toString())},Object.defineProperty(e,"lang",{get:function(){return e.getValue(n.LANGUAGE)},enumerable:!1,configurable:!0}),e.fromJsonUsingParse=function(e){var t=JSON.parse(e||"{}"),n=l.default.currentProfile();cc.sys.localStorage.setItem(n,JSON.stringify(t))},e.toJson=function(){},Object.defineProperty(e,"lastWorld",{get:function(){return this.getItem(u.default.getInstance().course.id+"World")},set:function(e){this.setItem(u.default.getInstance().course.id+"World",e),this.setItem(u.default.getInstance().course.id+"Level",0),this.toJson()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"lastLevel",{get:function(){return this.getItem(u.default.getInstance().course.id+"Level")},set:function(e){this.lastLevel<e&&(this.setItem(u.default.getInstance().course.id+"Level",e),this.toJson())},enumerable:!1,configurable:!0}),e.isGameCompleted=function(e,t,n){return 1==this.getItem(u.default.getInstance().course.id+"_"+e+"_"+t+"_"+n)},e.setGameCompleted=function(e,t,n,r){void 0===r&&(r=!0),this.setItem(u.default.getInstance().course.id+"_"+e+"_"+t+"_"+n,r?1:0),this.toJson()},e.teacherPostLoginActivity=function(e){return r(this,void 0,void 0,function(){var t;return o(this,function(){return t=f.createUserOrFindExistingUser({id:e}),f.setCurrentUser(t),[2,t]})})},e._profile={},e}();n.default=g,cc._RF.pop()},{"../../../queue":"queue","../header":"header","../util":"util","../util-logger":"util-logger","./config":"config","./constants":"constants"}],progressMonitor:[function(e,t,n){"use strict";cc._RF.push(t,"d0b6fkKhtlG0Zv03asj558b","progressMonitor");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.StarType=void 0;var a,s=e("./lib/config"),c=cc._decorator,l=c.ccclass,u=c.property;(function(e){e[e.Default=0]="Default",e[e.Correct=1]="Correct",e[e.Wrong=2]="Wrong",e[e.NextPage=3]="NextPage",e[e.PrevPage=4]="PrevPage"})(a=n.StarType||(n.StarType={}));var d=["rewards/fruits/baag/red_bellpepper","rewards/fruits/baag/yellow_bellpepper","rewards/fruits/baag/carrot","rewards/fruits/baag/popato","rewards/fruits/baag/tomato","rewards/fruits/baag/red_chillie","rewards/fruits/baag/brocolli","rewards/fruits/baag/cucumber","rewards/fruits/baag/green_chillie","rewards/fruits/baag/turnip","rewards/fruits/sehar/omlette","rewards/fruits/sehar/coffee","rewards/fruits/sehar/yogurt","rewards/fruits/sehar/boiled_egg","rewards/fruits/sehar/butter","rewards/fruits/sehar/cheese","rewards/fruits/sehar/porridge","rewards/fruits/sehar/salad","rewards/fruits/sehar/bread_sliced","rewards/fruits/sehar/tea","rewards/fruits/badal/chickoo","rewards/fruits/badal/pineapple","rewards/fruits/badal/mango","rewards/fruits/badal/cherry","rewards/fruits/badal/orange","rewards/fruits/badal/grapes","rewards/fruits/badal/apple","rewards/fruits/badal/pear","rewards/fruits/badal/banana","rewards/fruits/badal/strawberry","rewards/fruits/samundra/prawns","rewards/fruits/samundra/coconut","rewards/fruits/samundra/watermelon","rewards/fruits/samundra/tender_coconut","rewards/fruits/samundra/lemon","rewards/fruits/samundra/orange_juice","rewards/fruits/samundra/kiwi","rewards/fruits/samundra/juice","rewards/fruits/samundra/lemon_wedge","rewards/fruits/samundra/fish","rewards/fruits/barf/salmon","rewards/fruits/barf/bread","rewards/fruits/barf/momos","rewards/fruits/barf/meat","rewards/fruits/barf/rice","rewards/fruits/barf/sushi","rewards/fruits/barf/chicken_meat","rewards/fruits/barf/jam","rewards/fruits/barf/dumpling","rewards/fruits/barf/soup","rewards/fruits/sagar/squid","rewards/fruits/sagar/fish_eggs","rewards/fruits/sagar/lobster","rewards/fruits/sagar/cilantro","rewards/fruits/sagar/tuna","rewards/fruits/sagar/garlic","rewards/fruits/sagar/crab","rewards/fruits/sagar/mussel","rewards/fruits/sagar/seaweed","rewards/fruits/sagar/sardine","rewards/fruits/jungle/corn","rewards/fruits/jungle/wheat","rewards/fruits/jungle/honeycomb","rewards/fruits/jungle/chicken","rewards/fruits/jungle/honey","rewards/fruits/jungle/milk","rewards/fruits/jungle/meat","rewards/fruits/jungle/cabbage","rewards/fruits/jungle/egg","rewards/fruits/jungle/pumpkin","rewards/fruits/udyaan/coffee_bean","rewards/fruits/udyaan/chestnut","rewards/fruits/udyaan/dango","rewards/fruits/udyaan/peanut","rewards/fruits/udyaan/sausage","rewards/fruits/udyaan/acorn","rewards/fruits/udyaan/sandwich","rewards/fruits/udyaan/cashew","rewards/fruits/udyaan/almond","rewards/fruits/udyaan/roasted_sausage","rewards/fruits/khet/honeydew","rewards/fruits/khet/mushroom","rewards/fruits/khet/raspberry","rewards/fruits/khet/peach","rewards/fruits/khet/black_currant","rewards/fruits/khet/dragonfruit","rewards/fruits/khet/blackberry","rewards/fruits/khet/button_mushroom","rewards/fruits/khet/redcurrant","rewards/fruits/khet/enoki_mushroom","rewards/fruits/registan/grapefruit","rewards/fruits/registan/coco_bean","rewards/fruits/registan/starfruit","rewards/fruits/registan/litchi","rewards/fruits/registan/date","rewards/fruits/registan/mangosteen_sliced","rewards/fruits/registan/mangosteen","rewards/fruits/registan/starfruit_sliced","rewards/fruits/registan/jackfruit","rewards/fruits/registan/dry_coconut"],p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.complete=null,t.current=null,t.incomplete=null,t.correct=null,t.wrong=null,t.glowPrefab=null,t.totalStars=0,t.stopStar=!1,t.fruit=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this,t=s.default.getInstance(),n=d[Math.floor(Math.random()*d.length)];cc.resources.load(n,cc.SpriteFrame,function(t,n){t||(e.fruit=n)}),this.totalStars=t.totalProblems;for(var r=1;r<=this.totalStars;r++){var o=new cc.Node;o.name=r.toString();var i=new cc.Node;i.name="sprite",o.addChild(i);var a=i.addComponent(cc.Sprite);r<t.problem||(r==t.problem?a.spriteFrame=this.current:a.spriteFrame=this.incomplete),o.width=2*i.width,o.height=2*i.height,this.node.addChild(o)}},t.prototype.updateProgress=function(e,t,n){var r=this;if(t==a.NextPage)this.node.getChildByName(e.toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=this.complete,e<this.totalStars&&(this.node.getChildByName((e+1).toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=this.current),n();else if(t==a.PrevPage)this.node.getChildByName(e.toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=this.incomplete,e>1&&(this.node.getChildByName((e-1).toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=this.current),n();else{var o=new cc.Node,i=cc.instantiate(this.glowPrefab),s=i.getComponent(cc.Animation);o.addChild(i),i.active=!1;var c=new cc.Node;c.name="sprite";var l=c.addComponent(cc.Sprite);switch(t){case a.Default:l.spriteFrame=this.fruit;break;case a.Correct:l.spriteFrame=this.correct;break;case a.Wrong:l.spriteFrame=this.wrong}o.name=e.toString(),o.scale=.25,o.addChild(c);var u=this.node.getChildByName(e.toString());if(null!=u){var d=u.getChildByName("sprite");if(null!=d){var p=cc.v2(cc.winSize.width*Math.random()-cc.winSize.width/2,-cc.winSize.height-100);o.setPosition(p);var h=cc.v2(cc.winSize.width/2*Math.random()-cc.winSize.width/4,-cc.winSize.height/2);u.addChild(o),o.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,1),cc.bezierTo(.5,[cc.v2(p.add(h).mul(.33).add(cc.v2(200,0))),cc.v2(p.add(h).mul(.33).add(cc.v2(100,0))),h])),cc.callFunc(function(){i.active=!0,s.on("finished",function(){i.active=!1}),s.play()}),cc.delayTime(.75),cc.spawn(cc.moveTo(.5,d.position),cc.scaleTo(.5,.25)),cc.callFunc(function(){i.active=!1}),cc.callFunc(function(){d.removeFromParent(),e<r.totalStars&&(r.node.getChildByName((e+1).toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=r.current),n()})))}}}},i([u(cc.SpriteFrame)],t.prototype,"complete",void 0),i([u(cc.SpriteFrame)],t.prototype,"current",void 0),i([u(cc.SpriteFrame)],t.prototype,"incomplete",void 0),i([u(cc.SpriteFrame)],t.prototype,"correct",void 0),i([u(cc.SpriteFrame)],t.prototype,"wrong",void 0),i([u(cc.Prefab)],t.prototype,"glowPrefab",void 0),i([l],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./lib/config":"config"}],queue:[function(e,t,n){"use strict";cc._RF.push(t,"38a63Fp8GJKc7q7xPGC81jl","queue"),Object.defineProperty(n,"__esModule",{value:!0}),n.Queue=n.QUEUE_CACHE=void 0;var r=e("./common/scripts/lib/constants");n.QUEUE_CACHE="QUEUE_CACHE";var o=function(){function e(){this._store=[]}return e.init=function(){e.getInstance()},e.getInstance=function(){return e.instance||(e.instance=new e,r.PARSE_ENABLED&&(e.instance._store=e.instance.getFromCache())),e.instance},e.prototype.push=function(e){r.PARSE_ENABLED&&(this._store.push(e),cc.sys.localStorage.setItem(n.QUEUE_CACHE,JSON.stringify(this._store)))},e.prototype.pop=function(){var e=void 0;return r.PARSE_ENABLED&&(e=this._store.shift(),cc.sys.localStorage.setItem(n.QUEUE_CACHE,JSON.stringify(this._store))),e},e.prototype.isEmpty=function(){return 0===this._store.length},e.prototype.getFromCache=function(){try{return JSON.parse(cc.sys.localStorage.getItem(n.QUEUE_CACHE))||[]}catch(e){return[]}},e}();n.Queue=o,cc._RF.pop()},{"./common/scripts/lib/constants":"constants"}],"quit-popup":[function(e,t,n){"use strict";cc._RF.push(t,"77022gNMaNC/aL1sjC9ITf5","quit-popup");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./lessonController"),s=e("./lib/config"),c=e("./lib/constants"),l=e("./lib/profile"),u=e("./util"),d=cc._decorator,p=d.ccclass,h=d.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputEventBlocker=null,t.exitLabel=null,t.videoLabel=null,t.isCuba=l.default.getItem(c.IS_CUBA),t}return o(t,e),t.prototype.onLoad=function(){this.inputEventBlocker.zIndex=2,this.node.zIndex=3,this.exitLabel.string=u.Util.i18NText("Exit"),this.videoLabel.string=u.Util.i18NText("Watch Help Video")},t.prototype.onClickYesButton=function(){if(this.node.getChildByName("quit_bg").getChildByName("exit_game").getComponent(cc.Button).interactable=!1,s.default.isMicroLink=!1,this.isCuba){var e=new CustomEvent(c.GAME_EXIT,{detail:{}});return window.parent.document.body.dispatchEvent(e),void console.log("event dispatched",e)}s.default.i.popScene(),a.default.getFriend().stopAudio()},t.prototype.onClickNoButton=function(){this.node.active=!1,this.inputEventBlocker.active=!1},t.prototype.onClickHelpButton=function(){this.node.getChildByName("quit_bg").getChildByName("help_video").getComponent(cc.Button).interactable=!1,cc.sys.openURL("https://wa.me/917019270679"),this.node.active=!1,this.inputEventBlocker.active=!1},t.prototype.onEnable=function(){this.inputEventBlocker.active=!0,cc.director.pause(),cc.audioEngine.pauseAllEffects()},t.prototype.onDisable=function(){cc.director.resume(),cc.audioEngine.resumeAllEffects()},i([h(cc.Node)],t.prototype,"inputEventBlocker",void 0),i([h(cc.Label)],t.prototype,"exitLabel",void 0),i([h(cc.Label)],t.prototype,"videoLabel",void 0),i([p],t)}(cc.Component);n.default=f,cc._RF.pop()},{"./lessonController":"lessonController","./lib/config":"config","./lib/constants":"constants","./lib/profile":"profile","./util":"util"}],"quiz-monitor":[function(e,t,n){"use strict";cc._RF.push(t,"386c90A60tEro/bc7nZBHiS","quiz-monitor");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.QUIZ_ANSWERED=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("./lib/config"),l=e("./lib/error-handler");n.QUIZ_ANSWERED="QUIZ_ANSWERED";var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.correctImage=null,t.wrongImage=null,t.emptyImage=null,t.imageNode=null,t.totalItems=0,t.stopStar=!1,t}return o(t,e),t.prototype.onLoad=function(){this.totalItems=c.default.getInstance().totalProblems;for(var e=1;e<=this.totalItems;e++){var t=new cc.Node;this.createRewardStar(t,e),this.node.addChild(t)}},t.prototype.createRewardStar=function(e,t){e.name=t.toString();var n=cc.instantiate(this.imageNode);n.name="sprite",n.group="gameCamera",e.addChild(n),n.getComponent(cc.Sprite).spriteFrame=this.emptyImage,e.width=n.width,e.height=n.height},t.prototype.updateProgress=function(e,t){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.stopStar?this.correctImage:this.wrongImage,n.name=e.toString();var r=this.node.getChildByName(e.toString());if(null!=r){var o=r.getChildByName("sprite");null!=o&&(o.removeFromParent(),r.addChild(n),t())}},i([s(cc.SpriteFrame)],t.prototype,"correctImage",void 0),i([s(cc.SpriteFrame)],t.prototype,"wrongImage",void 0),i([s(cc.SpriteFrame)],t.prototype,"emptyImage",void 0),i([s(cc.Prefab)],t.prototype,"imageNode",void 0),i([l.default()],t.prototype,"onLoad",null),i([l.default()],t.prototype,"createRewardStar",null),i([l.default()],t.prototype,"updateProgress",null),i([a],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./lib/config":"config","./lib/error-handler":"error-handler"}],resetTracingButton:[function(e,t,n){"use strict";cc._RF.push(t,"cf59aJ82wBD+ai9PuIn/viA","resetTracingButton");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./helper"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onLoad=function(){var e=this;this.node.zIndex=100,this.node.on("touchend",function(){e.node.dispatchEvent(new cc.Event.EventCustom(a.RESET_TRACING,!0))})},i([c],t)}(cc.Component));n.default=l,cc._RF.pop()},{"./helper":"helper"}],scorecard:[function(e,t,n){"use strict";cc._RF.push(t,"22536lUwHNFRICAGIkXssjK","scorecard");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../common/scripts/lib/config"),s=e("../../scripts/util"),c=e("./achievement"),l=e("../../scripts/friend"),u=e("../../scripts/lib/constants"),d=e("../../scripts/lib/profile"),p=cc._decorator,h=p.ccclass,f=p.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.star1=null,t.star2=null,t.star3=null,t.active=null,t.friendPos=null,t.rewardPos=null,t.score=0,t.text="Lesson",t.isCuba=d.default.getItem(u.IS_CUBA),t}return o(t,e),t.prototype.onLoad=function(){var e=this;if(cc.sys.isNative||!a.default.isMicroLink||this.isCuba||(this.continueButton.active=!1,a.default.i.microLinkData.end!=u.MICROLINK_END_BLANK&&(this.downloadButton.active=!0,this.downloadButton.parent.getChildByName("web_scorecard_bg").active=!0,this.downloadButton.parent.getChildByName("playstore_label").active=!0)),this.label.string=s.Util.i18NText(this.text),this.score>25&&(this.star1.spriteFrame=this.active),this.score>50&&(this.star2.spriteFrame=this.active),this.score>75&&(this.star3.spriteFrame=this.active),s.Util.loadFriend(function(t){var n=t.getComponent(l.default);n.interactable=!1,e.friendPos.addChild(t),s.Util.loadAccessoriesAndEquipAcc(t.children[1],t),n.playHappyAnimation(1)}),this.getComponent(cc.Animation).play("scorecard"),this.node.getChildByName("commonButton").getComponent(cc.Animation).play("continue"),this.reward)if(this.reward[0]==s.REWARD_TYPES[0]);else if(this.reward[0]==s.REWARD_TYPES[1])cc.resources.load("backgrounds/textures/bg_icons/"+this.reward[1],cc.SpriteFrame,function(t,n){t||(e.rewardPos.addComponent(cc.Sprite).spriteFrame=n)});else if(this.reward[0]==s.REWARD_TYPES[2]){var t=cc.instantiate(this.achievementPrefab),n=t.getComponent(c.default);n.image=a.default.i.lesson.image,n.courseId=a.default.i.course.id,n.score=this.score,this.rewardPos.addChild(t)}else this.reward[0],s.REWARD_TYPES[3]},t.prototype.onContinueClick=function(){if(this.continueButton.getComponent(cc.Button).interactable=!1,this.isCuba){var e=new CustomEvent("gameEnd",{detail:{}});return window.parent.document.body.dispatchEvent(e),void console.log("event dispatched",e)}cc.sys.isNative&&a.default.isMicroLink?(a.default.isMicroLink=!1,a.default.i.pushScene("menu/start/scenes/start","menu",null,!0)):a.default.i.popScene()},t.prototype.onDownloadButtonClick=function(){cc.sys.openURL("https://play.google.com/store/apps/details?id=org.chimple.bahama&hl=en_IN")},i([f(cc.Label)],t.prototype,"label",void 0),i([f(cc.Sprite)],t.prototype,"star1",void 0),i([f(cc.Sprite)],t.prototype,"star2",void 0),i([f(cc.Sprite)],t.prototype,"star3",void 0),i([f(cc.SpriteFrame)],t.prototype,"active",void 0),i([f(cc.Node)],t.prototype,"friendPos",void 0),i([f(cc.Node)],t.prototype,"rewardPos",void 0),i([f],t.prototype,"score",void 0),i([f],t.prototype,"text",void 0),i([f(cc.Prefab)],t.prototype,"achievementPrefab",void 0),i([f(cc.Node)],t.prototype,"continueButton",void 0),i([f(cc.Node)],t.prototype,"downloadButton",void 0),i([h],t)}(cc.Component);n.default=g,cc._RF.pop()},{"../../../common/scripts/lib/config":"config","../../scripts/friend":"friend","../../scripts/lib/constants":"constants","../../scripts/lib/profile":"profile","../../scripts/util":"util","./achievement":"achievement"}],singlelettertracing:[function(e,t,n){"use strict";cc._RF.push(t,"98bf6xTIJpBmaG5DyHWWMOH","singlelettertracing");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.SingleLetterTracing=n.TRACE_NODE_POS_Y=n.TRACE_NODE_POS_X=n.LETTER_SCALE=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("../../../common/scripts/helper"),l=e("../../../common/scripts/util"),u=e("../../../common/Tracing/scripts/tracing-container"),d=e("./writeword"),p=e("./trace-graphics");n.LETTER_SCALE=.95,n.TRACE_NODE_POS_X=-256,n.TRACE_NODE_POS_Y=-300;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tracingContainerComponent=null,t._traceGraphics=null,t._letter=null,t._wordTracingContainer=null,t._wordTracingComponent=null,t._tracingScale=null,t._sound=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;cc.director.getCollisionManager().enabled=!1,this._wordTracingComponent=this._wordTracingContainer.getComponent(d.default),this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this._tracingContainer.scale=.75,this._wordTracingContainer.on(c.CONFIG_LOADED,function(){e.setAlphabetToDisplay(e._letter),e.loadSounds(e._letter)})},t.prototype.reset=function(){this._traceGraphics.getComponent(p.default).resetGraphics()},t.prototype.loadSounds=function(e){var t=this;try{isNaN(Number(e))?l.Util.loadsPhonicsOrLetter(e.toLowerCase(),function(e){t._sound=e}):l.Util.loadNumericSound(e,function(e){t._sound=e})}catch(n){console.log(n)}},t.prototype.preloadSound=function(e,t){var n=this,r=t+e;l.Util.load(r,function(e,t){e||null===t||(n._sound=t)})},t.prototype.pronounce=function(){l.Util.speakPhonicsOrLetter(this._letter,function(){})},t.prototype.setAlphabetToDisplay=function(e){var t=this;this._tracingContainerComponent=this._tracingContainer.getComponent(u.default),this._tracingContainerComponent.tracingLetter=e,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),null!==this._tracingScale?this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=this._tracingScale:this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=n.LETTER_SCALE,this._traceGraphics=this._tracingContainerComponent.traceGraphics,this._tracingContainer.setPosition(new cc.Vec2(n.TRACE_NODE_POS_X,n.TRACE_NODE_POS_Y)),this.node.on("letterEnabledEvent",function(e,n){void 0===n&&(n=0),t._order===e&&t.scheduleOnce(function(){t._traceGraphics.emit("enabledGraphics")},n)}),this.node.width=this._tracingContainer.width},t.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},Object.defineProperty(t.prototype,"letter",{set:function(e){this._letter=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordTracingContainer",{set:function(e){this._wordTracingContainer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tracingScale",{get:function(){return this._tracingScale},set:function(e){this._tracingScale=e},enumerable:!1,configurable:!0}),i([s(cc.Prefab)],t.prototype,"tracingContainerPrefab",void 0),i([a],t)}(cc.Component);n.SingleLetterTracing=h,cc._RF.pop()},{"../../../common/Tracing/scripts/tracing-container":"tracing-container","../../../common/scripts/helper":"helper","../../../common/scripts/util":"util","./trace-graphics":"trace-graphics","./writeword":"writeword"}],studentPreviewInfo:[function(e,t,n){"use strict";cc._RF.push(t,"3c867lrcppBV4uGUBlvqMst","studentPreviewInfo");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.TEACHER_ADD_STUDENT_SELECTED=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property;n.TEACHER_ADD_STUDENT_SELECTED="TEACHER_ADD_STUDENT_SELECTED";var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.picNode=null,t.usernameNode=null,t._user=null,t._parent=null,t}return o(t,e),t.prototype.onLoad=function(){},t.prototype.renderStudent=function(){var e=this,t=this.picNode;this._user.imgPath?cc.loader.load(this._user.imgPath,function(e,n){if(!e){var r=new cc.SpriteFrame(n);t.getComponent(cc.Sprite).spriteFrame=r}}):this._user.avatarImage&&cc.resources.load("avatars/"+this._user.avatarImage,function(t,n){e.picNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}),this.usernameNode.getComponent(cc.Label).string=this._user.name||""},t.prototype.setUser=function(e){this._user=e},t.prototype.onStudentClicked=function(){this._parent.children.forEach(function(e){var t=e.getChildByName("pic");t&&(t.getChildByName("select").active=!1)}),this.generateEvent()},t.prototype.generateEvent=function(){this.picNode.getChildByName("select").active=!0;var e=new cc.Event.EventCustom(n.TEACHER_ADD_STUDENT_SELECTED,!0);e.setUserData({selectedStudent:this._user.id,studentName:this._user.name||""}),this.node.dispatchEvent(e)},t.prototype.setParent=function(e){this._parent=e},i([s(cc.Node)],t.prototype,"picNode",void 0),i([s(cc.Node)],t.prototype,"usernameNode",void 0),i([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{}],teacherAddedDialog:[function(e,t,n){"use strict";cc._RF.push(t,"0a77eH9W6JEBYthorx72VFK","teacherAddedDialog");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.TEACHER_ADD_DIALOG_CLOSED=void 0;var c=cc._decorator.ccclass,l=cc._decorator.property,u=e("./lib/profile"),d=e("./studentPreviewInfo"),p=e("./chimple-label"),h=e("../../chimple"),f=e("./util-logger"),g=e("./services/ServiceConfig"),_=e("./util");n.TEACHER_ADD_DIALOG_CLOSED="TEACHER_ADD_DIALOG_CLOSED";var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.studentPreviewInfoPrefab=null,t.text=null,t.yesButton=null,t.studentLayout=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(d.TEACHER_ADD_STUDENT_SELECTED,function(t){return a(e,void 0,void 0,function(){var e;return s(this,function(){return t.stopPropagation(),e=t.getUserData(),this.selectedStudentId=e.selectedStudent,this.selectedStudentName=e.studentName,this.yesButton.color=(new cc.Color).fromHEX("#C0E52F"),this.yesButton.active=!0,[2]})})}),this.users=u.User.getUsers(),this.render()},t.prototype.validate=function(){var e=this,t=[];this.users=u.User.getUsers();var n=JSON.parse(cc.sys.localStorage.getItem(h.TEACHER_ADDED)||"[]");return console.log("teachersAdded",JSON.stringify(n)),this.users.forEach(function(r){var o=n.find(function(t){return t.teacherId===e._teacherId&&t.sectionId===e._teacherSectionId&&t.studentId===r.id});console.log("on filter found",o),o||(console.log("Pushing to Validators",JSON.stringify(r)),t.push(r))}),t},t.prototype.render=function(){var e=this;this.text.getComponent(p.default).string=_.Util.i18NText("Add Teacher")+" "+this._teacherName;var t=this.validate();console.log("Validators",JSON.stringify(t)),t.forEach(function(n){var r=cc.instantiate(e.studentPreviewInfoPrefab);r.scale=2;var o=r.getComponent(d.default);o.setUser(n),o.setParent(e.studentLayout),o.renderStudent(),e.studentLayout.addChild(r),1===t.length&&o.generateEvent()}),t.length>1&&(this.yesButton.color=(new cc.Color).fromHEX("#6A6D5D"),this.yesButton.active=!0)},t.prototype.onYesClicked=function(){return a(this,void 0,void 0,function(){var e,t,n,r,o,i;return s(this,function(a){switch(a.label){case 0:return this._teacherId&&this.selectedStudentId?(e={teacherId:this._teacherId,sectionId:this._teacherSectionId,studentId:this.selectedStudentId,studentName:this.selectedStudentName,firebaseStudentId:this._firebaseStudentId},[4,g.ServiceConfig.getI().handle.teacherRequestAccepted(e)]):[3,2];case 1:a.sent(),f.default.subscribeToTopic("assignment-"+this._teacherId+"-"+this._teacherSectionId),(t=JSON.parse(cc.sys.localStorage.getItem(h.TEACHER_ADDED)||"[]")).push(e),cc.sys.localStorage.setItem(h.TEACHER_ADDED,JSON.stringify(t)),t&&t.length>0&&t.forEach(function(e){return f.default.logChimpleEvent(h.TEACHER_ADDED,e)}),f.default.logChimpleEvent(h.ACCEPT_TEACHER_REQUEST,e),n=h.ACCEPT_TEACHER_REQUEST_LINKED_USED+this._teacherId,(r=JSON.parse(cc.sys.localStorage.getItem(n)||"[]")).push(this._teacherId+"|"+this._teacherSectionId+"|"+this._firebaseStudentId),cc.sys.localStorage.setItem(n,JSON.stringify(r)),o="teacher_for_student_"+this.selectedStudentId,(i=JSON.parse(cc.sys.localStorage.getItem(o)||"[]")).push(this._teacherName),cc.sys.localStorage.setItem(o,JSON.stringify(i)),a.label=2;case 2:return this.closeDialog(),[2]}})})},t.prototype.closeDialog=function(){var e=this,t=new cc.Event.EventCustom(n.TEACHER_ADD_DIALOG_CLOSED,!0);this.node.dispatchEvent(t),this.scheduleOnce(function(){e.node.removeFromParent(!0)},.25)},t.prototype.onNoClicked=function(){var e={homeId:this.selectedStudentId,teacherId:this._teacherId,firebaseStudentId:this._firebaseStudentId,kind:"UpdateHomeTeacher",studentName:this.selectedStudentName};f.default.logChimpleEvent(h.REJECT_TEACHER_REQUEST,e),this.closeDialog()},Object.defineProperty(t.prototype,"TeacherId",{set:function(e){this._teacherId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TeacherName",{set:function(e){this._teacherName=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SelectedSectionId",{set:function(e){this._teacherSectionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SelectedAddStudentId",{set:function(e){this._firebaseStudentId=e},enumerable:!1,configurable:!0}),i([l(cc.Prefab)],t.prototype,"studentPreviewInfoPrefab",void 0),i([l(cc.Node)],t.prototype,"text",void 0),i([l(cc.Node)],t.prototype,"yesButton",void 0),i([l(cc.Node)],t.prototype,"studentLayout",void 0),i([c],t)}(cc.Component);n.default=m,cc._RF.pop()},{"../../chimple":"chimple","./chimple-label":"chimple-label","./lib/profile":"profile","./services/ServiceConfig":"ServiceConfig","./studentPreviewInfo":"studentPreviewInfo","./util":"util","./util-logger":"util-logger"}],"trace-gen-container":[function(e,t,n){"use strict";cc._RF.push(t,"2cd9d3gQ7VNbYksOZvcod9Z","trace-gen-container");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=e("./tracing-container"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._fileName=null,t._tracingContainerVisible=!1,t}return o(t,e),t.prototype.onLoad=function(){this._recordContainer=this.node.getChildByName("recordContainer"),this._recordContainer.getComponent(s.default).traceGenerationMode=!0,this._tracingContainer=this.node.getChildByName("tracingConainer"),this._tracingContainer.getComponent(s.default).traceGenerationMode=!1,this._tracingContainer.active=!1},t.prototype.start=function(){var e=this._recordContainer.getComponent(s.default);e.traceGenerationMode=!0,this._fileName=e.traceObject.name,null!==cc.sys.localStorage.getItem(this._fileName)&&(this._tracingContainer.active=!0,this._tracingContainerVisible=!0,this._recordContainer.getComponent(s.default).showGeneratedPath())},t.prototype.update=function(){},i([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./tracing-container":"tracing-container"}],"trace-graphics":[function(e,t,n){"use strict";cc._RF.push(t,"7afd1G+VFxPtJxi3y2EUala","trace-graphics");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=cc._decorator.property,c=cc.Color,l=e("./tracing-container"),u=e("./tracing-node"),d=e("./indicator-node"),p=e("./arrow-node"),h=e("../../scripts/lib/config"),f=e("../../scripts/lib/error-handler"),g=e("../../scripts/util"),_=e("../../scripts/helper"),m=cc.Vec2,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lineWidth=0,t.traceAudio=null,t.star=null,t.staringImage=null,t.arrowImage=null,t.endingImage=null,t.indicator=null,t.tracingNode=null,t.arrowNode=null,t.imageNode=null,t.tracingImageNode=null,t.indicatorNode=null,t.tracingContainerComponent=null,t._traceAudioId=null,t._traceSoundOn=!1,t._graphics=null,t._prevPoint=null,t._currPoint=null,t._recordPoint=null,t._firstTouchInCurrentPath=!1,t._isTouchNotReleased=!1,t._traceGenerationMode=!1,t._shouldUpdateStartIndicator=!0,t._starNodesInPath=[],t._matchingRects=[],t._animationPoints=[],t._hand=null,t._showHelp=!1,t._currentMatchingRect=null,t._currentPathIndex=0,t._path=0,t._allTracePoints=[],t._validationOfCurrentPathCompleted=!1,t._touchEnabled=!1,t._tracingContainer=null,t._adjustedScale=1,t._isValid=!1,t._isTouchStartValid=!1,t._finishCounter=0,t._lastValidPointIndexInCurrentPath=0,t._lastStarNodeInCurrentPath=null,t._startIndicator=null,t._endIndicator=null,t._mTrigger=!1,t._totalValidationCheckPoints=0,t._tracingFinished=!1,t._indicatorNodeComponent=null,t._lastCounterValue=0,t._activeStarsTillIndex=-1,t.currentArrowValue=0,t.nextArrowValue=0,t.arrowPos=null,t.arrowStarCounter=0,t._displayNodes=[],t._displayScheduler=null,t._isResetGraphicsAllowed=!1,t.displayIterator=function(e,t,n,r){var o;return void 0===n&&(n=1/0),void 0===r&&(r=1),(o={})[Symbol.iterator]=function(){var o=!1,i=0;return{next:function(){return i=t,t=(o=t>=n)?i:t+r,{done:o,value:e[i]}}}},o},t}return o(t,e),t.prototype.onLoad=function(){var e=this;cc.log("onLoad trace graphics"),cc.director.getCollisionManager().enabled=!0,this.node.opacity=0,this.node.width=cc.winSize.width+cc.winSize.width/4,this.node.height=cc.winSize.height,this.node.setPosition(new m(this.node.x-cc.winSize.width/4,this.node.y)),this._graphics=this.getComponent(cc.Graphics),this._graphics.node.opacity=1,this._graphics.lineJoin=cc.Graphics.LineJoin.ROUND,this._graphics.lineCap=cc.Graphics.LineCap.ROUND,this._graphics.strokeColor=this.strokeColor,this._graphics.lineWidth=this.lineWidth,this._tracingContainer=this.node.parent.getComponent(l.default),null==this._hand&&null==this._hand||(this._hand.active=!1),this.node.on("enabledGraphics",function(){var t=!0;try{t=isNaN(parseInt(e._traceObject.name))}catch(n){}e.loadTracePath(e._traceObject.name,!t)}),cc.log("onLoad trace graphics completed")},t.prototype.start=function(){cc.log("start called -> trace graphics"),this.strokeColor=cc.Color.WHITE},t.prototype.loadTracePath=function(e,t){var n=this;void 0===t&&(t=!1),h.default.getInstance().loadPathJSON(e,function(e){e&&e.length>0&&(n._allTracePoints=JSON.parse(e)||[]),n.postLoadPath()},t)},t.prototype.postLoadPath=function(){this.findHand(),this.postLoad(),this.enableTouchHandlers(),this.node.opacity=255},t.prototype.findHand=function(){this.traceGenerationMode||(this._showHelp=!0,this._hand=this.node.parent.getChildByName("hand"),this.scheduleHelpAnimation())},t.prototype.enableTouchHandlers=function(){this.node.on(g.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.on(g.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.on(g.TouchEvents.TOUCH_END,this.onTouchEnd,this),this.node.on(g.TouchEvents.TOUCH_CANCEL,this.onTouchEnd,this),this._touchEnabled=!0},t.prototype.disableTouchHandlers=function(){this.node.off(g.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.off(g.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.off(g.TouchEvents.TOUCH_END,this.onTouchEnd,this),this._touchEnabled=!1},t.prototype.postLoad=function(){this.renderStar(this._path),this.configureCurrentValidationPath(this._path)},t.prototype.showIndicators=function(){this._touchEnabled=!0,this.drawStartPointInCurrentPath(),this.drawEndPointInCurrentPath(),this._mTrigger=!1},t.prototype.isTouchValid=function(e){return!!this.traceGenerationMode||(this._indicatorNodeComponent&&this._lastCounterValue<=0&&(this._lastCounterValue=this._indicatorNodeComponent.counterValue),this._indicatorNodeComponent&&this._indicatorNodeComponent.collisionCount>0&&this._startIndicator.getBoundingBox().contains(e)?(this._touchEnabled=!0,this._isValid=!0,this._lastCounterValue=this._indicatorNodeComponent&&this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue):this._isValid=!1,this._isValid)},t.prototype.setUpGraphics=function(){this._graphics.lineJoin=cc.Graphics.LineJoin.ROUND,this._graphics.lineCap=cc.Graphics.LineCap.ROUND,this._graphics.strokeColor=this.strokeColor,this._graphics.lineWidth=this.lineWidth},t.prototype.onTouchStart=function(e){cc.log("onTouchStart"),this._touchEnabled&&(this._hand&&(this._hand.opacity=0),this._currPoint=this._prevPoint=this._recordPoint=this._traceObject.parent.convertToNodeSpaceAR(e.getLocation()),this.traceGenerationMode?(this.setUpGraphics(),this._graphics.moveTo(this._prevPoint.x,this._prevPoint.y),this._graphics.strokeColor=c.GRAY,this._tracingContainer.resetCurrentTracingPart(),this.recordPoint(!1)):this._isTouchStartValid=this.isTouchValid(this._currPoint),this._isTouchNotReleased=!0,this._isValid?(cc.log("onTouchStart valid"),this._startIndicator.opacity=255,this._endIndicator.opacity=255):this.stopTracingSound())},t.prototype.highLightStarNodes=function(e,t){var n=this;if(!this._mTrigger){var r=[];if(this._starNodesInPath.map(function(r,o){if(!1===r.active&&r.getBoundingBox().contains(e)&&o<=t)return n._activeStarsTillIndex=o,{oIndex:o,node:r}}),(r=(r=r.filter(function(e){return void 0!==e})).slice(0,r.length))&&r.length>0){var o=r[r.length-1],i=o.oIndex;this._lastValidPointIndexInCurrentPath<=i&&(this._shouldUpdateStartIndicator=!0),this._lastValidPointIndexInCurrentPath=this._starNodesInPath.indexOf(o.node),this._lastStarNodeInCurrentPath=o.node,r.forEach(function(e){e.node.opacity=255,e.node.active=!0,null!==n._starNodesInPath[e.oIndex]&&(n._starNodesInPath[e.oIndex].active=!0)})}}},t.prototype.onTouchMove=function(e){var t=this;if(this._isValid=this._isTouchStartValid&&!!this._indicatorNodeComponent&&this._indicatorNodeComponent.collisionCount>0,this._touchEnabled&&(this._isValid||this.traceGenerationMode)){this._lastCounterValue=this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue,this._hand&&(this._hand.opacity=0);var n=this._traceObject.parent.convertToNodeSpaceAR(e.getLocation()),r=new cc.Vec2(1/this.adjustedScale*e.getDelta().x,1/this.adjustedScale*e.getDelta().y);n=n.add(r),this._currPoint=n,this.traceGenerationMode?(this._graphics.lineTo(this._currPoint.x,this._currPoint.y),this._graphics.stroke(),this._prevPoint=this._currPoint,this._graphics.moveTo(this._prevPoint.x,this._prevPoint.y),this.doAdditionalCheckToRecordPointsOnMove()):null!==this.arrowPos&&(cc.log("onTouchMove valid",this._isValid),this.highLightStarNodes(this.arrowPos,this.arrowStarCounter),this._starNodesInPath.forEach(function(e,n){n<t._activeStarsTillIndex&&!1===e.active&&(e.active=!0,t._lastStarNodeInCurrentPath=t._starNodesInPath[n])}),this._isValid&&(this._startIndicator.setPosition(this._currPoint),this._isResetGraphicsAllowed||(this._isResetGraphicsAllowed=!0,this.node.dispatchEvent(new cc.Event.EventCustom(_.RESET_TRACING_ALLOWED,!0))))),this._isTouchNotReleased=!0}else this.stopTracingSound()},t.prototype.loadImage=function(e){var t=cc.instantiate(this.imageNode);t.scale=1.5,t.getComponent(cc.Sprite).spriteFrame=this.star,t.setPosition(e),this._tracingContainer.node.addChild(t),t.zIndex=99},t.prototype.loadIndicator=function(e,t,n){var r=cc.instantiate(this.tracingNode);r.name="tracingNode",r.getComponent(cc.Sprite).spriteFrame=this.indicator,r.setPosition(t),r.scale=.75;var o=r.getComponent(u.default);o.counter=n,o.currentPath="c"+e,this._tracingContainer.node.addChild(r),r.zIndex=99,r.opacity=0},t.prototype.loadArrow=function(e,t,n,r){var o=cc.instantiate(this.arrowNode);o.name="arrowNode",o.getComponent(cc.Sprite).spriteFrame=this.arrowImage,o.setPosition(t),o.scale=.5;var i=o.getComponent(p.default);i.currentPath="c"+e,i.arrowValue=n,i.starCounter=r,this._tracingContainer.node.addChild(o),o.zIndex=99,o.opacity=0},t.prototype.loadDisplay=function(e){var t=cc.instantiate(this.tracingImageNode);t.name="displayNode",t.setPosition(e),t.opacity=0,this._displayNodes.push(t),this._tracingContainer.node.addChild(t)},t.prototype.createStarAtPos=function(e,t){var n=cc.instantiate(this.imageNode);n.name="starNode",n.scale=1.5,n.getComponent(cc.Sprite).spriteFrame=this.star,n.setPosition(t),this._tracingContainer.node.addChild(n),n.zIndex=99,n.active=!1,e.push(n)},t.prototype.playTracingSound=function(){if(!this._traceSoundOn&&!this.traceGenerationMode){this._traceSoundOn=!0;try{this.traceAudio&&(this._traceAudioId=g.Util.playSfx(this.traceAudio,!0,!0))}catch(e){}}},t.prototype.doAdditionalCheckToRecordPointsOnMove=function(){this.traceGenerationMode&&this._currPoint.sub(this._recordPoint).magSqr()>=10&&(this._recordPoint=this._currPoint,this.recordPoint(!1))},t.prototype.onTouchEnd=function(){this.stopTracingSound(),this._endIndicator.opacity=0,this._startIndicator.opacity=0,this.traceGenerationMode?this.recordPoint(!0):(this._isValid&&this._touchEnabled&&(this._lastCounterValue=this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue,this._shouldUpdateStartIndicator&&this._lastStarNodeInCurrentPath&&this._startIndicator.setPosition(this._lastStarNodeInCurrentPath.getPosition())),this.checkIfAllValidateTraceCompleted(),this._tracingFinished||(this._startIndicator.opacity=255),this.stopTracingSound())},t.prototype.scheduleHelpAnimation=function(){var e=this;this.scheduleOnce(function(){e._showHelp=!0,e._hand.active=!0,e.animate()},5)},t.prototype.stopTracingSound=function(){!this.traceGenerationMode&&this._traceAudioId&&this._traceSoundOn&&(cc.audioEngine.stop(this._traceAudioId),this._traceSoundOn=!1)},t.prototype.recordPoint=function(e){this.traceGenerationMode&&(this._graphics.lineTo(this._currPoint.x,this._currPoint.y),this._graphics.stroke(),this._tracingContainer.recordTouchPoint(this._currPoint,e))},t.prototype.getTouchLocation=function(){return this._isTouchNotReleased?this._currPoint:null},t.prototype.checkIfAllValidateTraceCompleted=function(){this.currentArrowValue>=this._totalValidationCheckPoints&&(this._validationOfCurrentPathCompleted=!0,this.node.dispatchEvent(new cc.Event.EventCustom(_.TRACING_CORRECT,!0)),this.moveToNextPath())},t.prototype.rectAroundPoint=function(e){return cc.Rect.fromMinMax(new cc.Vec2(e.x-20,e.y-20),new cc.Vec2(e.x+20,e.y+20))},t.prototype.setUpDebugDrawGraphics=function(){var e=this;this._graphics.strokeColor=cc.Color.BLUE,this._graphics.lineWidth=1,this._matchingRects.forEach(function(t){e._graphics.rect(t.x,t.y,t.width,t.height),e._graphics.stroke()})},t.prototype.renderStar=function(e){var t=this;this._starNodesInPath=[],this._allTracePoints.length>e&&this._allTracePoints[e].forEach(function(e){t.createStarAtPos(t._starNodesInPath,new cc.Vec2(e.x,e.y))})},t.prototype.drawStartPointInCurrentPath=function(){var e=this;this.scheduleOnce(function(){e.createStartIndicator(),e._starNodesInPath.length>0&&(e._startIndicator.setPosition(e._starNodesInPath[0].getPosition()),e._startIndicator.active=!0,e._startIndicator.zIndex=100,e._tracingContainer.node.children.filter(function(e){return"displayNode"===e.name}).forEach(function(e){e.opacity=255,e.active=!0}),e.animateDisplayNodes(e._displayNodes))})},t.prototype.drawEndPointInCurrentPath=function(){var e=this;this.scheduleOnce(function(){e.createEndIndicator(),e._starNodesInPath.length>0&&(e._endIndicator.setPosition(e._starNodesInPath[e._starNodesInPath.length-1].getPosition()),e._endIndicator.active=!0,e._endIndicator.zIndex=100)})},t.prototype.createStartIndicator=function(){return this._startIndicator&&this._startIndicator.removeFromParent(!0),this._startIndicator=cc.instantiate(this.indicatorNode),this._indicatorNodeComponent=this._startIndicator.getComponent(d.default),this._indicatorNodeComponent.traceGraphics=this,this._indicatorNodeComponent.currentPath="c"+this._path,this._startIndicator.getComponent(cc.CircleCollider).radius=18,this._startIndicator.name="startImage",this._startIndicator.name="startImage",this._startIndicator.zIndex=100,this._startIndicator.scale=2.5,this._startIndicator.opacity=255,this._startIndicator.getComponent(cc.Sprite).spriteFrame=this.staringImage,this.node.parent.addChild(this._startIndicator),this._startIndicator},t.prototype.createEndIndicator=function(){return this._endIndicator||(this._endIndicator=cc.instantiate(this.imageNode),this._endIndicator.name="endImage",this._endIndicator.zIndex=100,this._endIndicator.scale=2.5,this._endIndicator.opacity=255,this._endIndicator.getComponent(cc.Sprite).spriteFrame=this.endingImage,this.node.parent.addChild(this._endIndicator)),this._endIndicator},t.prototype.distanceBetweenPoints=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},t.prototype.computeDistance=function(e){for(var t=0;t<e.length;t++)for(var n=t;n<e.length;n++){var r=e[t],o=e[n];this.distanceBetweenPoints(r,o)>=45&&(t=n,this.loadDisplay(new cc.Vec2(r.x,r.y)))}this._starNodesInPath.length>10&&this.loadDisplay(this._starNodesInPath[this._starNodesInPath.length-10].getPosition())},t.prototype.configureCurrentValidationPath=function(e){var t=this;this._matchingRects=[],this._animationPoints=[],this._validationOfCurrentPathCompleted=!1;var n=0,r=0;if(this._allTracePoints.length>e){var o=this._allTracePoints[e];this.computeDistance(o),this._finishCounter=o.length-1,n=0,r=0,o.forEach(function(i,a){r=a,0===a?(t.loadIndicator(e,new cc.Vec2(i.x,i.y),a+1),n++,t.loadArrow(e,new cc.Vec2(i.x,i.y),n,a+1)):a%5==0?(t.loadIndicator(e,new cc.Vec2(i.x,i.y),a+1),a%15==0&&(n++,t.loadArrow(e,new cc.Vec2(i.x,i.y),n,a+1))):a===o.length-1&&(n++,t.loadIndicator(e,new cc.Vec2(i.x,i.y),a+1),t.loadArrow(e,new cc.Vec2(i.x,i.y),n,a+1));var s=t.rectAroundPoint(i);t._matchingRects.push(s),t._animationPoints.push({x:s.x+s.width/2,y:s.y+s.height/2})})}n++,this._starNodesInPath[this._starNodesInPath.length-1]&&this.loadArrow(e,this._starNodesInPath[this._starNodesInPath.length-1].getPosition(),n,r+1),this._totalValidationCheckPoints=n,this.showIndicators(),this.scheduleOnce(function(){null!==t._displayScheduler&&t.unschedule(t._displayScheduler),t._displayScheduler=function(){t.animateDisplayNodes(t._displayNodes)},t.schedule(t._displayScheduler,3)})},t.prototype.animateDisplayNodes=function(e){var t=this.displayIterator(e,0,e.length)[Symbol.iterator]();this.getNextFromIterator(t)},t.prototype.getNextFromIterator=function(e){var t=this,n=e.next();!n.done&&n.value?this.glowDisplay(n.value,function(){t.getNextFromIterator(e)}):e=null},t.prototype.glowDisplay=function(e,t){var n=e.getComponent(cc.Animation);null!==n&&(n.stop(),n.on("finished",function(){t()},this),n.play("glowing_dot"))},t.prototype.drawDebugPath=function(e){e&&this._currentPathIndex>0&&this.setUpDebugDrawGraphics()},t.prototype.moveToNextPath=function(){var e=this;this._isResetGraphicsAllowed=!1,this.node.dispatchEvent(new cc.Event.EventCustom(_.RESET_TRACING_NOT_ALLOWED,!0)),this._lastStarNodeInCurrentPath=null,this.currentArrowValue=0,this.nextArrowValue=0,this.arrowPos=null,this._activeStarsTillIndex=-1,this._endIndicator.active=!1,this._startIndicator.active=!1,this._lastCounterValue=0,this._firstTouchInCurrentPath=!1,this._lastValidPointIndexInCurrentPath=-1,this.stopTracingSound(),this._displayNodes.forEach(function(e){e.active=!1,e.removeFromParent(!1)}),this._starNodesInPath.filter(function(e){return!1===e.active||0===e.opacity}).forEach(function(e){e.active=!0,e.opacity=255}),this._displayNodes=[],this._tracingContainer.node.children.filter(function(e){return"displayNode"===e.name}).forEach(function(e){e.removeFromParent(!1),e.active=!1}),this._currentPathIndex>=this._allTracePoints.length-1?(this._showHelp=!1,this._touchEnabled=!1,this._tracingFinished||(this._tracingFinished=!0,this.disableTouchHandlers(),this.tracingContainerComponent.node.emit(_.SHOW_CHILD_IMAGE),this.scheduleOnce(function(){e.node.dispatchEvent(new cc.Event.EventCustom(_.TRACING_FINISHED,!0)),e.scheduleOnce(function(){e._hand.opacity=0},1)},1))):(this._mTrigger=!0,this._isValid=!1,this._touchEnabled=!1,this._currentPathIndex=this._currentPathIndex+1,this.renderStar(this._currentPathIndex),this._path=this._path+1,this._animationPoints=[],this._starNodesInPath.forEach(function(e){e.active=!1}),this._showHelp=!0,this.configureCurrentValidationPath(this._path))},t.prototype.resetGraphics=function(){this._isResetGraphicsAllowed&&(this._isResetGraphicsAllowed=!1,this.node.dispatchEvent(new cc.Event.EventCustom(_.RESET_TRACING_NOT_ALLOWED,!0)),this._lastStarNodeInCurrentPath=null,this.currentArrowValue=0,this.nextArrowValue=0,this._activeStarsTillIndex=-1,this._lastCounterValue=0,this._firstTouchInCurrentPath=!1,this._lastValidPointIndexInCurrentPath=-1,this.stopTracingSound(),this._starNodesInPath.forEach(function(e){e.active=!1}),null!==this._startIndicator&&this._startIndicator.setPosition(this._starNodesInPath[0].getPosition()),null!==this._endIndicator&&this._endIndicator.setPosition(this._starNodesInPath[this._starNodesInPath.length-1].getPosition()))},t.prototype.moveBackToCurrentPath=function(){this._mTrigger=!0,this._isValid=!1,this._touchEnabled=!1,this._lastCounterValue=0,this._currentPathIndex=this._currentPathIndex,this._starNodesInPath.forEach(function(e){e.active=!1}),this._path=this._path,this._animationPoints=[],this._showHelp=!0,this.showIndicators()},t.prototype.animate=function(){var e=this;if(!this._validationOfCurrentPathCompleted&&!this.traceGenerationMode&&this._showHelp)try{this._hand.opacity=255,this._hand.active=!0;for(var t=[],n=0;n<this._animationPoints.length;n++){var r=this._animationPoints[n];t.push(cc.moveTo(.02,new cc.Vec2(r.x,r.y)))}null!=t&&t.length>0&&t.push(cc.callFunc(function(){e._hand.active=!1,e.scheduleHelpAnimation()},this)),null!=t&&t.length>0&&(null!==this._hand||void 0!==this._hand)&&this._hand.active&&this._hand.runAction(cc.sequence(t))}catch(o){}},t.prototype.drawCircleInTracingMode=function(e){var t=this;this._graphics.strokeColor=c.BLUE;try{JSON.parse(cc.sys.localStorage.getItem(e)).forEach(function(e){var n=e.shift();t._graphics.moveTo(n.x,n.y),e.forEach(function(e,n){n%5==0&&(t._graphics.circle(e.x,e.y,5),t._graphics.stroke())})})}catch(n){}},Object.defineProperty(t.prototype,"traceObject",{get:function(){return this._traceObject},set:function(e){this._traceObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"traceGenerationMode",{get:function(){return this._traceGenerationMode},set:function(e){this._traceGenerationMode=e},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this._graphics.clear(!0),this.stopTracingSound()},t.prototype.onDestroy=function(){this._isValid=!1,this._startIndicator&&(this._startIndicator.active=!1,this._startIndicator.removeFromParent(!0)),this.stopTracingSound()},Object.defineProperty(t.prototype,"adjustedScale",{get:function(){return this._adjustedScale},set:function(e){this._adjustedScale=e},enumerable:!1,configurable:!0}),t.prototype.disableTouchAsNoCollision=function(e){var t=this;try{this._touchEnabled=e,this._tracingFinished||this.scheduleOnce(function(){cc.log("exit"),!t._validationOfCurrentPathCompleted&&t._lastStarNodeInCurrentPath&&t._startIndicator.setPosition(t._lastStarNodeInCurrentPath.getPosition()),t.checkIfAllValidateTraceCompleted(),t._touchEnabled=!0},.1)}catch(n){}},i([s(cc.Color)],t.prototype,"strokeColor",void 0),i([s()],t.prototype,"lineWidth",void 0),i([s({type:cc.AudioClip})],t.prototype,"traceAudio",void 0),i([s(cc.SpriteFrame)],t.prototype,"star",void 0),i([s(cc.SpriteFrame)],t.prototype,"staringImage",void 0),i([s(cc.SpriteFrame)],t.prototype,"arrowImage",void 0),i([s(cc.SpriteFrame)],t.prototype,"endingImage",void 0),i([s(cc.SpriteFrame)],t.prototype,"indicator",void 0),i([s(cc.Prefab)],t.prototype,"tracingNode",void 0),i([s(cc.Prefab)],t.prototype,"arrowNode",void 0),i([s(cc.Prefab)],t.prototype,"imageNode",void 0),i([s(cc.Prefab)],t.prototype,"tracingImageNode",void 0),i([s(cc.Prefab)],t.prototype,"indicatorNode",void 0),i([f.default()],t.prototype,"onLoad",null),i([f.default()],t.prototype,"start",null),i([f.default()],t.prototype,"loadTracePath",null),i([f.default()],t.prototype,"enableTouchHandlers",null),i([f.default()],t.prototype,"disableTouchHandlers",null),i([f.default()],t.prototype,"postLoad",null),i([f.default()],t.prototype,"showIndicators",null),i([f.default()],t.prototype,"isTouchValid",null),i([f.default()],t.prototype,"setUpGraphics",null),i([f.default()],t.prototype,"onTouchStart",null),i([f.default()],t.prototype,"highLightStarNodes",null),i([f.default()],t.prototype,"onTouchMove",null),i([f.default()],t.prototype,"loadImage",null),i([f.default()],t.prototype,"loadIndicator",null),i([f.default()],t.prototype,"loadArrow",null),i([f.default()],t.prototype,"loadDisplay",null),i([f.default()],t.prototype,"createStarAtPos",null),i([f.default()],t.prototype,"playTracingSound",null),i([f.default()],t.prototype,"doAdditionalCheckToRecordPointsOnMove",null),i([f.default()],t.prototype,"onTouchEnd",null),i([f.default()],t.prototype,"scheduleHelpAnimation",null),i([f.default()],t.prototype,"stopTracingSound",null),i([f.default()],t.prototype,"recordPoint",null),i([f.default()],t.prototype,"getTouchLocation",null),i([f.default()],t.prototype,"checkIfAllValidateTraceCompleted",null),i([f.default()],t.prototype,"rectAroundPoint",null),i([f.default()],t.prototype,"setUpDebugDrawGraphics",null),i([f.default()],t.prototype,"renderStar",null),i([f.default()],t.prototype,"drawStartPointInCurrentPath",null),i([f.default()],t.prototype,"drawEndPointInCurrentPath",null),i([f.default()],t.prototype,"createStartIndicator",null),i([f.default()],t.prototype,"createEndIndicator",null),i([f.default()],t.prototype,"distanceBetweenPoints",null),i([f.default()],t.prototype,"computeDistance",null),i([f.default()],t.prototype,"configureCurrentValidationPath",null),i([f.default()],t.prototype,"animateDisplayNodes",null),i([f.default()],t.prototype,"moveToNextPath",null),i([f.default()],t.prototype,"animate",null),i([f.default()],t.prototype,"drawCircleInTracingMode",null),i([f.default()],t.prototype,"disableTouchAsNoCollision",null),i([a],t)}(cc.Component);n.default=y,cc._RF.pop()},{"../../scripts/helper":"helper","../../scripts/lib/config":"config","../../scripts/lib/error-handler":"error-handler","../../scripts/util":"util","./arrow-node":"arrow-node","./indicator-node":"indicator-node","./tracing-container":"tracing-container","./tracing-node":"tracing-node"}],"tracing-collider":[function(e,t,n){"use strict";cc._RF.push(t,"a1cacFWmO9DJ5+khTdKmxVv","tracing-collider");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isTouchInside=!1,t}return o(t,e),t.prototype.onLoad=function(){this._polygonCollider=this.node.getComponent(cc.PolygonCollider),this._isTouchInside=!1},t.prototype.checkIfTouchInsideCollider=function(e){var t=new cc.Vec2(e.x/this.node.scale,e.y/this.node.scale);return!!this._polygonCollider&&!!cc.Intersection.pointInPolygon(t,this._polygonCollider.points)},i([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{}],"tracing-container":[function(e,t,n){"use strict";cc._RF.push(t,"7217aYg9WtMvb4KzgWTWC2O","tracing-container");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=cc._decorator.property,c=cc.Label.HorizontalAlign,l=cc.Label.VerticalAlign,u=e("./trace-graphics"),d=e("./tracing-part"),p=e("../../scripts/lib/error-handler"),h=e("../../scripts/lib/config"),f=e("../../scripts/helper"),g=e("../../scripts/util"),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tracingImage="",t.imageNode=null,t._imageLoadedTexture=null,t._childImageLoadedTexture=null,t._lineWidth=0,t.tracingLetter="",t.textFont=null,t.traceGraphicsPrefab=null,t.width=0,t.height=0,t.traceGenerationMode=!1,t._traceGraphics=null,t._traceObject=null,t._traceGraphicsComponent=null,t._currentTracingPart=null,t._tracingPaths=null,t._childImage=null,t._image=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;this.node.width=this.width,this.node.height=this.height,cc.log("required font",h.default.getInstance().currentFontName),this.textFont=h.default.getInstance().getTextFont(h.default.getInstance().currentFontName),this.node.on(f.SHOW_CHILD_IMAGE,function(){e._childImage&&e._childImageLoadedTexture&&(e.clearStarNodes(),e._image.opacity=255,e._childImage.opacity=255)}),this.init()},t.prototype.clearStarNodes=function(){this.node.children.filter(function(e){return"starNode"===e.name}).forEach(function(e){e.opacity=0})},t.prototype.resetCurrentTracingPart=function(){this._currentTracingPart=null},t.prototype.createText=function(e,t,n,r){return void 0===n&&(n="512"),void 0===r&&(r="#FFFFFF"),g.Util.initText(e,this.textFont,t,n,r,!0,new cc.Vec2(this.node.width/2,this.node.height/1.875),c.CENTER,l.CENTER,new cc.Vec2(.5,.5),!0,2)},t.prototype.createTracingImage=function(e){var t=this;this._image=cc.instantiate(this.imageNode);var n=-1!==this.tracingImage.indexOf("/")?this.tracingImage.substr(this.tracingImage.lastIndexOf("/")+1).replace(".png",""):this.tracingImage,r=this.tracingImage;r&&!this._imageLoadedTexture?g.Util.loadTexture(r,function(e){e&&(t._imageLoadedTexture=e,t._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t._imageLoadedTexture))}):this._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this._imageLoadedTexture),this._image.setAnchorPoint(new cc.Vec2(.5,.5)),this._image.setPosition(new cc.Vec2(512,cc.winSize.height/2)),this._image.scale=1,this._image.name=n,this._image.children.forEach(function(e){return e.opacity=0}),this._childImage=this._image.getChildByName("childImageNode"),this._childImage.opacity=0;var o=r.replace("-tutorial","");return o&&!this._childImageLoadedTexture?g.Util.loadTexture(o,function(e){e&&(t._childImageLoadedTexture=e,t._childImage.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t._childImageLoadedTexture))}):this._childImage.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this._childImageLoadedTexture),e.addChild(this._image),this._image},t.prototype.init=function(){null===this._tracingPaths&&(this._tracingPaths=[]),null===this._currentTracingPart&&(this._currentTracingPart=new d.TracingPart);var e,t,n,r=[].concat.apply([],g.Util.pickRandomElements(["#9900cc","#f25949","#00cfff","#e556f4"],1)).shift();this.node.opacity=255,this.tracingLetter?(this._traceObject=this.createText(this.node,this.tracingLetter,"512",r),this._traceObject.scale=1.25):this.tracingImage&&(this._traceObject=this.createTracingImage(this.node),this._traceObject.setPosition(new cc.Vec2(this._traceObject.x,this._traceObject.y-100)),this._traceObject.scale=.75),this._traceGraphics=cc.instantiate(this.traceGraphicsPrefab),this._traceGraphicsComponent=this._traceGraphics.getComponent(u.default),this._traceGraphicsComponent.tracingContainerComponent=this,0!==this._lineWidth&&(this._traceGraphicsComponent.lineWidth=this._lineWidth),this._traceGraphicsComponent.traceObject=this._traceObject,this._traceGraphicsComponent.traceGenerationMode=this.traceGenerationMode,this.node.addChild(this._traceGraphics),cc.director.getCollisionManager().enabled=!0,this.initHandAndIndicator(),this.node.width=this._traceObject.width,this.traceGenerationMode?((e=this.node.getChildByName("finish"))&&(e.zIndex=100,e.active=!0),(t=this.node.getChildByName("reset"))&&(t.zIndex=100,t.active=!0),(n=this.node.getChildByName("back"))&&(n.zIndex=100,n.active=!0)):((e=this.node.getChildByName("finish")).active=!1,(t=this.node.getChildByName("reset")).active=!1,"imagerecorder"===h.default.getInstance().game?((n=this.node.getChildByName("back")).zIndex=100,n.active=!0):(n=this.node.getChildByName("back")).active=!1),this.traceGenerationMode},t.prototype.initHandAndIndicator=function(){var e=this.node.getChildByName("hand");e&&(e.active=!1,e.scale=1,e.zIndex=999);var t=this.node.getChildByName("indicator");t&&(t.active=!0,t.scale=1,t.zIndex=999)},t.prototype.onFinishedButtonClick=function(){console.log("onFinishedButtonClick");var e=this.tracingLetter?this.tracingLetter:this.tracingImage;this.writeToLocalStorage(e,JSON.stringify(this._tracingPaths)),this._traceGraphicsComponent.drawCircleInTracingMode(e),this.node.dispatchEvent(new cc.Event.EventCustom(f.RECORDING_FINISHED,!0))},t.prototype.onBackButtonClick=function(){console.log("onBackButtonClick"),this.node.dispatchEvent(new cc.Event.EventCustom(f.BACK_FINISHED,!0))},t.prototype.recordTouchPoint=function(e,t){void 0===t&&(t=!1),null===this._tracingPaths&&(this._tracingPaths=[]),null===this._currentTracingPart&&(this._currentTracingPart=new d.TracingPart),this._currentTracingPart.addPoint(e),t&&(this._tracingPaths.push(this._currentTracingPart.getAllTracingPoints()),this._currentTracingPart=null)},t.prototype.removeFromLocalStorage=function(){var e=this.tracingLetter?this.tracingLetter:this.tracingImage;cc.sys.localStorage.removeItem(e),this._currentTracingPart=null,this._tracingPaths=null,this._traceGraphicsComponent.clear()},t.prototype.writeToLocalStorage=function(e,t){cc.sys.localStorage.setItem(e,t),this.showGeneratedPath(),console.log("key:",e,"json:",cc.sys.localStorage.getItem(e))},t.prototype.showGeneratedPath=function(){var e=this.tracingLetter?this.tracingLetter:this.tracingImage;this._traceGraphicsComponent.drawCircleInTracingMode(e)},t.prototype.onResetButtonClick=function(){console.log("onResetButtonClick"),this.removeFromLocalStorage()},Object.defineProperty(t.prototype,"traceObject",{get:function(){return this._traceObject},set:function(e){this._traceObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"traceGraphics",{get:function(){return this._traceGraphics},set:function(e){this._traceGraphics=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{set:function(e){this._lineWidth=e},enumerable:!1,configurable:!0}),i([s()],t.prototype,"tracingImage",void 0),i([s(cc.Prefab)],t.prototype,"imageNode",void 0),i([s()],t.prototype,"tracingLetter",void 0),i([s(cc.Prefab)],t.prototype,"traceGraphicsPrefab",void 0),i([s()],t.prototype,"width",void 0),i([s()],t.prototype,"height",void 0),i([s()],t.prototype,"traceGenerationMode",void 0),i([p.default()],t.prototype,"onLoad",null),i([p.default()],t.prototype,"clearStarNodes",null),i([p.default()],t.prototype,"resetCurrentTracingPart",null),i([p.default()],t.prototype,"createText",null),i([p.default()],t.prototype,"createTracingImage",null),i([p.default()],t.prototype,"init",null),i([p.default()],t.prototype,"initHandAndIndicator",null),i([p.default()],t.prototype,"recordTouchPoint",null),i([p.default()],t.prototype,"removeFromLocalStorage",null),i([p.default()],t.prototype,"writeToLocalStorage",null),i([p.default()],t.prototype,"showGeneratedPath",null),i([a],t)}(cc.Component);n.default=_,cc._RF.pop()},{"../../scripts/helper":"helper","../../scripts/lib/config":"config","../../scripts/lib/error-handler":"error-handler","../../scripts/util":"util","./trace-graphics":"trace-graphics","./tracing-part":"tracing-part"}],"tracing-node":[function(e,t,n){"use strict";cc._RF.push(t,"d1829VJlWNJJIiI9R8IZTV8","tracing-node");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._collisionCount=0,t.counter=0,t.currentPath=null,t}return o(t,e),t.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},t.prototype.onCollisionEnter=function(e,t){switch(e.node.group){case"drop":this.collisionEnter(e,t)}},t.prototype.collisionEnter=function(){this._collisionCount++},t.prototype.onCollisionExit=function(e,t){switch(e.node.group){case"drop":this.collisionExit(e,t)}},t.prototype.collisionExit=function(){this._collisionCount--},Object.defineProperty(t.prototype,"collisionCount",{get:function(){return this._collisionCount},set:function(e){this._collisionCount=e},enumerable:!1,configurable:!0}),i([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{}],"tracing-part":[function(e,t,n){"use strict";cc._RF.push(t,"b58dbgr5eFKSIEI7NwShGz0","tracing-part"),Object.defineProperty(n,"__esModule",{value:!0}),n.TracingPart=void 0;var r=function(){function e(){this._points=[],this._points=[]}return Object.defineProperty(e.prototype,"points",{get:function(){return this._points},set:function(e){this._points=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},set:function(e){this._priority=e},enumerable:!1,configurable:!0}),e.prototype.addPoint=function(e){this._points.push(e)},e.prototype.addPointAtIndex=function(e,t){this._points.splice(t,0,e)},e.prototype.getAllTracingPoints=function(){return this.points},e}();n.TracingPart=r,cc._RF.pop()},{}],"use_v2.1.x_cc.Action":[function(e,t){"use strict";cc._RF.push(t,"36bcb1fx5FL3IfL5KRXfdal","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}],"util-logger":[function(e,t,n){"use strict";cc._RF.push(t,"3a012LPdUZJZ79GViodugmx","util-logger");var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./lib/constants"),c=e("./lib/profile"),l=e("../../chimple"),u=e("./lib/config"),d="org/chimple/bahama/logger/ChimpleLogger",p=function(){function t(){}return t.logEvent=function(e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(e.userId=this.currentProfile()||"",e.deviceId=this.currentDeviceId()||"",e.timeStamp=(new Date).getTime(),cc.log("logging event",JSON.stringify(e)),"file"!=s.ASSET_LOAD_METHOD&&jsb.reflection.callStaticMethod(d,"logEvent","(Ljava/lang/String;)V",JSON.stringify(e))),this.logEventToFireBase(e)}catch(t){}},t.setUserIdEvent=function(e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("setUserId event",e),jsb.reflection.callStaticMethod(d,"setUserIdEvent","(Ljava/lang/String;)V",e))}catch(t){}},t.setUserPropertiesEvent=function(e,t){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("setUserPropertiesEvent event",e,":",t),jsb.reflection.callStaticMethod(d,"setUserPropertiesEvent","(Ljava/lang/String;Ljava/lang/String;)V",e,t))}catch(n){}},t.logEventToFireBaseWithKey=function(e,n){cc.log("logging firebase event",e," with content",JSON.stringify(n)),"undefined"!=typeof sdkbox&&sdkbox.firebase.Analytics.logEvent(e,n),cc.sys.isBrowser&&(t._isfireBaseInitialized?t.firebase&&t.firebase.analytics().logEvent(e,n):o(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return t._isfireBaseInitialized=!0,[4,t.importFirebaseForWeb()];case 1:return r.sent(),t.firebase&&(t.firebase.initializeApp(s.firebaseConfigWeb),t.firebase.analytics(),t.firebase.analytics().logEvent(e,n)),[2]}})}))},t.importFirebaseForWeb=function(){return o(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return n=t,[4,Promise.resolve().then(function(){return e("firebase/app")})];case 1:return n.firebase=r.sent(),[4,Promise.resolve().then(function(){return e("firebase/analytics")})];case 2:return r.sent(),[2]}})})},t.logChimpleEvent=function(e,n){n.userId=this.currentProfile()||"",n.deviceId=this.currentDeviceId()||"",n.timeStamp=(new Date).getTime(),t.logEventToFireBaseWithKey(e,n)},t.logEventToFireBase=function(e){e.userId=this.currentProfile()||"",e.deviceId=this.currentDeviceId()||"",e.timeStamp=(new Date).getTime(),t.logEventToFireBaseWithKey("logInfo",e)},t.logProfile=function(e,t){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("logging profile",e," ",t),jsb.reflection.callStaticMethod(d,"logProfile","(Ljava/lang/String;Ljava/lang/String;)V",e,t))}catch(n){}},t.currentProfile=function(){return this._currentUserId=c.User.getCurrentUser()?c.User.getCurrentUser().id:"",this._currentUserId},t.getStorageDirectory=function(){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(this._storageDirectory=jsb.reflection.callStaticMethod(d,"getStorageDirectory","()Ljava/lang/String;"),cc.log("storage directory:",this._storageDirectory))}catch(e){}return this._storageDirectory},t.currentDeviceId=function(){try{null===this._currentDeviceId&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(this._currentDeviceId=jsb.reflection.callStaticMethod(d,"getDeviceId","()Ljava/lang/String;"),cc.log("current device Id:",this._currentDeviceId))}catch(e){}return this._currentDeviceId},t.initPluginFirebase=function(){try{if("undefined"==typeof sdkbox)return void cc.log("sdkbox is undefined");if(void 0===sdkbox.firebase)return void cc.log("sdkbox.firebase is undefined");sdkbox.firebase.Analytics.init()}catch(e){}},t.initYoutubePlugin=function(){try{if("undefined"==typeof sdkbox)return void cc.log("sdkbox is undefined");if(void 0===sdkbox.PluginYoutube)return void cc.log("sdkbox.PluginYoutube is undefined");sdkbox.PluginYoutube.init()}catch(e){}},t.downloadFile=function(e,t){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===s.ASSET_LOAD_METHOD&&jsb.reflection.callStaticMethod(d,"downloadFile","(Ljava/lang/String;Ljava/lang/String;)V",e,t)}catch(n){}},t.isFileExistsInPublicDirectory=function(e){try{return!(!cc.sys.isNative||cc.sys.os!=cc.sys.OS_ANDROID||"file"!==s.ASSET_LOAD_METHOD)&&jsb.reflection.callStaticMethod(d,"isFileExistsInPublicDirectory","(Ljava/lang/String;)Z",e)}catch(t){}},t.isFileExists=function(e){try{return!(!cc.sys.isNative||cc.sys.os!=cc.sys.OS_ANDROID||"file"!==s.ASSET_LOAD_METHOD)&&jsb.reflection.callStaticMethod(d,"isFileExists","(Ljava/lang/String;)Z",e)}catch(t){}},t.init=function(){try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return cc.log("calling init"),jsb.reflection.callStaticMethod(d,"init","()V")}catch(e){}},t.launchYoutube=function(e){cc.log("calling launchYoutube");try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return cc.log("calling launchYoutube 1111"),jsb.reflection.callStaticMethod(d,"launchYoutube","(Ljava/lang/String;)V",e)}catch(t){}},t.checkIfUrlDownloaded=function(e,t){try{return cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===s.ASSET_LOAD_METHOD?jsb.reflection.callStaticMethod(d,"checkIfUrlDownloaded","(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;",e,t):null}catch(n){}},t.isNetworkAvailable=function(){try{return!(!cc.sys.isNative||cc.sys.os!=cc.sys.OS_ANDROID||"file"!==s.ASSET_LOAD_METHOD)&&jsb.reflection.callStaticMethod(d,"isNetworkAvailable","()Z")}catch(e){}},t.getCountryCode=function(){try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"getCountryCode","()Ljava/lang/String;")}catch(e){}},t.requestOtp=function(e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("Request Otp event",e),jsb.reflection.callStaticMethod(d,"requestOtp","(Ljava/lang/String;)V",e))}catch(t){}},t.verifyOtp=function(e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("Verify Otp event",e),jsb.reflection.callStaticMethod(d,"verifyOtp","(Ljava/lang/String;)V",e))}catch(t){}},t.syncFmcTokenForUsers=function(){var e=(c.User.getUserIds()||[]).join(",");console.log("syncFmcTokenForUsers:"+e);var t=parseInt(c.default.getValue(c.CURRENTMODE));try{t!=s.Mode.School&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("sync fmc userIds",e),jsb.reflection.callStaticMethod(d,"syncFmcForUsers","(Ljava/lang/String;)V",e))}catch(n){console.log(n)}},t.subscribeToTopic=function(e){try{parseInt(c.default.getValue(c.CURRENTMODE))!=s.Mode.School&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&e&&e.length>0&&(cc.log("subscribe to topic",e),jsb.reflection.callStaticMethod(d,"subscribeToTopic","(Ljava/lang/String;)V",e))}catch(t){}},t.login=function(e,t){cc.log("login using email: "+e+" and password: "+t);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return-1===e.indexOf("@")&&(e+="@gmail.com"),jsb.reflection.callStaticMethod(d,"login","(Ljava/lang/String;Ljava/lang/String;)V",e,t)}catch(n){}},t.logout=function(){try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"logout","()V")}catch(e){}},t.fetchStudents=function(e,t){cc.log("fetch Students: "+e+" and password: "+t);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"fetchStudentsForSchoolAndSection","(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;",e,t)}catch(n){}},t.fetchStudentById=function(e){cc.log("fetch Students: "+e);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"fetchStudentById","(Ljava/lang/String;)Ljava/lang/String;",e)}catch(t){}},t.findSchool=function(e){cc.log("find school using email: "+e);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"findSchool","(Ljava/lang/String;)Ljava/lang/String;",e)}catch(t){}},t.fetchSections=function(e){cc.log("fetch Sections: "+e);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"fetchSectionsForSchool","(Ljava/lang/String;)Ljava/lang/String;",e)}catch(t){}},t.historyProgress=function(e,t,n,r,o,i,a,s,c,l,u,p){cc.log("historyProgress for: "+e+"-"+t+"-"+n+"-"+o);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"historyProgress","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",e,t,n,r,o,i,a,s,c,l,u,p)}catch(h){}},t.syncProfile=function(e,t,n,r,o){cc.log("syncProfile for: "+e+"-"+t+"-"+n+"-"+o),cc.log("syncProfile in util-logger: mode ",parseInt(c.default.getValue(c.CURRENTMODE)),s.Mode.HomeConnect);try{var i=parseInt(c.default.getValue(c.CURRENTMODE));if(console.log("syncProfile in util-logger bool ",i===s.Mode.School,i===s.Mode.HomeConnect,cc.sys.isNative,cc.sys.os==cc.sys.OS_ANDROID,(i===s.Mode.School||i===s.Mode.HomeConnect)&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID),(i===s.Mode.School||i===s.Mode.HomeConnect)&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return cc.log("syncProfile in util-logger: mode in if ",e,t,n,r,o),jsb.reflection.callStaticMethod(d,"syncProfile","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",e,t,n,r,o)}catch(a){cc.log("syncProfile in util-logger error ",a)}},t.processLinkStudent=function(e,n,r,o,i,a,s,u){void 0===s&&(s=null),void 0===u&&(u=null);var d=c.User.getCurrentUser();if(null!=d&&u)for(var p in u.lessonProgressMap){var h=u.lessonProgressMap[p].course;d.lessonProgressMap.has(p)&&d.lessonProgressMap.get(p).score>u.lessonProgressMap[p].score?this.score=d.lessonProgressMap.get(p).score:this.score=u.lessonProgressMap[p].score;var f=u.lessonProgressMap[p].assignmentIds,g=u.lessonProgressMap[p].date;p==h+"_PreQuiz"&&(d.courseProgressMap.get(h).updateChapterId(h+"00"),d.courseProgressMap.get(h).lessonPlanIndex++),d.lessonProgressMap.set(p,new c.LessonProgressClass(this.score,1,h,f.toString(),g))}if(null!=d&&n&&e&&r&&!d.isConnected){d.sectionId=e,d.schoolId=n,d.studentId=r,d.schoolName=o,d.sectionName=i,d.isConnected=!0,a&&c.User.replaceUserID(d.id,a),d.id=a||d.id,d.storeUser();var _={teacherId:d.schoolId,sectionId:d.sectionId,studentId:d.id,studentName:d.name,firebaseStudentId:d.studentId,otpCode:s};t.logChimpleEvent(l.ACCEPT_TEACHER_REQUEST,_),t.subscribeToTopic("assignment-"+d.schoolId+"-"+d.sectionId),t.subscribeToTopic("assignment-"+d.schoolId),p="teacher_for_student_"+d.id;var m=JSON.parse(cc.sys.localStorage.getItem(p)||"[]");-1==m.indexOf(d.sectionName)&&m.push(d.sectionName),cc.sys.localStorage.setItem(p,JSON.stringify(m))}},t.processNewLinkStudent=function(e,n){var r,o,i=e.student,a={age:i.age,countryCode:i.countryCode,firebaseId:e.studentId,gender:i.gender,image:i.image,isSynced:"false",link:i.link,name:i.name,phoneNumber:i.phoneNumber,profileInfo:i.profile,progressId:i.progressId,schoolId:e.schoolId,sectionId:e.sectionId},u=t.fetchStudentById(a.firebaseId);cc.log("Student Json ",u);var d=null;if((null==a?void 0:a.profileInfo)&&(null===(r=null==a?void 0:a.profileInfo)||void 0===r?void 0:r.lessonProgressMap)&&(null===(o=null==a?void 0:a.profileInfo)||void 0===o?void 0:o.courseProgressMap)){cc.log("Student Profile exists:"+a.profileInfo),d=c.User.fromJson(JSON.stringify(a.profileInfo));var p=c.User.getCurrentUser();null!=d&&p&&(null==p?void 0:p.lessonProgressMap)&&t.mergeUser(p,d),cc.log("getting user from profile json:"+d)}else cc.log("creating new user:"+d),d=c.User.getCurrentUser();d.schoolId=a.schoolId,d.sectionId=a.sectionId,d.studentId=a.firebaseId,d.imgPath=a.image,d.isConnected=!0,d.schoolName=e.schoolName,d.sectionName=e.sectionName,cc.log("replacoing the userid.."),e.progressId&&c.User.replaceUserID(d.id,e.progressId),d.id=e.progressId?e.progressId:d.id,cc.log("schoolId ",a.schoolId),cc.sys.localStorage.setItem(s.FIREBASE_SCHOOL_ID,a.schoolId),cc.sys.localStorage.setItem(s.FIREBASE_SECTION_ID,a.sectionId),cc.sys.localStorage.setItem(s.FIREBASE_STUDENT_ID,e.studentId),console.log("setCurrentUser userid.."),c.User.setCurrentUser(d),console.log("storeUser userid.."),d.storeUser(),cc.log("synced profile",c.User.getCurrentUser().isConnected,c.User.getCurrentUser().courseProgressMap);var h={teacherId:a.schoolId,sectionId:a.sectionId,studentId:e.progressId,studentName:d.name,firebaseStudentId:d.studentId,otpCode:n};cc.log("AcceptTeacherRequest",h),t.logChimpleEvent(l.ACCEPT_TEACHER_REQUEST,h),t.subscribeToTopic("assignment-"+a.schoolId+"-"+a.sectionId),t.subscribeToTopic("assignment-"+a.schoolId);var f="teacher_for_student_"+d.id,g=JSON.parse(cc.sys.localStorage.getItem(f)||"[]");-1==g.indexOf(d.sectionName)&&g.push(d.sectionName),cc.sys.localStorage.setItem(f,JSON.stringify(g)),cc.log("LOAD prestart scene")},t.processLoginFail=function(){var e=parseInt(c.default.getValue(c.CURRENTMODE));if(cc.log("processLoginFail..."),e==s.Mode.HomeConnect){var t=c.User.getCurrentUser();t&&(cc.log("processLoginFail... current User",c.User.toJson(t)),t.isConnected=!1,t.storeUser()),c.User.getUsers().forEach(function(e){var t=cc.sys.localStorage.getItem("SCHOOL_USER");(null==e?void 0:e.schoolId)===t&&(e.isConnected=!1,e.storeUser())})}},t.mergeUser=function(e,t){var n,o,i,s,l,u,d,p,h,f,g,_,m,y;if(console.log("mergeing user"),!e||!t)return t;e.lessonProgressMap&&(t.lessonProgressMap?e.lessonProgressMap.forEach(function(n,r){var o,i,a,s,l,u,d,p,h,f,g,_,m=null!==(i=null===(o=e.lessonProgressMap.get(r))||void 0===o?void 0:o.score)&&void 0!==i?i:0,y=null===(a=e.lessonProgressMap.get(r))||void 0===a?void 0:a.course;t.lessonProgressMap.has(r)&&t.lessonProgressMap.get(r).score>m&&(m=t.lessonProgressMap.get(r).score);var v=null!==(l=null===(s=e.lessonProgressMap.get(r))||void 0===s?void 0:s.assignmentIds)&&void 0!==l?l:[],b=null!==(d=null===(u=t.lessonProgressMap.get(r))||void 0===u?void 0:u.assignmentIds)&&void 0!==d?d:[],E=v.concat(b.filter(function(e){return v.indexOf(e)<0})),S=null===(p=e.lessonProgressMap.get(r))||void 0===p?void 0:p.date,I=null!==(f=null===(h=e.lessonProgressMap.get(r))||void 0===h?void 0:h.attempts)&&void 0!==f?f:0,C=null!==(_=null===(g=t.lessonProgressMap.get(r))||void 0===g?void 0:g.attempts)&&void 0!==_?_:0,w=C>=I?C:I;t.lessonProgressMap.set(r,new c.LessonProgressClass(m,w,y,E.toString(),S))}):t.lessonProgressMap=e.lessonProgressMap),t.courseProgressMap||(t.courseProgressMap=e.courseProgressMap);var v=r(r({},null!==(n=t.unlockedRewards)&&void 0!==n?n:{}),null!==(o=e.unlockedRewards)&&void 0!==o?o:{}),b=r(r({},null!==(i=t.unlockedInventory)&&void 0!==i?i:{}),null!==(s=e.unlockedInventory)&&void 0!==s?s:{}),E=null!==(d=null===(l=t.currentReward)||void 0===l?void 0:l.concat(null===(u=e.currentReward)||void 0===u?void 0:u.filter(function(e){var n;return(null===(n=t.currentReward)||void 0===n?void 0:n.indexOf(e))<0})))&&void 0!==d?d:[],S=null!==(f=null===(p=t.assignments)||void 0===p?void 0:p.concat(null===(h=e.assignments)||void 0===h?void 0:h.filter(function(e){var n;return(null===(n=t.assignments)||void 0===n?void 0:n.indexOf(e))<0})))&&void 0!==f?f:[],I=r(r({},null!==(g=t.inventory)&&void 0!==g?g:{}),null!==(_=e.inventory)&&void 0!==_?_:{}),C=new Map(a(Array.from(null===(m=e.last5Lessons)||void 0===m?void 0:m.entries()),Array.from(null===(y=t.last5Lessons)||void 0===y?void 0:y.entries())));return t.unlockedRewards=v,t.unlockedInventory=b,t.currentReward=E,t.assignments=S,t.inventory=I,t.last5Lessons=C,t},t.logToDaily=function(e,n,r){var o=new Date,i=1==o.getMonth().toString().length?"0"+(o.getMonth()+1).toString():(o.getMonth()+1).toString(),a=o.getFullYear(),s=1==o.getDate().toString().length?"0"+o.getDate():o.getDate().toString(),l=cc.sys.localStorage.getItem("lastFileGeneratedName")||null,u=null==l?e+"#"+c.User.createUUID()+"-"+s+i+a+".txt":l;cc.sys.localStorage.setItem("lastFileGeneratedName",u),t.isFileExistsInPublicDirectory("Documents/events/processed/"+u)&&(u=e+"#"+c.User.createUUID()+"-"+s+i+a+".txt",cc.sys.localStorage.setItem("lastFileGeneratedName",u),cc.log("Generating new file "+u)),cc.log("logToDaily for: "+r+"-"+u);try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod(d,"logToDailyFile","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",n,r,u)}catch(p){}},t.getChapterIdForPrequiz=function(e){var t=u.default.i;if(t.course.chapters.find(function(e){return e.id==t.course.id+"_quiz"})){for(var n=t.course.chapters.find(function(e){return e.id!=t.course.id+"_quiz"}),r=0,o=0;o+2<e.length&&e[o]+e[o+1]+e[o+2]>=2;o+=3)n=t.course.chapters.find(function(e){return e.id==t.course.levels[r]}),r++;return n.id}var i=e.reduce(function(e,t,n,r){return e+(0==t?-.5:t)*(Math.floor(r.length/2)-Math.floor(n/2))},0),a=e.length/2*(e.length/2+1),s=Math.max(0,i/a),c=t.curriculum.get(t.course.id).chapters;return c[Math.floor((c.length-1)*s)].id},t._storageDirectory=null,t._currentUserId=null,t._currentDeviceId=null,t._isfireBaseInitialized=!1,t}();n.default=p,cc._RF.pop()},{"../../chimple":"chimple","./lib/config":"config","./lib/constants":"constants","./lib/profile":"profile","firebase/analytics":13,"firebase/app":14}],util:[function(e,t,n){"use strict";cc._RF.push(t,"b6786RxBpJI57Hig0e66N7e","util");var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.TouchEvents=n.SUBPACKAGES=n.STICKER_REWARDS=n.STICKER_BOOK=n.NUMBER_NAME=n.REWARD_BACKGROUNDS=n.REWARD_CHARACTERS=n.REWARD_TYPES=n.INVENTORY_ICONS=n.INVENTORY_ANIMATIONS=n.INVENTORY_SAVE_CONSTANTS=n.INVENTORY_DATA=void 0;var i=e("./chimple-label"),a=e("./help"),s=e("./helper"),c=e("./lessonController"),l=e("./lib/config"),u=e("./lib/constants"),d=e("./lib/profile"),p=e("./util-logger"),h=e("./friend"),f=cc.Label.Overflow,g=cc.Label.HorizontalAlign,_=cc.Label.VerticalAlign,m=e("./loading"),y=e("./services/ParseImageDownloader");n.INVENTORY_DATA=[["hat1-hat1","hat1-hat2","hat1-hat3","hat1-hat4","hat1-hat5","hat1-hat6","hat1-hat7","hat1-hat8","hat1-hat9","hat1-hat10"],["handacc-hand1","handacc-hand2","handacc-hand3","handacc-hand4","handacc-hand5","handacc-hand6","handacc-hand7","handacc-hand8"],["glassacc-glass1","glassacc-glass2","glassacc-glass3","glassacc-glass4","glassacc-glass5","glassacc-glass6","glassacc-glass7","glassacc-glass8","glassacc-glass9","glassacc-glass10"],["left_shoe-shoe1","left_shoe-shoe2","left_shoe-shoe3","left_shoe-shoe4","left_shoe-shoe5","left_shoe-shoe6","left_shoe-shoe7","left_shoe-shoe8","left_shoe-shoe9","left_shoe-shoe10"],["neck_acc-neck1","neck_acc-neck2","neck_acc-neck3","neck_acc-neck4","neck_acc-neck5","neck_acc-neck6","neck_acc-neck7","neck_acc-neck8","neck_acc-neck9","neck_acc-neck10"]],n.INVENTORY_SAVE_CONSTANTS=["hat1","handacc","glassacc","left_shoe","neck_acc"],n.INVENTORY_ANIMATIONS=["hat","hand","glass","leg","neck"],n.INVENTORY_ICONS={hat1:"rewards/hat_icons/",handacc:"rewards/hand_icons/",glassacc:"rewards/glass_icons/",left_shoe:"rewards/shoe_icons/",neck_acc:"rewards/neck_icons/"},n.REWARD_TYPES=["character","background","achievement","inventory","lesson"],n.REWARD_CHARACTERS=["chimp","bear","camel","cat","dog","duck","hippo","horse","koala","rabbit","tiger"],n.REWARD_BACKGROUNDS=["camp","underwater","beach","forest","city","desert","fair","garden","mountain","snow","village"],n.NUMBER_NAME=["zero","one","two","three","four","five","six","seven","eight","nine"],n.STICKER_BOOK=["rewardsticker0000","rewardsticker0001","rewardsticker0002","rewardsticker0003","rewardsticker0004","rewardsticker0005","rewardsticker0006","rewardsticker0007","rewardsticker0008","rewardsticker0009"],n.STICKER_REWARDS=[["icecreamset_part1","icecreamset_part2","icecreamset_part3","icecreamset_part4","icecreamset_part5","icecreamset_part6"],["bulldozer_part1","bulldozer_part2","bulldozer_part3","bulldozer_part4","bulldozer_part5","bulldozer_part6"],["astronaut_part1","astronaut_part2","astronaut_part3","astronaut_part4","astronaut_part5","astronaut_part6"],["house_part1","house_part2","house_part3","house_part4","house_part5","house_part6"],["rocket_part1","rocket_part2","rocket_part3","rocket_part4","rocket_part5","rocket_part6"],["taxi_part1","taxi_part2","taxi_part3","taxi_part4","taxi_part5","taxi_part6"],["frock_part1","frock_part2","frock_part3","frock_part4","frock_part5","frock_part6"],["guitar_part1","guitar_part2","guitar_part3","guitar_part4","guitar_part5","guitar_part6"],["seasonset_part1","seasonset_part2","seasonset_part3","seasonset_part4","seasonset_part5","seasonset_part6"],["shirt_part1","shirt_part2","shirt_part3","shirt_part4","shirt_part5","shirt_part6"]],n.SUBPACKAGES="subpackages";var v={"+":"plus","-":"minus","&":"and","=":"equals",x:"times"};(function(e){e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.TOUCH_MOVE="touchmove",e.TOUCH_CANCEL="touchCancel"})(n.TouchEvents||(n.TouchEvents={}));var b=function(){function e(){}return e.shuffle=function(e){for(var t,n,r=e.length;r>0;)n=Math.floor(Math.random()*r),t=e[--r],e[r]=e[n],e[n]=t;return e},e.shuffleByMapSortMap=function(e){return e.map(function(e){return{sort:Math.random(),value:e}}).sort(function(e,t){return e.sort-t.sort}).map(function(e){return e.value})},e.randomBetween=function(e,t){return Math.floor(Math.random()*(t-e)+e)},e.pickRandomElements=function(t,n){for(var r=[],o=0;o<n;o++){var i=e.shuffle(t),a=Math.floor(Math.random()*i.length);r.push(i.splice(a,1))}return r},e.initText=function(e,t,n,r,o,a,c,l,u,d,p,h){void 0===n&&(n=""),void 0===r&&(r="10"),void 0===o&&(o=null),void 0===a&&(a=!0),void 0===c&&(c=new cc.Vec2(0,0)),void 0===l&&(l=g.CENTER),void 0===u&&(u=_.CENTER),void 0===d&&(d=new cc.Vec2(.5,.5)),void 0===p&&(p=!1),void 0===h&&(h=0);var m=new cc.Node(n),y=m.addComponent(i.default);y.string=a?n:"",y.overflow=f.NONE;var v=s.DEFAULT_FONT_COLOR;o&&(v=v.fromHEX(o)),m.color=v;var b=parseInt(r);return y.fontSize=b,y.horizontalAlign=l,y.verticalAlign=u,y.lineHeight=b+100,m.setAnchorPoint(d),m.position=new cc.Vec2(c.x,c.y),p&&(m.addComponent(cc.LabelOutline).width=h),e.addChild(m),m},e.isBetweenRange=function(e,t,n){return e>=t&&e<=n},e.chunk=function(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},e.chunkByIncreaseSize=function(e,t,n){for(var r=[],o=t,i=1,a=0;a<e.length;a=o+i*n)r.push(e.slice(a,a+o+i*n)),i++;return r},e.speakEquation=function(e,t){var n=e.map(function(e){var t=e in v?v[e]:"d_"+e;return t=t.endsWith(".mp3")?t:t+".mp3",l.default.dir+d.default.lang+"-help/"+s.NUMBER_VOICE+t});this.speakOneByOne(n,0,t)},e.speakOneByOne=function(e,t,n){var r=this;this.speak(e[t],function(){n(t),++t<e.length&&r.speakOneByOne(e,t,n)})},e.speak=function(t,n){var r=this;e.load(t,function(e,t){r.speakClip(t,n)},!0)},e.speakClip=function(t,n){if(null!=t)if(Array.isArray(t)&&0===t.length)n();else{var r=e.play(t,!1);-1!=r?cc.audioEngine.setFinishCallback(r,n):n()}else n()},e.speakMusic=function(t,n){e.load(t,function(e,t){if(null!=t)if(Array.isArray(t)&&0===t.length)n();else{var r=cc.audioEngine.playMusic(t,!1);cc.audioEngine.setFinishCallback(r,n)}else n()},!0)},e.loadNumericSound=function(t,n){var r="d_"+t.toLowerCase();r=r.endsWith(".mp3")?r:r+".mp3";var o=l.default.dir+d.default.lang+"-help/"+s.NUMBER_VOICE+r;e.load(o,function(e,t){n(e||null===t?null:t)},!0)},e.loadsPhonicsOrLetter=function(t,n){t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var r=l.default.dir+s.PHONIC_VOICE+t;e.load(r,function(r,o){if(r||null==o){if(null!=r){var i=l.default.dir+s.LETTER_VOICE+t;e.load(i,function(e,t){e||null==t?null!=e&&n(null):n(t)},!0)}}else n(o)},!0)},e.loadsLetter=function(t,n){var r=this;t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var o=l.default.dir+s.LETTER_VOICE+t;e.load(o,function(e,o){e||null==o?null!=e&&r.loadGameSound(t,n):n(o)},!0)},e.loadGameSound=function(t,n){var r=(t.startsWith(l.default.dir)?t:"literacy"!=l.default.i.course.type?l.default.dir+(d.default.lang+"-help/")+l.default.i.game+"/"+t:l.default.dir+(l.default.i.currentGameLessonId+"/res/")+t)+(t.endsWith(".mp3")||t.endsWith(".m4a")?"":".mp3");e.load(r,function(e,t){e&&cc.log(e),n(e||null===t?null:t)},!0)},e.loadGameAudioOrPhonics=function(t,n){var r=this;t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var o=l.default.dir+s.PHONIC_VOICE+t;e.load(o,function(e,o){null!=e&&null==o?r.playGameSound(t,n):e||null==o?r.loadGameSound(t,n):n(o)},!0)},e.loadTexture=function(t,n,r){void 0===r&&(r=!0);var o=(t=t.endsWith(".png")||t.endsWith(".jpg")?t:t+".png").startsWith(l.default.dir)?t:l.default.dir+(l.default.i.currentGameLessonId+"/res/")+t;e.load(o,function(e,t){t&&!e?n(t,e):e&&n(null)},r)},e.flattenDeep=function(e){var t=this;return e.reduce(function(e,n){return Array.isArray(n)?e.concat(t.flattenDeep(n)):e.concat(n)},[])},e.randomElements=function(e,t){return e.sort(function(){return.5-Math.random()}).slice(0,t)},e.takePictureFromCamera=function(t){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","openCamera","()V");var n=10,i=null;return r(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return n>0&&null==i?[4,e.checkCameraResult()]:[3,2];case 1:return i=r.sent(),n--,[3,0];case 2:return t(i),[2]}})})},e.checkCameraResult=function(){return new Promise(function(e){setTimeout(function(){var t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","checkCameraResult","()Ljava/lang/String;");e(t),console.log("Returned promise")},6e3)})},e.shareText=function(e){try{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod("org/chimple/bahama/AppActivity","shareText","(Ljava/lang/String;)V",e)}catch(t){}},e.getRandomPosition=function(t,n){var r,o;return o=t[r=e.randomBetween(0,t.length-1)],n&&t.splice(r,1),o},e.generatePositionsArray=function(t,n,r,o){var i,a,s,c,l=[];for(s=Math.floor(n/r),c=Math.floor(t/r),i=1;i<=s;i+=1)for(a=1;a<=c;a+=1)l.push({x:Math.round(t*a/c)+e.randomBetween(-1*o,o)-t/2-50,y:Math.round(n*i/s)+e.randomBetween(-1*o,o)-n/2});return l},e.speakLetter=function(t,n){var r=l.default.dir+s.LETTER_VOICE+t;e.load(r,function(t,r){if(t||null==r)null!=t&&n();else{var o=e.play(r,!1);-1!==o?cc.audioEngine.setFinishCallback(o,n):n(),cc.audioEngine.setFinishCallback(o,n)}},!0)},e.speakPhonicsOrLetter=function(t,n){var r=this;t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var o=l.default.dir+s.PHONIC_VOICE+t;e.load(o,function(o,i){if(o||null==i)null!=o&&r.speakLetter(t,n);else{var a=e.play(i,!1);-1!==a?cc.audioEngine.setFinishCallback(a,n):r.speakLetter(t,n),cc.audioEngine.setFinishCallback(a,n)}},!0)},e.speakGameAudioOrPhonics=function(t,n){var r=this;t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var o=l.default.dir+s.PHONIC_VOICE+t;e.load(o,function(o,i){if(null!=o&&null==i)r.playGameSound(t,n);else if(!o&&null!=i){var a=e.play(i,!1);-1!==a?cc.audioEngine.setFinishCallback(a,n):r.playGameSound(t,n),cc.audioEngine.setFinishCallback(a,n)}},!0)},e.playGameSound=function(t,n){e.loadGameSound(t,function(t){if(null!=t){var r=e.play(t,!1);-1!=r&&cc.audioEngine.setFinishCallback(r,function(){n()})}else n()})},e.speakLettersOrWords=function(t,n){t=(t=t.replace(".m4a","")).endsWith(".mp3")?t:t+".mp3";var r=l.default.dir+s.LETTER_VOICE+t;e.loadGameSound(r,function(r){var o=-1;if(null!=r&&(o=cc.audioEngine.play(r,!1,1)),o>=0)cc.audioEngine.setFinishCallback(o,n);else{var i=l.default.dir+l.default.i.course.id+"/res/"+t;e.loadGameSound(i,function(e){null!=e&&(o=cc.audioEngine.play(e,!1,1)),o>=0?cc.audioEngine.setFinishCallback(o,n):null!=n&&n()})}})},e.freeResources=function(){for(var e=this._resources.length-1;e>=0;e--){try{cc.log("free resource ----\x3e:",this._resources[e]),cc.resources.release(this._resources[e])}catch(t){}this._resources.splice(e,1)}cc.log("resources left: ---\x3e",this._resources.length)},e.load=function(t,n,r){var o,i,a=this;void 0===r&&(r=!0),e.bundles.get(d.default.lang+"-help")||cc.assetManager.loadBundle(d.default.lang+"-help",function(t,n){e.bundles.set(d.default.lang+"-help",n)});var s=t.split("/"),u=s[0],p=s[1],h=s.slice(2).join("/"),f=h.split(".")[0],g=h.split(".")[1],_=this.bundles.get("course"==p?u:p);console.log("Config.i.course.isCourseMapped ",null===(o=l.default.i.course)||void 0===o?void 0:o.isCourseMapped),!_&&(null===(i=l.default.i.course)||void 0===i?void 0:i.isCourseMapped)&&(console.log("LessonController.bundles",c.default.bundles),c.default.bundles.forEach(function(e){console.log("bundles ",e.name,a.bundles.get(e.name)),_=a.bundles.get(e.name),"mp3"===g||"m4a"===g?_.load(f,cc.AudioClip,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)}):"png"===g||"jpg"===g?_.load(f,cc.Texture2D,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)}):_.load(f,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)})})),console.log("resArray",s),console.log("courseName",u),console.log("lessonName",p),console.log("resDir",h),console.log("resName",f),console.log("bundle",_,d.default.lang+"-help"),console.log("this.bundles",this.bundles),"mp3"===g||"m4a"===g?_.load(f,cc.AudioClip,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)}):"png"===g||"jpg"===g?_.load(f,cc.Texture2D,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)}):_.load(f,function(e,t){e&&cc.log(JSON.stringify(e)),n(e,t)})},e.removeAlli18NMapping=function(){e._i18NMap.clear()},e.loadi18NMapping=function(t){var n="lang/"+d.default.lang+"/i18n";cc.resources.load(n,function(n,r){if(!n&&r){var o=r instanceof cc.JsonAsset?r.json:r;o&&Object.keys(o).forEach(function(t){var n=o[t];e._i18NMap.set(t.toLowerCase(),n)}),t()}else t()})},e.loadDirectLessonWithLink=function(e,t){var n=l.default.i;n.loadSingleCourseJson(e.courseid,function(){n.course=n.curriculum.get(e.courseid),n.chapter=n.course.chapters.find(function(t){return t.id==e.chapterid}),n.lesson=n.chapter.lessons.find(function(t){return t.id==e.lessonid}),n.lesson.assignmentId=e.assignmentid||null,n.lesson.mlPartnerId=e.mlpartnerid||null,n.lesson.mlClassId=e.mlclassid||null,n.lesson.mlStudentId=e.mlstudentid||null,n.microLinkData=e,c.default.preloadLesson(t,function(e){e?console.log(e):l.default.loadScene("common/scenes/lessonController")})})},e.loadLesson=function(t,n,r){var o=l.default.i;o.course=t.chapter.course,o.chapter=t.chapter,o.lesson=t,n.getComponent(m.default).allowCancel=!0,n.active=!0,c.default.preloadLesson(r,function(t){t?n.getComponent(m.default).addMessage(e.i18NText("Error downloading content. Please connect to internet and try again"),!0,!0):n&&n.activeInHierarchy&&o.pushScene("common/scenes/lessonController")})},e.i18NText=function(t){return"string"==typeof t&&e._i18NMap.has(t.toLowerCase())?this._i18NMap.get(t.toLowerCase()):t},e.i18NNumberConvert=function(t,n){if(void 0===n&&(n=!0),n?/^\d/.test(t):/\d/.test(t)){var r=t.split("");return r=r.map(function(t){return e.i18NText(t)}),console.log("converted ",e.i18NText(r.join(""))),e.i18NText(r.join(""))}return t},e.showHelp=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=!0);var o=l.default.getInstance(),i=cc.Canvas.instance.node;r&&c.default.friend.speakHelp(),1==o.problem&&null!=e&&null!=t?cc.resources.load("prefabs/help",function(r,o){if(r)null!=n&&n();else{var s=cc.instantiate(o),c=s.getComponent(a.default);null!=c?c.initNodes(e,t,n):null!=n&&n(),i.addChild(s)}}):null!=n&&n()},e.computeTimeDiff=function(e,t,n){void 0===t&&(t=new Date),void 0===n&&(n=new Date);var r=n.getTime()-t.getTime();cc.log(e+" -> computeTimeDiff in milliseconds "+r)},e.shuffleGenerator=function(e){var t;return o(this,function(n){switch(n.label){case 0:t=e.length,n.label=1;case 1:return t--?[4,e.splice(Math.floor(Math.random()*(t+1)),1)[0]]:[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}})},e.loadFriend=function(e,t){if(void 0===t&&(t=null),null==t){var n=d.User.getCurrentUser();t=n?n.currentCharacter:"chimp"}cc.resources.load("prefabs/friend/"+t,function(t,n){null!=t&&cc.log(t);var r=null!=n?cc.instantiate(n):null;null!=e&&e(r)})},e.loadAccessoriesAndEquipAcc=function(t,r){if(d.User.getCurrentUser()){t.x=10*cc.winSize.width;for(var o=void 0,i=0;i<n.INVENTORY_DATA.length;i++){o=t.children[i].getComponent(dragonBones.ArmatureDisplay);for(var a=0;a<n.INVENTORY_DATA[i].length;a++)o.armatureName=n.INVENTORY_DATA[i][a].split("-")[1]}return e.equipAcc(r),o}t.active=!1},e.equipAcc=function(e){var t=dragonBones.CCFactory.getInstance(),r=e.getComponent(h.default).db.armature();n.INVENTORY_SAVE_CONSTANTS.forEach(function(e){var n=d.User.getCurrentUser().currentCharacter.concat("-",e),o=d.User.getCurrentUser().inventory[n];null!=o&&r&&(r.getSlot(e).childArmature=t.buildArmature(o),"left_shoe"===e&&(r.getSlot("right_shoe").childArmature=t.buildArmature(o)))})},e.playSfx=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),0==d.default.getItem(d.SFX_OFF))try{return t?cc.audioEngine.playMusic(e,n):cc.audioEngine.playEffect(e,n)}catch(r){}return-1},e.stopHelpAudio=function(){try{cc.audioEngine.stopEffect(this.helpAudioId),this.chimp&&this.chimp.playAnimation("idle",1)}catch(e){cc.log(e)}return this.helpAudioId},e.play=function(e,t){void 0===t&&(t=!1);var n=-1;try{e&&(n=cc.audioEngine.playEffect(e,t))}catch(r){cc.log(r)}return n},e.getSubpackages=function(){return JSON.parse(cc.sys.localStorage.getItem(n.SUBPACKAGES))||[]},e.addSubpackage=function(e){var t=this.getSubpackages();t.push(e),cc.sys.localStorage.setItem(n.SUBPACKAGES,JSON.stringify(t))},e.downloadIfNeeded=function(t,n,r,o){var i=n,a=i+"/"+r,s=a+"/res/"+r+".json";if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===u.ASSET_LOAD_METHOD&&!jsb.fileUtils.isFileExist(s)){p.default.downloadFile(""+u.COURSES_URL+a+".zip",i);var c=function(){cc.log("calling checkIfUrlDownloaded "+u.COURSES_URL+a+".zip");var n=p.default.checkIfUrlDownloaded(""+u.COURSES_URL+a+".zip",i);"DOWNLOAD_FAILED"!=n&&"DOWNLOAD_SUCCESS"!=n||(cc.director.getScheduler().unschedule(c,t),"DOWNLOAD_SUCCESS"==n?(e.addSubpackage(a),o(!0)):o(!1))};cc.director.getScheduler().schedule(c,t,1)}else o(!0)},e.assignHomework=function(e,t,n,r,o,i){return void 0===i&&(i=null),{chapterId:e,lessonId:t,kind:"AssignHomeWork",schoolId:n,studentId:i,subjectId:o,sectionId:r}},e.removeDuplicateMessages=function(e,t){var n=cc.sys.localStorage.getItem(t)||"[]",r=JSON.parse(n);return e&&r.push(e),cc.log("requests",JSON.stringify(r)),r},e.unlockNextReward=function(){var e=d.User.getCurrentUser(),t=e.unlockedRewards,r=n.REWARD_CHARACTERS.findIndex(function(e){return!t[n.REWARD_TYPES[0]+"-"+e]});if(0==r){var o=n.INVENTORY_DATA[0][0].split("-");return e.unlockRewardsForItem(n.REWARD_TYPES[0]+"-"+n.REWARD_CHARACTERS[0],1),e.currentCharacter=n.REWARD_CHARACTERS[0],e.updateInventory(n.REWARD_CHARACTERS[0]+"-"+o[0],o[1]),e.unlockRewardsForItem(n.REWARD_TYPES[3]+"-"+n.REWARD_CHARACTERS[0]+"-"+n.INVENTORY_DATA[0][0],1),n.REWARD_TYPES[3]+"-"+n.REWARD_CHARACTERS[0]+"-"+n.INVENTORY_DATA[0][0]}var i=-1==r?n.REWARD_CHARACTERS.length-1:r-1,a=n.REWARD_CHARACTERS[i],s=[];n.INVENTORY_DATA.forEach(function(e){return s=s.concat(e)});var c=s.length;if(0==(s=s.filter(function(e){return!(n.REWARD_TYPES[3]+"-"+a+"-"+e in t)})).length)return i+1<n.REWARD_CHARACTERS.length?(e.unlockRewardsForItem(n.REWARD_TYPES[0]+"-"+n.REWARD_CHARACTERS[i+1],1),n.REWARD_TYPES[0]+"-"+n.REWARD_CHARACTERS[i+1]):null;if(s.length<c/2&&!(n.REWARD_TYPES[1]+"-"+n.REWARD_BACKGROUNDS[i]in t))return e.unlockRewardsForItem(n.REWARD_TYPES[1]+"-"+n.REWARD_BACKGROUNDS[i],1),n.REWARD_TYPES[1]+"-"+n.REWARD_BACKGROUNDS[i];var l=s[Math.floor(Math.random()*s.length)];return o=l.split("-"),e.unlockRewardsForItem(n.REWARD_TYPES[3]+"-"+n.REWARD_CHARACTERS[i]+"-"+l,1),n.REWARD_TYPES[3]+"-"+n.REWARD_CHARACTERS[i]+"-"+l},e.preloadStartScene=function(e,t){t.getComponent(m.default).allowCancel=!1,t.active=!0,l.default.i.loadCourseJsons(d.User.getCurrentUser(),e,function(){cc.assetManager.loadBundle("menu",function(e,t){l.default.i.startAction=l.StartAction.Start,t.preloadScene("menu/start/scenes/start",function(){l.default.i.pushScene("menu/start/scenes/start","menu",null)})})})},e.loadImage=function(e,t,n){y.ParseImageDownloader.loadImageForSchool(t,n,function(t){if(t&&e){var n=new cc.SpriteFrame(t),r=e.getChildByName("photo");if(r){var o=r.getChildByName("mask");o&&(o.getChildByName("image").getComponent(cc.Sprite).spriteFrame=n)}}})},e.getHash=function(e){for(var t=0,n=e?e.length:0,r=0;r<n;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t},e.resizeSprite=function(t,n,r,o){void 0===o&&(o=1);var i=e.minScale(t,n,r,o),a=i.scale,s=i.size;t.node.width=a*s.width,t.node.height=a*s.height},e.minScale=function(e,t,n,r){void 0===r&&(r=1);var o=e.spriteFrame.getOriginalSize(),i=t/o.width,a=n/o.height;return{scale:Math.min(i,a,r),size:o}},e.setBackground=function(e,t){cc.resources.load("backgrounds/prefabs/"+e,function(e,n){var r=cc.instantiate(n);r.y=0,r.x=0,t.addChild(r)})},e._i18NMap=new Map,e._resources=[],e.bundles=new Map,e.helpAudioId=-1,e.chimp=null,e}();n.Util=b,cc._RF.pop()},{"./chimple-label":"chimple-label","./friend":"friend","./help":"help","./helper":"helper","./lessonController":"lessonController","./lib/config":"config","./lib/constants":"constants","./lib/profile":"profile","./loading":"loading","./services/ParseImageDownloader":"ParseImageDownloader","./util-logger":"util-logger"}],webLesson:[function(e,t,n){"use strict";cc._RF.push(t,"ed1c8VDuJZBn4KCaCl8316c","webLesson");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=e("./lib/config"),c=e("./lib/profile"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onLoad=function(){var e=new URLSearchParams(window.location.search);s.default.isMicroLink=!0;var t=e.get("lang");t==s.Lang.HINDI?c.default.setValue(c.LANGUAGE,s.Lang.HINDI):t==s.Lang.KANNADA?c.default.setValue(c.LANGUAGE,s.Lang.KANNADA):t==s.Lang.MARATHI?c.default.setValue(c.LANGUAGE,s.Lang.MARATHI):c.default.setValue(c.LANGUAGE,s.Lang.ENGLISH);var n={courseid:e.get("courseid"),chapterid:e.get("chapterid"),lessonid:e.get("lessonid"),assignmentid:e.get("assignmentid"),webclass:e.get("webclass"),test:e.get("test"),mlpartnerid:e.get("mlPartnerId"),mlclassid:e.get("mlClassId"),mlstudentid:e.get("mlStudentId"),end:e.get("end")};a.Util.loadDirectLessonWithLink(n,this.node)},i([u],t)}(cc.Component));n.default=d,cc._RF.pop()},{"./lib/config":"config","./lib/profile":"profile","./util":"util"}],writeword:[function(e,t,n){"use strict";cc._RF.push(t,"261599g5p5Ofoog5IhbdvFl","writeword");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.TRACE_HEIGHT=n.TRACE_WIDTH=void 0;var a=cc._decorator.ccclass,s=cc._decorator.property,c=e("../../../common/scripts/lib/config"),l=e("./singlelettertracing"),u=e("../../../common/scripts/util"),d=e("../../../common/scripts/lib/error-handler"),p=e("../../../common/scripts/helper"),h=e("../../scripts/game");n.TRACE_WIDTH=512,n.TRACE_HEIGHT=768;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.words=null,t.singleLetterPrefab=null,t.imageNode=null,t._currentConfig=null,t._wordTracingContainer=null,t._imageName=null,t._sound=null,t._currentLetterIndex=0,t._texture=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;cc.director.getCollisionManager().enabled=!0,this.subScribeToTracingEvents(),this.node.on(p.MOVE_TO_NEXT_LETTER_EVENT,function(t){t.stopPropagation();var n=t.getUserData();e.moveToNextLetter(n)}),this._currentConfig=this.processConfiguration(c.default.getInstance().data[0]),this._image=cc.instantiate(this.imageNode),null!==this._currentConfig&&(this._wordTracingContainer=this.node,this._wordTracingContainer.scale*=1,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this.buildLetters(),this.node.emit(p.CONFIG_LOADED),this.loadSounds(this._currentConfig.sound),this.node.on(p.SOUND_LOADED_EVENT,function(){e.friend.extraClip=e._sound,u.Util.showHelp(null,null)}),this.emitLetterEnabledEvent(this._wordLayout.node.getChildByName(this._originalLetterName+"0"),0),u.Util.loadTexture(this._currentConfig.image,function(t,n){t&&!n&&(e._texture=t)}))},t.prototype.moveToNextLetter=function(e){var t=e.elementIndex;if(t<=this._characters.length-1){var n=this._wordLayout.node.getChildByName(this._originalLetterName+t);c.default.i.direction==c.Direction.RTL?(this.minScrollToRight(t,n),this.scrollToRight(t,n)):(this.minScrollToLeft(t,n),this.scrollToLeft(t,n))}else this.loadImage(this._currentConfig.image)},t.prototype.minScrollToLeft=function(e){var t=this,n=cc.winSize.width/6,r=new cc.Vec2(this._wordLayout.node.position.x-n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){t.emitLetterEnabledEvent(t._wordLayout.node.getChildByName(t._originalLetterName+e),e)}).start()},t.prototype.scrollToLeft=function(e,t){var n=this;if(t.position.x-Math.abs(this._wordLayout.node.position.x/2)+1*t.width>cc.winSize.width){var r=.65*t.width,o=new cc.Vec2(this._wordLayout.node.position.x-r,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:o},{progress:null,easing:"sineOut"}).call(function(){n.emitLetterEnabledEvent(n._wordLayout.node.getChildByName(n._originalLetterName+e),e)}).start()}else this.minScrollToLeft(e,t)},t.prototype.minScrollToRight=function(e){var t=this,n=cc.winSize.width/6,r=new cc.Vec2(this._wordLayout.node.position.x+1*n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){t.emitLetterEnabledEvent(t._wordLayout.node.getChildByName(t._originalLetterName+e),e)}).start()},t.prototype.scrollToRight=function(e,t){var n=this;if(t.position.x-Math.abs(this._wordLayout.node.position.x/2)+1*t.width>cc.winSize.width){var r=t.width,o=new cc.Vec2(this._wordLayout.node.position.x+1.2*r,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:o},{progress:null,easing:"sineOut"}).call(function(){n.emitLetterEnabledEvent(n._wordLayout.node.getChildByName(n._originalLetterName+e),e)}).start()}else this.minScrollToRight(e,t)},t.prototype.tracingFinished=function(){this._wordLayout.node.getChildByName(this._originalLetterName+this._currentLetterIndex).getComponent(l.SingleLetterTracing).pronounce(),this.pronounce();var e=new cc.Event.EventCustom(p.MOVE_TO_NEXT_LETTER_EVENT,!0);this._currentLetterIndex++,e.setUserData({elementIndex:this._currentLetterIndex}),this.node.dispatchEvent(e)},t.prototype.buildLetters=function(){var e=this;this._wordLayout=this.words.getComponent(cc.Layout),this._wordLayout.spacingX=50,c.default.i.direction==c.Direction.RTL?(this.words.scaleX=-l.LETTER_SCALE,this._wordTracingContainer.x=cc.winSize.width):this.words.scale=l.LETTER_SCALE,this._characters.forEach(function(t,r){var o=cc.instantiate(e.singleLetterPrefab);c.default.i.direction==c.Direction.RTL&&(o.scaleX=-l.LETTER_SCALE),o.width=n.TRACE_WIDTH,o.height=n.TRACE_HEIGHT,e._originalLetterName=o.name,o.name=e._originalLetterName+r,e._singleLetterComponent=o.getComponent(l.SingleLetterTracing),e._singleLetterComponent.order=r,e._singleLetterComponent.letter=t,e._singleLetterComponent.wordTracingContainer=e.node,e._wordLayout.node.addChild(o),0===r&&(e._currentLetterIndex=r)})},t.prototype.subScribeToTracingEvents=function(){var e=this;this.node.on(p.TRACING_FINISHED,function(){e.tracingFinished()}),this.node.on(p.TRACING_CORRECT,function(t){t.stopPropagation(),e._wordTracingContainer.emit("correct")}),this.node.on(p.TRACING_WRONG,function(t){t.stopPropagation(),e._wordTracingContainer.emit("wrong")}),this.node.on(p.RESET_TRACING,function(t){t.stopPropagation(),console.log("RESET_TRACING.....");var n=e._wordLayout.node.getChildByName(e._originalLetterName+e._currentLetterIndex);if(n){var r=n.getComponent(l.SingleLetterTracing);null!==l.SingleLetterTracing&&r.reset()}}),this.node.on(p.RESET_TRACING_ALLOWED,function(){null!==e.node.getChildByName("reeetTracingButton")&&(e.node.getChildByName("reeetTracingButton").opacity=255)}),this.node.on(p.RESET_TRACING_NOT_ALLOWED,function(){null!==e.node.getChildByName("reeetTracingButton")&&(e.node.getChildByName("reeetTracingButton").opacity=0)}),null!==this.node.getChildByName("reeetTracingButton")&&(this.node.getChildByName("reeetTracingButton").opacity=0)},t.prototype.emitLetterEnabledEvent=function(e,t){e.emit("letterEnabledEvent",t)},t.prototype.processConfiguration=function(e){void 0===e&&(e=[]);var t=[].concat.apply([],e),n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],s=t[5];return this._characters=Array.from(i),{level:n,workSheet:r,problemNo:o,word:i,image:a=a||i,sound:s=s||i}},t.prototype.loadImage=function(e){if(this._imageName=e,this._texture){var t=this._image.getComponent(cc.Sprite);t.spriteFrame=new cc.SpriteFrame(this._texture),this.node.addChild(this._image),u.Util.resizeSprite(t,193,153),this._image.opacity=0,this._image.scale=0,this.hideLayoutAndShowImage()}else this.node.emit("nextProblem")},t.prototype.hideLayoutAndShowImage=function(){var e=this;(new cc.Tween).target(this._wordLayout.node).to(1,{opacity:0},{progress:null,easing:"sineOut"}).call(function(){e._image?(new cc.Tween).target(e._image).to(1,{scale:1,opacity:255},{progress:null,easing:"sineOut"}).call(function(){e.scheduleOnce(function(){e.node.emit("nextProblem")},.01)}).start():e.node.emit("nextProblem")}).start()},Object.defineProperty(t.prototype,"currentConfig",{get:function(){return this._currentConfig},enumerable:!1,configurable:!0}),t.prototype.loadSounds=function(e){var t=this;null===this._sound&&u.Util.loadGameSound(e,function(e){t._sound=e,t.node.emit(p.SOUND_LOADED_EVENT)})},t.prototype.pronounce=function(){var e=this;this._currentLetterIndex===this._characters.length-1&&this.scheduleOnce(function(){e.friend.speak(e._sound)},1.5)},t.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},i([s(cc.Node)],t.prototype,"words",void 0),i([s(cc.Prefab)],t.prototype,"singleLetterPrefab",void 0),i([s(cc.Prefab)],t.prototype,"imageNode",void 0),i([d.default()],t.prototype,"onLoad",null),i([d.default()],t.prototype,"moveToNextLetter",null),i([d.default()],t.prototype,"minScrollToLeft",null),i([d.default()],t.prototype,"scrollToLeft",null),i([d.default()],t.prototype,"minScrollToRight",null),i([d.default()],t.prototype,"scrollToRight",null),i([d.default()],t.prototype,"tracingFinished",null),i([d.default()],t.prototype,"buildLetters",null),i([d.default()],t.prototype,"subScribeToTracingEvents",null),i([d.default()],t.prototype,"emitLetterEnabledEvent",null),i([a],t)}(h.default);n.default=f,cc._RF.pop()},{"../../../common/scripts/helper":"helper","../../../common/scripts/lib/config":"config","../../../common/scripts/lib/error-handler":"error-handler","../../../common/scripts/util":"util","../../scripts/game":"game","./singlelettertracing":"singlelettertracing"}]},{},["chimple","arrow-node","indicator-node","singlelettertracing","trace-gen-container","trace-graphics","tracing-collider","tracing-container","tracing-node","tracing-part","writeword","achievement","scorecard","Utility","answer-grid","auto-drag","backButton","balloon","chapterIcon","chimple-label","chimple-richtext","commonButton","counting-answer","countingLayout","parseACL","parseAssignment","parseAssignmentForChapter","parseChapter","parseChapterAssignment","parseChapterProgress","parseClass","parseConnection","parseConstants","parseMonitor","parseProgress","parseSchool","parseSection","parseStudent","parseSubject","parseTeachersForStudent","parseTuition","parseUser","drag","drop","friend","game","header","headerButton","help","helpChimp","helper","lessonController","lessonIcon","config","constants","convert","error-handler","gameConfigs","globals","profile","loading","nest","number-script","progressMonitor","quit-popup","quiz-monitor","resetTracingButton","ApiHandler","FirebaseApi","ParseImageDownloader","ParseNetwork","ServiceApi","ServiceConfig","parseApi","studentPreviewInfo","teacherAddedDialog","util-logger","util","webLesson","kannada","use_v2.1.x_cc.Action","queue"]);